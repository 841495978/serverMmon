(()=>{var u={116:()=>{!function(u){function _(b){if(y[b])return y[b].exports;var x=y[b]={i:b,l:!1,exports:{}};return u[b].call(x.exports,x,x.exports,_),x.l=!0,x.exports}var y={};_.m=u,_.c=y,_.d=function(u,y,b){_.o(u,y)||Object.defineProperty(u,y,{configurable:!1,enumerable:!0,get:b})},_.n=function(u){var y=u&&u.__esModule?function(){return u.default}:function(){return u};return _.d(y,"a",y),y},_.o=function(u,y){return Object.prototype.hasOwnProperty.call(u,y)},_.p="",_(_.s=5)}([function(u){"use strict";var y=u.exports;y.ZMLIB={ZDLE:24,XON:17,XOFF:19,ABORT_SEQUENCE:[24,24,24,24,24],strip_ignored_bytes:function(u){for(var y=u.length-1;0<=y;y--)switch(u[y]){case 17:case 145:case 19:case 147:u.splice(y,1);continue}return u},find_subarray:function(u,y){var b,x=0;Date.now();e:for(;-1!=x&&-1!==(x=u.indexOf(y[0],x));){for(b=1;b<y.length;b++)if(u[x+b]!==y[b]){x++;continue e}return x}return-1}}},function(u){"use strict";function _(u){const y=b[u];switch(typeof y){case"string":return y;case"function":var x=[].slice.call(arguments).slice(1);return y.apply(this,x)}return null}var y=u.exports;const b={aborted:"Session aborted",peer_aborted:"Peer aborted session",already_aborted:"Session already aborted",crc:function(u,y){return this.got=u.slice(0),this.expected=y.slice(0),"CRC check failed! (got: "+u.join()+"; expected: "+y.join()+")"},validation:function(u){return u}};y.Error=class extends Error{constructor(u){super();var y=_.apply(this,arguments);y?(this.type=u,this.message=y):this.message=u}}},function(u){"use strict";var y=u.exports;const b=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102],x={};for(var k=0;k<b.length;k++)x[b[k]]=k;y.ENCODELIB={pack_u16_be:function(u){if(65535<u)throw"Number cannot exceed 16 bits: "+u;return[u>>8,255&u]},pack_u32_le:function(u){var y=u/65536;return[255&u,(65535&u)>>8,255&y,y>>8]},unpack_u16_be:function(u){return(u[0]<<8)+u[1]},unpack_u32_le:function(u){return u[0]+(u[1]<<8)+(u[2]<<16)+16777216*u[3]},octets_to_hex:function(u){for(var y=[],x=0;x<u.length;x++)y.push(b[u[x]>>4],b[15&u[x]]);return y},parse_hex_octets:function(u){for(var y=Array(u.length/2),b=0;b<y.length;b++)y[b]=(x[u[2*b]]<<4)+x[u[1+2*b]];return y}}},function(u,y,b){"use strict";var x,k,B=u.exports;Object.assign(B,b(0));const P=B.ZMLIB.ZDLE;B.ZDLE=class e{constructor(u){this._config={},u&&this.set_escape_ctrl_chars(!!u.escape_ctrl_chars)}set_escape_ctrl_chars(u){if("boolean"!=typeof u)throw"need boolean!";u!==this._config.escape_ctrl_chars&&(this._config.escape_ctrl_chars=u,this._setup_zdle_table())}escapes_ctrl_chars(){return!!this._config.escape_ctrl_chars}encode(u){if(!this._zdle_table)throw"No ZDLE encode table configured!";var y=this._zdle_table,b=this._lastcode,B=new ArrayBuffer(2*u.length),I=new Uint8Array(B),H=this._config.escape_ctrl_chars,j=0;for(x=0;x<u.length;x++){if(!(k=y[u[x]]))throw console.trace(),console.error("bad encode() call:",JSON.stringify(u)),this._lastcode=b,"Invalid octet: "+u[x];b=u[x],1===k||(H||2===k||64==(127&b))&&(I[j]=P,j++,b^=64),I[j]=b,j++}return this._lastcode=b,u.splice(0),u.push.apply(u,new Uint8Array(B,0,j)),u}static decode(u){for(var y=u.length-1;0<=y;y--)u[y]===P&&u.splice(y,2,u[y+1]-64);return u}static splice(u,y,b){var x=0;y||(y=0);for(var k=y;k<u.length&&x<b;k++)x++,u[k]===P&&k++;return x===b?u.length===k-1?void 0:(u.splice(0,y),e.decode(u.splice(0,k-y))):void 0}_setup_zdle_table(){for(var u=Array(256),y=0;y<u.length;y++)u[y]=96&y?1:y===P||y===B.ZMLIB.XOFF||y===B.ZMLIB.XON||y===(128|B.ZMLIB.XOFF)||y===(128|B.ZMLIB.XON)?2:16===y||144===y?this._config.turbo_escape?1:2:13===y||141===y?this._config.escape_ctrl_chars?2:this._config.turbo_escape?1:3:this._config.escape_ctrl_chars?2:1;this._zdle_table=u}}},function(u,y,b){"use strict";function r(u,y){return k||function t(){k=Array(256);for(var u,y=0;256>y;y++){u=y<<P-8&H;for(var b=0;8>b;b++)0==(u&j)?u<<=1:(u<<=1,u^=I);k[y]=u&H}}(),k[255&y>>8]^(255&y)<<8^u}function a(u,y){if(u.join()!==y.join())throw new B.Error("crc",y,u)}const x=b(12);var k,B=u.exports;Object.assign(B,b(1),b(2));const P=16,I=4129,H=65535,j=1<<P-1;B.CRC={crc16:function(u){for(var y=u[0],b=1;b<u.length;b++)y=r(u[b],y);return y=r(0,r(0,y)),B.ENCODELIB.pack_u16_be(y)},crc32:function(u){return B.ENCODELIB.pack_u32_le(x.buf(u)>>>0)},verify16:function(u,y){return a(this.crc16(u),y)},verify32:function(u,y){try{a(this.crc32(u),y)}catch(y){throw y.input=u.slice(0),y}}}},function(u,y,b){u.exports=b(6)},function(u,y,b){"use strict";function t(u){if(u.aborted())throw new x.Error("aborted")}var x=u.exports;window.Zmodem=x,Object.assign(x,b(7)),x.Browser={send_files:function(u,y,b){b||(b={});for(var x,k=[],B=0,P=y.length-1;0<=P;P--)B+=(x=y[P]).size,k[P]={obj:x,name:x.name,size:x.size,mtime:new Date(x.lastModified),files_remaining:y.length-P,bytes_remaining:B};var I=0;return function r(){var y=k[I];return y?(I++,u.send_offer(y).then((function(x){return b.on_offer_response&&b.on_offer_response(y.obj,x),void 0===x?r():new Promise((function(k){var B,P=new FileReader;P.onerror=function(u){throw console.error("file read error",u),"File read error: "+u},P.onprogress=function(k){k.target.result&&(B=new Uint8Array(k.target.result,x.get_offset()),t(u),x.send(B),b.on_progress&&b.on_progress(y.obj,x,B))},P.onload=function(P){B=new Uint8Array(P.target.result,x,B),t(u),x.end(B).then((function(){b.on_progress&&B.length&&b.on_progress(y.obj,x,B),b.on_file_complete&&b.on_file_complete(y.obj,x),k(r())}))},P.readAsArrayBuffer(y.obj)}))}))):Promise.resolve()}()},save_to_disk:function(u,y){var b=new Blob(u),x=URL.createObjectURL(b),k=document.createElement("a");k.style.display="none",k.href=x,k.download=y,document.body.appendChild(k),k.click(),document.body.removeChild(k)}}},function(u,y,b){Object.assign(u.exports,b(8))},function(u,y,b){"use strict";var x=u.exports;Object.assign(x,b(0),b(9));const k=[42,42,24,66,48],B=["to_terminal","on_detect","on_retract","sender"];class s{constructor(u,y,b,x){this._confirmer=y,this._denier=b,this._is_valid=x,this._session_type=u}confirm(){return this._confirmer.apply(this,arguments)}deny(){return this._denier.apply(this,arguments)}is_valid(){return this._is_valid.apply(this,arguments)}get_session_role(){return this._session_type}}x.Sentry=class{constructor(u){if(!u)throw"Need options!";var y=this;B.forEach((function(b){if(!u[b])throw"Need “"+b+"”!";y["_"+b]=u[b]})),this._cache=[]}_after_session_end(){this._zsession=null}consume(u){if(u instanceof Array||(u=Array.prototype.slice.call(new Uint8Array(u))),this._zsession){var y=this._zsession;if(y.consume(u),!y.has_ended())return;u="receive"===y.type?y.get_trailing_bytes():[]}var b=this._parse(u),x=u;if(b){!!this._parsed_session&&(this._parsed_session.type===b.type&&(x=[]),this._on_retract()),this._parsed_session=b;var k=this;this._on_detect(new s(b.type,(function(){if(!this.is_valid())throw"Stale ZMODEM session!";return b.on("garbage",k._to_terminal),b.on("session_end",k._after_session_end.bind(k)),b.set_sender(k._sender),delete k._parsed_session,k._zsession=b}),this._send_abort.bind(this),(function(){return k._parsed_session===b})))}else{var B=this._parsed_session;this._parsed_session=null,B&&(1===x.length&&67===x[0]&&this._send_abort(),this._on_retract())}this._to_terminal(x)}get_confirmed_session(){return this._zsession||null}_send_abort(){this._sender(x.ZMLIB.ABORT_SEQUENCE)}_parse(u){var y=this._cache;for(y.push.apply(y,u);;){let b=x.ZMLIB.find_subarray(y,k);if(-1===b)break;let B;y.splice(0,b);try{B=x.Session.parse(y)}catch(u){}if(!B)break;return 1===y.length&&y[0]===x.ZMLIB.XON&&y.shift(),y.length?null:B}return y.splice(21),null}}},function(u,y,b){"use strict";var x=u.exports;Object.assign(x,b(2),b(10),b(3),b(0),b(11),b(13),b(14),b(1));const k=["CANFDX","CANOVIO","CANFC32"],B="spool_uint8array",P=[79,79],I=x.ZMLIB.ABORT_SEQUENCE;class l{constructor(){this._on_evt={},this._evt_once_index={}}_Add_event(u){this._on_evt[u]=[],this._evt_once_index[u]=[]}_get_evt_queue(u){if(!this._on_evt[u])throw"Bad event: "+u;return this._on_evt[u]}on(u,y){return this._get_evt_queue(u).push(y),this}off(u,y){var b=this._get_evt_queue(u);if(y){var x=b.indexOf(y);if(-1===x)throw"“"+y+"” is not in the “"+u+"” queue.";b.splice(x,1)}else b.pop();return this}_Happen(u){var y=this._get_evt_queue(u),b=Array.apply(null,arguments);b.shift();var x=this;return y.forEach((function(u){u.apply(x,b)})),y.length}}x.Session=class extends l{static parse(u){var y;try{y=x.Header.parse_hex(u)}catch(y){return}if(y)switch(y.NAME){case"ZRQINIT":return new x.Session.Receive;case"ZRINIT":return new x.Session.Send(y)}}set_sender(u){return this._sender=u,this}has_ended(){return this._has_ended()}consume(u){if(this._before_consume(u),this._aborted)throw new x.Error("already_aborted");return u.length?(this._strip_and_enqueue_input(u),void(this._check_for_abort_sequence(u)||this._consume_first())):void 0}aborted(){return!!this._aborted}constructor(){super(),this._config={},this._input_buffer=[],this._Add_event("receive"),this._Add_event("garbage"),this._Add_event("session_end")}get_role(){return this.type}_trim_leading_garbage_until_header(){var u=x.Header.trim_leading_garbage(this._input_buffer);u.length&&0===this._Happen("garbage",u)&&console.debug("Garbage: ",String.fromCharCode.apply(String,u),u)}_parse_and_consume_header(){this._trim_leading_garbage_until_header();var u=x.Header.parse(this._input_buffer);if(u)return this._consume_header(u[0]),this._last_header_name=u[0].NAME,this._last_header_crc=u[1],u[0]}_consume_header(u){this._on_receive(u);var y=this._next_header_handler[u.NAME];if(!y)throw console.error("Unhandled header!",u,this._next_header_handler),new x.Error("Unhandled header: "+u.NAME);this._next_header_handler=null,y.call(this,u)}_check_for_abort_sequence(){var u=x.ZMLIB.find_subarray(this._input_buffer,I);if(-1!==u)throw this._input_buffer.splice(0,u+I.length),this._aborted=!0,this._on_session_end(),new x.Error("peer_aborted")}_send_header(){if(!this._sender)throw"Need sender!";var u=Array.apply(null,arguments),y=this._create_header_bytes(u);this._sender(y[0]),this._last_sent_header=y[1]}_create_header_bytes(u){var y=x.Header.build.apply(x.Header,u);return[y[this._get_header_formatter(u[0])](this._zencoder),y]}_strip_and_enqueue_input(u){x.ZMLIB.strip_ignored_bytes(u),this._input_buffer.push.apply(this._input_buffer,u)}abort(){return this._sender(I.concat([8,8,8,8,8])),this._aborted=!0,this._sender=function(){throw new x.Error("already_aborted")},void this._on_session_end()}_on_session_end(){this._Happen("session_end")}_on_receive(u){this._Happen("receive",u)}_before_consume(){}},x.Session.Receive=class extends x.Session{constructor(){super(),this._Add_event("offer"),this._Add_event("data_in"),this._Add_event("file_end")}_before_consume(u){if(this._bytes_after_OO)throw"PROTOCOL: Session is completed!";this._bytes_being_consumed=u}get_trailing_bytes(){if(this._aborted)return[];if(!this._bytes_after_OO)throw"PROTOCOL: Session is not completed!";return this._bytes_after_OO.slice(0)}_has_ended(){return this.aborted()||!!this._bytes_after_OO}_get_header_formatter(){return"to_hex"}_parse_and_consume_subpacket(){var u=16===this._last_header_crc?"parse16":"parse32",y=x.Subpacket[u](this._input_buffer);return y&&(this._consume_data(y),y.frame_end()&&(this._next_subpacket_handler=null)),y}_consume_first(){if(this._got_ZFIN){if(2>this._input_buffer.length)return;if(0===x.ZMLIB.find_subarray(this._input_buffer,P))return this._bytes_after_OO=function t(u){return 0===x.ZMLIB.find_subarray(u,P)?u.splice(0,P.length):u[0]===P[P.length-1]&&u.splice(0,1),u}(this._bytes_being_consumed.slice(0)),void this._on_session_end();throw"PROTOCOL: Only thing after ZFIN should be “OO” (79,79), not: "+array_buf.join()}var u;do{u=this._next_subpacket_handler?this._parse_and_consume_subpacket():this._parse_and_consume_header()}while(u&&this._input_buffer.length)}_consume_data(u){if(this._on_receive(u),!this._next_subpacket_handler)throw"PROTOCOL: Received unexpected data packet after "+this._last_header_name+" header: "+u.get_payload().join();this._next_subpacket_handler.call(this,u)}_octets_to_string(u){return this._textdecoder||(this._textdecoder=new x.Text.Decoder),this._textdecoder.decode(new Uint8Array(u))}_consume_ZFILE_data(u,y){if(this._file_info)throw"PROTOCOL: second ZFILE data subpacket received";var b=y.get_payload(),x=b.indexOf(0),k=this._octets_to_string(b.slice(0,x)),B=this._octets_to_string(b.slice(1+x)).split(" "),P=B[1]&&parseInt(B[1],8)||void 0;P&&(P=new Date(1e3*P)),this._file_info={name:k,size:B[0]?parseInt(B[0],10):null,mtime:P||null,mode:B[2]&&parseInt(B[2],8)||null,serial:B[3]&&parseInt(B[3],10)||null,files_remaining:B[4]?parseInt(B[4],10):null,bytes_remaining:B[5]?parseInt(B[5],10):null};var I=new f(u.get_options(),this._file_info,this._accept.bind(this),this._skip.bind(this));this._current_transfer=I}_consume_ZDATA_data(u){if(!this._accepted_offer)throw"PROTOCOL: Received data without accepting!";return this._offset_ok?(this._file_offset+=u.get_payload().length,this._on_data_in(u),void(u.ack_expected()&&!u.frame_end()&&this._send_header("ZACK",x.ENCODELIB.pack_u32_le(this._file_offset)))):(console.warn("offset not ok!"),void _send_ZRPOS())}_make_promise_for_between_files(){var u=this;return new Promise((function(y){var b={ZFILE:function(u){this._next_subpacket_handler=function(b){this._next_subpacket_handler=null,this._consume_ZFILE_data(u,b),this._Happen("offer",this._current_transfer),y(this._current_transfer)}},ZSINIT:function(){u._next_subpacket_handler=function(y){u._next_subpacket_handler=null,u._consume_ZSINIT_data(y),u._send_header("ZACK"),u._next_header_handler=b}},ZFIN:function(){this._consume_ZFIN(),y()}};u._next_header_handler=b}))}_consume_ZSINIT_data(u){this._attn=u.get_payload()}start(){if(this._started)throw"Already started!";this._started=!0;var u=this._make_promise_for_between_files();return this._send_ZRINIT(),u}_accept(u){this._accepted_offer=!0,this._file_offset=u||0;var y=this,b=new Promise((function(u){y._next_header_handler={ZDATA:function(y){this._consume_ZDATA(y),this._next_subpacket_handler=this._consume_ZDATA_data,this._next_header_handler={ZEOF:function(y){this._next_subpacket_handler=null,this._consume_ZEOF(y);var b=this._make_promise_for_between_files();u(b)}}}}}));return this._send_ZRPOS(),b}_skip(){var u=this._make_promise_for_between_files();if(this._accepted_offer){var y=function(){this._accepted_offer=!1,this._next_subpacket_handler=null,this._make_promise_for_between_files()}.bind(this);Object.assign(this._next_header_handler,{ZEOF:y,ZDATA:function(){y(),this._next_header_handler.ZEOF=y}.bind(this)})}return this._file_info=null,this._send_header("ZSKIP"),u}_send_ZRINIT(){this._send_header("ZRINIT",k)}_consume_ZFIN(){this._got_ZFIN=!0,this._send_header("ZFIN")}_consume_ZEOF(u){if(this._file_offset!==u.get_offset())throw"ZEOF offset mismatch; unimplemented (local: "+this._file_offset+"; ZEOF: "+u.get_offset()+")";this._send_ZRINIT(),this._on_file_end(),this._file_info=null,this._current_transfer=null}_consume_ZDATA(u){if(this._file_offset!==u.get_offset())throw"Error correction is unimplemented.";this._offset_ok=!0}_send_ZRPOS(){this._send_header("ZRPOS",this._file_offset)}_on_file_end(){this._Happen("file_end"),this._current_transfer&&(this._current_transfer._Happen("complete"),this._current_transfer=null)}_on_data_in(u){this._Happen("data_in",u),this._current_transfer&&this._current_transfer._Happen("input",u.get_payload())}},Object.assign(x.Session.Receive.prototype,{type:"receive"});var H={get_details:function(){return Object.assign({},this._file_info)},get_options:function(){return Object.assign({},this._zfile_opts)},get_offset:function(){return this._file_offset}};class p{constructor(u,y,b,x){this._file_info=u,this._file_offset=y||0,this._send=b,this._end=x}send(u){this._send(u),this._file_offset+=u.length}end(u){var y=this._end(u||[]);return u&&(this._file_offset+=u.length),y}}Object.assign(p.prototype,H);class f extends l{constructor(u,y,b,x){super(),this._zfile_opts=u,this._file_info=y,this._accept_func=b,this._skip_func=x,this._Add_event("input"),this._Add_event("complete"),this.on("input",this._input_handler)}_verify_not_skipped(){if(this._skipped)throw new x.Error("Already skipped!")}skip(){return this._verify_not_skipped(),this._skipped=!0,this._skip_func.apply(this,arguments)}accept(u){if(this._verify_not_skipped(),this._accepted)throw new x.Error("Already accepted!");switch(this._accepted=!0,u||(u={}),this._file_offset=u.offset||0,u.on_input){case null:case void 0:case"spool_array":case B:this._spool=[];break;default:if("function"!=typeof u.on_input)throw"Invalid “on_input”: "+u.on_input}return this._input_handler_mode=u.on_input||B,this._accept_func(this._file_offset).then(this._get_spool.bind(this))}_input_handler(u){if(this._file_offset+=u.length,"function"==typeof this._input_handler_mode)this._input_handler_mode(u);else{if(this._input_handler_mode===B)u=new Uint8Array(u);else if("spool_array"!==this._input_handler_mode)throw new x.Error("WTF?? _input_handler_mode = "+this._input_handler_mode);this._spool.push(u)}}_get_spool(){return this._spool}}Object.assign(f.prototype,H);const j={ZFILE:!0,ZDATA:!0};x.Session.Send=class extends x.Session{constructor(u){if(super(),!u)throw"Need first header!";if("ZRINIT"!==u.NAME)throw"First header should be ZRINIT, not "+u.NAME;this._last_header_name="ZRINIT",this._subpacket_encode_func="encode16",this._zencoder=new x.ZDLE,this._consume_ZRINIT(u),this._file_offset=0,this._start_keepalive_on_set_sender=!0}set_sender(u){return super.set_sender(u),this._start_keepalive_on_set_sender&&(this._start_keepalive_on_set_sender=!1,this._start_keepalive()),this}_get_header_formatter(u){return j[u]?"to_binary16":"to_hex"}_start_keepalive(){if(!this._keepalive_promise){var u=this;this._keepalive_promise=new Promise((function(y){u._keepalive_timeout=setTimeout(y,5e3)})).then((function(){u._next_header_handler={ZACK:function(){u._got_ZSINIT_ZACK=!0}},u._send_ZSINIT(),u._keepalive_promise=null,u._start_keepalive()}))}}_stop_keepalive(){this._keepalive_promise&&(clearTimeout(this._keepalive_timeout),this._keep_alive_promise=null)}_send_ZSINIT(){var u=[];this._zencoder.escapes_ctrl_chars()&&u.push("ESCCTL"),this._send_header_and_data(["ZSINIT",u],[0],"end_ack")}_consume_ZRINIT(u){if(this._last_ZRINIT=u,u.get_buffer_size())throw"Buffer size ("+u.get_buffer_size()+") is unsupported!";if(!u.can_full_duplex())throw"Half-duplex I/O is unsupported!";if(!u.can_overlap_io())throw"Non-overlap I/O is unsupported!";if(u.escape_8th_bit())throw"8-bit escaping is unsupported!";this._zencoder.set_escape_ctrl_chars(!0),!u.escape_ctrl_chars()&&console.debug("Peer didn’t request escape of all control characters. Will send ZSINIT to force recognition of escaped control characters.")}_ensure_receiver_escapes_ctrl_chars(){var u;if(!this._last_ZRINIT.escape_ctrl_chars()&&!this._got_ZSINIT_ZACK){var y=this;u=new Promise((function(u){y._next_header_handler={ZACK:()=>{u()}},y._send_ZSINIT()}))}else u=Promise.resolve();return u}_convert_params_to_offer_payload_array(u){var y=(u=x.Validation.offer_parameters(u)).name+"\0",b=[(u.size||0).toString(10),u.mtime?u.mtime.toString(8):"0",u.mode?(32768|u.mode).toString(8):"0","0"];return u.files_remaining&&(b.push(u.files_remaining),u.bytes_remaining&&b.push(u.bytes_remaining)),y+=b.join(" "),this._string_to_octets(y)}send_offer(u){if(!u)throw"need file params!";if(this._sending_file)throw"Already sending file!";var y=this._convert_params_to_offer_payload_array(u);this._stop_keepalive();var b=this;return this._ensure_receiver_escapes_ctrl_chars().then((function(){var x=new Promise((function(y){b._next_header_handler={ZSKIP:function(){b._start_keepalive(),y()},ZRPOS:function(x){b._sending_file=!0,y(new p(u,x.get_offset(),b._send_interim_file_piece.bind(b),b._end_file.bind(b)))}}}));return b._send_header_and_data(["ZFILE"],y,"end_ack"),delete b._sent_ZDATA,x}))}_send_header_and_data(u,y,b){var x=this._create_header_bytes(u),k=this._build_subpacket_bytes(y,b);x[0].push.apply(x[0],k),this._sender(x[0]),this._last_sent_header=x[1]}_build_subpacket_bytes(u,y){return x.Subpacket.build(u,y)[this._subpacket_encode_func](this._zencoder)}_build_and_send_subpacket(u,y){this._sender(this._build_subpacket_bytes(u,y))}_string_to_octets(u){this._textencoder||(this._textencoder=new x.Text.Encoder);var y=this._textencoder.encode(u);return Array.prototype.slice.call(y)}_send_interim_file_piece(u){return this._send_file_part(u,"no_end_no_ack"),Promise.resolve()}_ensure_we_are_sending(){if(!this._sending_file)throw"Not sending a file currently!"}_end_file(u){this._ensure_we_are_sending(),this._send_file_part(u,"end_no_ack");var y=this,b=new Promise((function(u){y._sending_file=!1,y._prepare_to_receive_ZRINIT(u)}));return this._send_header("ZEOF",this._file_offset),this._file_offset=0,b}_prepare_to_receive_ZRINIT(u){this._next_header_handler={ZRINIT:function(y){this._consume_ZRINIT(y),u&&u()}}}close(){var u="ZRINIT"===this._last_header_name;if(u||(u="ZSKIP"===this._last_header_name),u||(u="ZSINIT"===this._last_sent_header.name&&"ZACK"===this._last_header_name),!u)throw"Can’t close; last received header was “"+this._last_header_name+"”";var y=this,b=new Promise((function(u){y._next_header_handler={ZFIN:function(){y._sender(P),y._sent_OO=!0,y._on_session_end(),u()}}}));return this._send_header("ZFIN"),b}_has_ended(){return this.aborted()||!!this._sent_OO}_send_file_part(u,y){this._sent_ZDATA||(this._send_header("ZDATA",this._file_offset),this._sent_ZDATA=!0);for(var b=0,x=u.length;;){var k=Math.min(b+8192,x)-b,B=k+b>=x,P=u.slice(b,b+k);if(P instanceof Array||(P=Array.prototype.slice.call(P)),this._build_and_send_subpacket(P,B?y:"no_end_no_ack"),this._file_offset+=k,(b+=k)>=x)break}}_consume_first(){if(!this._parse_and_consume_header()&&"67"===this._input_buffer.join())throw"Receiver has fallen back to YMODEM."}_on_session_end(){this._stop_keepalive(),super._on_session_end()}},Object.assign(x.Session.Send.prototype,{type:"send"})},function(u){u.exports.Text={Encoder:"undefined"==typeof TextEncoder?class{encode(u){for(var y=Array((u=unescape(encodeURIComponent(u))).length),b=0;b<u.length;b++)y[b]=u.charCodeAt(b);return new Uint8Array(y)}}:TextEncoder,Decoder:"undefined"==typeof TextDecoder?class{decode(u){return decodeURIComponent(escape(String.fromCharCode.apply(String,u)))}}:TextDecoder}},function(u,y,b){"use strict";function a(u){var y=G[u];if("string"==typeof y)throw"Received unsupported header: "+y;return function s(u){return u.prototype instanceof S?new u(0):new u([])}(y)}function d(u){var y=x.ZDLE.splice(u,H.length,7);return y&&o(y)}function o(u){x.CRC.verify16(u.slice(0,5),u.slice(5));var y=a(u[0]);return y._bytes4=u.slice(1,5),y}function i(u){var y=x.ZDLE.splice(u,j.length,9);if(y){x.CRC.verify32(y.slice(0,5),y.slice(5));var b=a(y[0]);return b._bytes4=y.slice(1,5),b}}function l(u){var y,b,k=u.indexOf(138);if(-1===k&&(k=u.indexOf(10)),-1!==k){if(b=u.splice(0,k),u.shift(),19===b.length){var B=b.pop();13!==B&&141!==B&&(y="Invalid hex header: (CR/)LF doesn’t have CR!")}else 18!==b.length&&(y="Invalid hex header: invalid number of bytes before LF!");if(y)throw y+=" ("+b.length+" bytes: "+b.join()+")";return b.splice(0,4),o(x.ENCODELIB.parse_hex_octets(b))}11<u.length&&(y="Invalid hex header - no LF detected within 12 bytes!")}var x=u.exports;Object.assign(x,b(2),b(3),b(0),b(4),b(1));const k=42,B=[13,10],P=B.slice(0).concat([x.ZMLIB.XON]),I=[k,k,x.ZMLIB.ZDLE,66],H=[k,x.ZMLIB.ZDLE,65],j=[k,x.ZMLIB.ZDLE,67];x.Header=class{static trim_leading_garbage(u){var y,b,B=[];e:for(;u.length&&!b;){var P=u.indexOf(k);if(-1===P){y=!0;break e}if(B.push.apply(B,u.splice(0,P)),2>u.length)break e;if(u[1]===k)if(u.length<I.length){if(u.join()===I.slice(0,u.length).join())break e}else u[2]===I[2]&&u[3]===I[3]&&(b=l);else if(u[1]===x.ZMLIB.ZDLE){if(u.length<H.length)break e;u[2]===H[2]?b=d:u[2]===j[2]&&(b=i)}b||B.push(u.shift())}return y&&B.push.apply(B,u.splice(0)),B}static parse(u){var y;if(u[1]===k)return(y=l(u))&&[y,16];if(65===u[2])return(y=d(u))&&[y,16];if(67===u[2])return(y=i(u))&&[y,32];if(!(3>u.length))throw"Unrecognized/unsupported octets: "+u.join()}static build(u){var y=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),b=K[u];if(!b)throw"No frame class “"+u+"” is defined!";return y.shift(),new(b.bind.apply(b,[null].concat(y)))}to_hex(){var u=this._crc_bytes();return I.concat(x.ENCODELIB.octets_to_hex(u.concat(x.CRC.crc16(u))),this._hex_header_ending)}to_binary16(u){return this._to_binary(u,H,x.CRC.crc16)}to_binary32(u){return this._to_binary(u,j,x.CRC.crc32)}constructor(){this._bytes4||(this._bytes4=[0,0,0,0])}_to_binary(u,y,b){var x=this._crc_bytes();return y.concat(u.encode(x.concat(b(x))))}_crc_bytes(){return[this.TYPENUM].concat(this._bytes4)}},x.Header.prototype._hex_header_ending=P;class Z extends x.Header{}const N={CANFDX:1,CANOVIO:2,CANBRK:4,CANCRY:8,CANLZW:16,CANFC32:32,ESCCTL:64,ESC8:128};class E extends x.Header{constructor(u,y){super();var b=0;y||(y=0),u.forEach((function(u){b|=function t(u){if(!N[u])throw new x.Error("Invalid ZRINIT flag: "+u);return N[u]}(u)})),this._bytes4=[255&y,y>>8,0,b]}get_buffer_size(){return x.ENCODELIB.unpack_u16_be(this._bytes4.slice(0,2))||void 0}can_full_duplex(){return!!(this._bytes4[3]&N.CANFDX)}can_overlap_io(){return!!(this._bytes4[3]&N.CANOVIO)}can_break(){return!!(this._bytes4[3]&N.CANBRK)}can_fcs_32(){return!!(this._bytes4[3]&N.CANFC32)}escape_ctrl_chars(){return!!(this._bytes4[3]&N.ESCCTL)}escape_8th_bit(){return!!(this._bytes4[3]&N.ESC8)}}const q={ESCCTL:64,ESC8:128};class v extends x.Header{constructor(u,y){super();var b=0;if(u.forEach((function(u){b|=function r(u){if(!q[u])throw"Invalid ZSINIT flag: "+u;return q[u]}(u)})),this._bytes4=[0,0,0,b],y){if(31<y.length)throw"Attn sequence must be <= 31 bytes";if(y.some((function(u){return 255<u})))throw"Attn sequence ("+y+") must be <256";this._data=y.concat([0])}}escape_ctrl_chars(){return!!(this._bytes4[3]&q.ESCCTL)}escape_8th_bit(){return!!(this._bytes4[3]&q.ESC8)}}class C extends x.Header{constructor(u){super(),u&&(this._bytes4=u.slice())}}C.prototype._hex_header_ending=B;const W={extended:{sparse:64},transport:[void 0,"compress","encrypt","rle"],management:[void 0,"newer_or_longer","crc","append","clobber","newer","mtime_or_length","protect","rename"],conversion:[void 0,"binary","text","resume"]},U=["extended","transport","management","conversion"];class O extends x.Header{get_options(){var u={sparse:!!(64&this._bytes4[0])},y=this._bytes4.slice(0);return U.forEach((function(b,x){if(W[b]instanceof Array)"management"===b&&(u.skip_if_absent=!!(128&y[x]),y[x]&=31),u[b]=W[b][y[x]];else for(var k in W[b])u[k]=!!(y[x]&W[b][k]),u[k]&&(y[x]^=W[b][k]);!u[b]&&y[x]&&(u[b]="unknown:"+y[x])})),u}}class A extends x.Header{}class L extends x.Header{}class T extends x.Header{}class R extends x.Header{}T.prototype._hex_header_ending=B;class S extends x.Header{constructor(u){super(),this._bytes4=x.ENCODELIB.pack_u32_le(u)}get_offset(){return x.ENCODELIB.unpack_u32_le(this._bytes4)}}class D extends S{}class M extends S{}class F extends S{}const z=[[Z,"ZRQINIT"],[E,"ZRINIT"],[v,"ZSINIT"],[C,"ZACK"],[O,"ZFILE"],[A,"ZSKIP"],void 0,[L,"ZABORT"],[T,"ZFIN"],[D,"ZRPOS"],[M,"ZDATA"],[F,"ZEOF"],[R,"ZFERR"],void 0,void 0,void 0,void 0,void 0,void 0,void 0];for(var K={},V=0;V<z.length;V++)z[V]&&(K[z[V][1]]=z[V][0],Object.assign(z[V][0].prototype,{TYPENUM:V,NAME:z[V][1]}));const G=[Z,E,v,C,O,A,"ZNAK",L,T,D,M,F,R,"ZCRC","ZCHALLENGE","ZCOMPL","ZCAN","ZFREECNT","ZCOMMAND","ZSTDERR"];x.Header.parse_hex=l},function(u,y){!function(u){"undefined"==typeof DO_NOT_EXPORT_CRC?u(y):u({})}((function(u){u.version="1.1.1";var y=function(){for(var u=0,y=Array(256),b=0;256!=b;++b)u=1&(u=1&(u=1&(u=1&(u=1&(u=1&(u=1&(u=1&(u=b)?-306674912^u>>>1:u>>>1)?-306674912^u>>>1:u>>>1)?-306674912^u>>>1:u>>>1)?-306674912^u>>>1:u>>>1)?-306674912^u>>>1:u>>>1)?-306674912^u>>>1:u>>>1)?-306674912^u>>>1:u>>>1)?-306674912^u>>>1:u>>>1,y[b]=u;return"undefined"==typeof Int32Array?y:new Int32Array(y)}();u.table=y,u.bstr=function(u,b){for(var x=-1^b,k=u.length-1,B=0;B<k;)x=(x=x>>>8^y[255&(x^u.charCodeAt(B++))])>>>8^y[255&(x^u.charCodeAt(B++))];return B==k&&(x=x>>>8^y[255&(x^u.charCodeAt(B))]),-1^x},u.buf=function(u,b){if(1e4<u.length)return function _(u,b){for(var x=-1^b,k=u.length-7,B=0;B<k;)x=(x=(x=(x=(x=(x=(x=(x=x>>>8^y[255&(x^u[B++])])>>>8^y[255&(x^u[B++])])>>>8^y[255&(x^u[B++])])>>>8^y[255&(x^u[B++])])>>>8^y[255&(x^u[B++])])>>>8^y[255&(x^u[B++])])>>>8^y[255&(x^u[B++])])>>>8^y[255&(x^u[B++])];for(;B<k+7;)x=x>>>8^y[255&(x^u[B++])];return-1^x}(u,b);for(var x=-1^b,k=u.length-3,B=0;B<k;)x=(x=(x=(x=x>>>8^y[255&(x^u[B++])])>>>8^y[255&(x^u[B++])])>>>8^y[255&(x^u[B++])])>>>8^y[255&(x^u[B++])];for(;B<k+3;)x=x>>>8^y[255&(x^u[B++])];return-1^x},u.str=function(u,b){for(var x,k,B=-1^b,P=0,I=u.length;P<I;)128>(x=u.charCodeAt(P++))?B=B>>>8^y[255&(B^x)]:2048>x?B=(B=B>>>8^y[255&(B^(192|31&x>>6))])>>>8^y[255&(B^(128|63&x))]:55296<=x&&57344>x?(x=64+(1023&x),k=1023&u.charCodeAt(P++),B=(B=(B=(B=B>>>8^y[255&(B^(240|7&x>>8))])>>>8^y[255&(B^(128|63&x>>2))])>>>8^y[255&(B^(128|15&k>>6|(3&x)<<4))])>>>8^y[255&(B^(128|63&k))]):B=(B=(B=B>>>8^y[255&(B^(224|15&x>>12))])>>>8^y[255&(B^(128|63&x>>6))])>>>8^y[255&(B^(128|63&x))];return-1^B}}))},function(u,y,b){"use strict";var x,k=u.exports;Object.assign(k,b(4),b(3),b(0),b(1)),k.Subpacket=class e{static build(u,y){var b=x[y];if(!b)throw"No subpacket type “"+y+"” is defined! Try one of: "+Object.keys(x).join(", ");return new b(u)}encode16(u){return this._encode(u,k.CRC.crc16)}encode32(u){return this._encode(u,k.CRC.crc32)}get_payload(){return this._payload}static parse16(u){return e._parse(u,2)}static parse32(u){return e._parse(u,4)}constructor(u){this._payload=u}_encode(u,y){return u.encode(this._payload.slice(0)).concat([k.ZMLIB.ZDLE,this._frameend_num],u.encode(y(this._payload.concat(this._frameend_num))))}static _parse(u,y){for(var b,x,B={104:d,105:i,106:l,107:o},P=0;P<u.length;){if(-1===(P=u.indexOf(k.ZMLIB.ZDLE,P)))return;if(x=B[u[P+1]]){b=P+1;break}P++}if(x){var I=u[b];if(u[b-1]!==k.ZMLIB.ZDLE)throw"Byte before frame end should be ZDLE, not "+u[b-1];var H=u.splice(0,b-1),j=k.ZDLE.splice(u,2,y);if(!j)return void u.unshift.apply(u,H);var N=k.ZDLE.decode(H);return k.CRC[2===y?"verify16":"verify32"](N.concat([I]),j),new x(N,j)}}};class a extends k.Subpacket{frame_end(){return!0}}class s extends k.Subpacket{frame_end(){return!1}}class d extends a{ack_expected(){return!1}}d.prototype._frameend_num=104;class o extends a{ack_expected(){return!0}}o.prototype._frameend_num=107;class i extends s{ack_expected(){return!1}}i.prototype._frameend_num=105;class l extends s{ack_expected(){return!0}}l.prototype._frameend_num=106,x={end_no_ack:d,end_ack:o,no_end_no_ack:i,no_end_ack:l}},function(u,y,b){"use strict";function t(u,y){if(0>y)throw new k.Error("validation","“"+u+"” ("+y+") must be nonnegative.");if(y!==x(y))throw new k.Error("validation","“"+u+"” ("+y+") must be an integer.")}var x=Math.floor,k=u.exports;Object.assign(k,b(1));const B=/\*\x18[AC]|\*\*\x18B/;k.Validation={offer_parameters:function(u){if(!u.name)throw new k.Error("validation","Need “name”!");if("string"!=typeof u.name)throw new k.Error("validation","“name” ("+u.name+") must be a string!");if(u=Object.assign({},u),B.test(u.name)&&console.warn("The filename "+JSON.stringify(name)+" contains characters that look like a ZMODEM header. This could corrupt the ZMODEM session; consider renaming it so that the filename doesn’t contain control characters."),null!==u.serial&&void 0!==u.serial)throw new k.Error("validation","“serial” is meaningless.");if(u.serial=null,["size","mode","files_remaining","bytes_remaining"].forEach((function(y){var b;switch(typeof u[y]){case"object":b=null===u[y];break;case"undefined":u[y]=null,b=!0;break;case"number":t(y,u[y]),b=!0}if(!b)throw new k.Error("validation","“"+y+"” ("+u[y]+") must be null, undefined, or a number.")})),"number"==typeof u.mode&&(u.mode|=32768),0===u.files_remaining)throw new k.Error("validation","“files_remaining”, if given, must be positive.");var y;switch(typeof u.mtime){case"object":if(y=!0,u.mtime instanceof Date){var b=u.mtime;if(u.mtime=x(b.getTime()/1e3),0>u.mtime)throw new k.Error("validation","“mtime” ("+b+") must not be earlier than 1970.")}else null!==u.mtime&&(y=!1);break;case"undefined":u.mtime=null,y=!0;break;case"number":t("mtime",u.mtime),y=!0}if(!y)throw new k.Error("validation","“mtime” ("+u.mtime+") must be null, undefined, a Date, or a number.");return u}}}])},758:u=>{self,u.exports=(()=>{"use strict";var u={775:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.FitAddon=void 0;var b=function(){function e(){}return e.prototype.activate=function(u){this._terminal=u},e.prototype.dispose=function(){},e.prototype.fit=function(){var u=this.proposeDimensions();if(u&&this._terminal){var y=this._terminal._core;this._terminal.rows===u.rows&&this._terminal.cols===u.cols||(y._renderService.clear(),this._terminal.resize(u.cols,u.rows))}},e.prototype.proposeDimensions=function(){if(this._terminal&&this._terminal.element&&this._terminal.element.parentElement){var u=this._terminal._core;if(0!==u._renderService.dimensions.actualCellWidth&&0!==u._renderService.dimensions.actualCellHeight){var y=window.getComputedStyle(this._terminal.element.parentElement),b=parseInt(y.getPropertyValue("height")),x=Math.max(0,parseInt(y.getPropertyValue("width"))),k=window.getComputedStyle(this._terminal.element),B=b-(parseInt(k.getPropertyValue("padding-top"))+parseInt(k.getPropertyValue("padding-bottom"))),P=x-(parseInt(k.getPropertyValue("padding-right"))+parseInt(k.getPropertyValue("padding-left")))-u.viewport.scrollBarWidth;return{cols:Math.max(2,Math.floor(P/u._renderService.dimensions.actualCellWidth)),rows:Math.max(1,Math.floor(B/u._renderService.dimensions.actualCellHeight))}}}},e}();y.FitAddon=b}},y={};return function r(b){if(y[b])return y[b].exports;var x=y[b]={exports:{}};return u[b](x,x.exports,r),x.exports}(775)})()},997:u=>{self,u.exports=(()=>{"use strict";var u={4567:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)});Object.defineProperty(y,"__esModule",{value:!0}),y.AccessibilityManager=void 0;var B=b(9042),P=b(6114),I=b(9924),H=b(3656),j=b(844),N=b(5596),q=b(9631),W=function(u){function t(y,b){var x=u.call(this)||this;x._terminal=y,x._renderService=b,x._liveRegionLineCount=0,x._charsToConsume=[],x._charsToAnnounce="",x._accessibilityTreeRoot=document.createElement("div"),x._accessibilityTreeRoot.classList.add("xterm-accessibility"),x._accessibilityTreeRoot.tabIndex=0,x._rowContainer=document.createElement("div"),x._rowContainer.setAttribute("role","list"),x._rowContainer.classList.add("xterm-accessibility-tree"),x._rowElements=[];for(var k=0;k<x._terminal.rows;k++)x._rowElements[k]=x._createAccessibilityTreeNode(),x._rowContainer.appendChild(x._rowElements[k]);if(x._topBoundaryFocusListener=function(u){return x._onBoundaryFocus(u,0)},x._bottomBoundaryFocusListener=function(u){return x._onBoundaryFocus(u,1)},x._rowElements[0].addEventListener("focus",x._topBoundaryFocusListener),x._rowElements[x._rowElements.length-1].addEventListener("focus",x._bottomBoundaryFocusListener),x._refreshRowsDimensions(),x._accessibilityTreeRoot.appendChild(x._rowContainer),x._renderRowsDebouncer=new I.TimeBasedDebouncer(x._renderRows.bind(x)),x._refreshRows(),x._liveRegion=document.createElement("div"),x._liveRegion.classList.add("live-region"),x._liveRegion.setAttribute("aria-live","assertive"),x._accessibilityTreeRoot.appendChild(x._liveRegion),!x._terminal.element)throw Error("Cannot enable accessibility before Terminal.open");return x._terminal.element.insertAdjacentElement("afterbegin",x._accessibilityTreeRoot),x.register(x._renderRowsDebouncer),x.register(x._terminal.onResize((function(u){return x._onResize(u.rows)}))),x.register(x._terminal.onRender((function(u){return x._refreshRows(u.start,u.end)}))),x.register(x._terminal.onScroll((function(){return x._refreshRows()}))),x.register(x._terminal.onA11yChar((function(u){return x._onChar(u)}))),x.register(x._terminal.onLineFeed((function(){return x._onChar("\n")}))),x.register(x._terminal.onA11yTab((function(u){return x._onTab(u)}))),x.register(x._terminal.onKey((function(u){return x._onKey(u.key)}))),x.register(x._terminal.onBlur((function(){return x._clearLiveRegion()}))),x.register(x._renderService.onDimensionsChange((function(){return x._refreshRowsDimensions()}))),x._screenDprMonitor=new N.ScreenDprMonitor,x.register(x._screenDprMonitor),x._screenDprMonitor.setListener((function(){return x._refreshRowsDimensions()})),x.register((0,H.addDisposableDomListener)(window,"resize",(function(){return x._refreshRowsDimensions()}))),x}return k(t,u),t.prototype.dispose=function(){u.prototype.dispose.call(this),(0,q.removeElementFromParent)(this._accessibilityTreeRoot),this._rowElements.length=0},t.prototype._onBoundaryFocus=function(u,y){var b=u.target,x=this._rowElements[0===y?1:this._rowElements.length-2];if(b.getAttribute("aria-posinset")!==(0===y?"1":""+this._terminal.buffer.lines.length)&&u.relatedTarget===x){var k,B;if(0===y?(k=b,B=this._rowElements.pop(),this._rowContainer.removeChild(B)):(k=this._rowElements.shift(),B=b,this._rowContainer.removeChild(k)),k.removeEventListener("focus",this._topBoundaryFocusListener),B.removeEventListener("focus",this._bottomBoundaryFocusListener),0===y){var P=this._createAccessibilityTreeNode();this._rowElements.unshift(P),this._rowContainer.insertAdjacentElement("afterbegin",P)}else P=this._createAccessibilityTreeNode(),this._rowElements.push(P),this._rowContainer.appendChild(P);this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(0===y?-1:1),this._rowElements[0===y?1:this._rowElements.length-2].focus(),u.preventDefault(),u.stopImmediatePropagation()}},t.prototype._onResize=function(u){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(var y=this._rowContainer.children.length;y<this._terminal.rows;y++)this._rowElements[y]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[y]);for(;this._rowElements.length>u;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()},t.prototype._createAccessibilityTreeNode=function(){var u=document.createElement("div");return u.setAttribute("role","listitem"),u.tabIndex=-1,this._refreshRowDimensions(u),u},t.prototype._onTab=function(u){for(var y=0;y<u;y++)this._onChar(" ")},t.prototype._onChar=function(u){var y=this;this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==u&&(this._charsToAnnounce+=u):this._charsToAnnounce+=u,"\n"===u&&(this._liveRegionLineCount++,21===this._liveRegionLineCount&&(this._liveRegion.textContent+=B.tooMuchOutput)),P.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout((function(){y._accessibilityTreeRoot.appendChild(y._liveRegion)}),0))},t.prototype._clearLiveRegion=function(){this._liveRegion.textContent="",this._liveRegionLineCount=0,P.isMac&&(0,q.removeElementFromParent)(this._liveRegion)},t.prototype._onKey=function(u){this._clearLiveRegion(),this._charsToConsume.push(u)},t.prototype._refreshRows=function(u,y){this._renderRowsDebouncer.refresh(u,y,this._terminal.rows)},t.prototype._renderRows=function(u,y){for(var b=this._terminal.buffer,x=b.lines.length.toString(),k=u;k<=y;k++){var B=b.translateBufferLineToString(b.ydisp+k,!0),P=""+(b.ydisp+k+1),I=this._rowElements[k];I&&(0===B.length?I.innerText=" ":I.textContent=B,I.setAttribute("aria-posinset",P),I.setAttribute("aria-setsize",x))}this._announceCharacters()},t.prototype._refreshRowsDimensions=function(){if(this._renderService.dimensions.actualCellHeight){this._rowElements.length!==this._terminal.rows&&this._onResize(this._terminal.rows);for(var u=0;u<this._terminal.rows;u++)this._refreshRowDimensions(this._rowElements[u])}},t.prototype._refreshRowDimensions=function(u){u.style.height=this._renderService.dimensions.actualCellHeight+"px"},t.prototype._announceCharacters=function(){0!==this._charsToAnnounce.length&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")},t}(j.Disposable);y.AccessibilityManager=W},3614:(u,y)=>{function r(u){return u.replace(/\r?\n/g,"\r")}function i(u,y){return y?"[200~"+u+"[201~":u}function n(u,y,b){u=i(u=r(u),b.decPrivateModes.bracketedPasteMode),b.triggerDataEvent(u,!0),y.value=""}function o(u,y,b){var x=b.getBoundingClientRect(),k=u.clientX-x.left-10,B=u.clientY-x.top-10;y.style.width="20px",y.style.height="20px",y.style.left=k+"px",y.style.top=B+"px",y.style.zIndex="1000",y.focus()}Object.defineProperty(y,"__esModule",{value:!0}),y.rightClickHandler=y.moveTextAreaUnderMouseCursor=y.paste=y.handlePasteEvent=y.copyHandler=y.bracketTextForPaste=y.prepareTextForTerminal=void 0,y.prepareTextForTerminal=r,y.bracketTextForPaste=i,y.copyHandler=function(u,y){u.clipboardData&&u.clipboardData.setData("text/plain",y.selectionText),u.preventDefault()},y.handlePasteEvent=function(u,y,b){u.stopPropagation(),u.clipboardData&&n(u.clipboardData.getData("text/plain"),y,b)},y.paste=n,y.moveTextAreaUnderMouseCursor=o,y.rightClickHandler=function(u,y,b,x,k){o(u,y,b),k&&x.rightClickSelect(u),y.value=x.selectionText,y.select()}},7239:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.ColorContrastCache=void 0;var b=function(){function e(){this._color={},this._rgba={}}return e.prototype.clear=function(){this._color={},this._rgba={}},e.prototype.setCss=function(u,y,b){this._rgba[u]||(this._rgba[u]={}),this._rgba[u][y]=b},e.prototype.getCss=function(u,y){return this._rgba[u]?this._rgba[u][y]:void 0},e.prototype.setColor=function(u,y,b){this._color[u]||(this._color[u]={}),this._color[u][y]=b},e.prototype.getColor=function(u,y){return this._color[u]?this._color[u][y]:void 0},e}();y.ColorContrastCache=b},5680:function(u,y,b){var x=this&&this.__read||function(u,y){var b="function"==typeof Symbol&&u[Symbol.iterator];if(!b)return u;var x,k,B=b.call(u),P=[];try{for(;(void 0===y||y-- >0)&&!(x=B.next()).done;)P.push(x.value)}catch(u){k={error:u}}finally{try{x&&!x.done&&(b=B.return)&&b.call(B)}finally{if(k)throw k.error}}return P};Object.defineProperty(y,"__esModule",{value:!0}),y.ColorManager=y.DEFAULT_ANSI_COLORS=void 0;var k=b(8055),B=b(7239),P=k.css.toColor("#ffffff"),I=k.css.toColor("#000000"),H=k.css.toColor("#ffffff"),j=k.css.toColor("#000000"),N={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};y.DEFAULT_ANSI_COLORS=Object.freeze(function(){for(var u=[k.css.toColor("#2e3436"),k.css.toColor("#cc0000"),k.css.toColor("#4e9a06"),k.css.toColor("#c4a000"),k.css.toColor("#3465a4"),k.css.toColor("#75507b"),k.css.toColor("#06989a"),k.css.toColor("#d3d7cf"),k.css.toColor("#555753"),k.css.toColor("#ef2929"),k.css.toColor("#8ae234"),k.css.toColor("#fce94f"),k.css.toColor("#729fcf"),k.css.toColor("#ad7fa8"),k.css.toColor("#34e2e2"),k.css.toColor("#eeeeec")],y=[0,95,135,175,215,255],b=0;b<216;b++){var x=y[b/36%6|0],B=y[b/6%6|0],P=y[b%6];u.push({css:k.channels.toCss(x,B,P),rgba:k.channels.toRgba(x,B,P)})}for(b=0;b<24;b++){var I=8+10*b;u.push({css:k.channels.toCss(I,I,I),rgba:k.channels.toRgba(I,I,I)})}return u}());var q=function(){function e(u,b){this.allowTransparency=b;var x=u.createElement("canvas");x.width=1,x.height=1;var q=x.getContext("2d");if(!q)throw Error("Could not get rendering context");this._ctx=q,this._ctx.globalCompositeOperation="copy",this._litmusColor=this._ctx.createLinearGradient(0,0,1,1),this._contrastCache=new B.ColorContrastCache,this.colors={foreground:P,background:I,cursor:H,cursorAccent:j,selectionTransparent:N,selectionOpaque:k.color.blend(I,N),selectionForeground:void 0,ansi:y.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors()}return e.prototype.onOptionsChange=function(u){"minimumContrastRatio"===u&&this._contrastCache.clear()},e.prototype.setTheme=function(u){void 0===u&&(u={}),this.colors.foreground=this._parseColor(u.foreground,P),this.colors.background=this._parseColor(u.background,I),this.colors.cursor=this._parseColor(u.cursor,H,!0),this.colors.cursorAccent=this._parseColor(u.cursorAccent,j,!0),this.colors.selectionTransparent=this._parseColor(u.selection,N,!0),this.colors.selectionOpaque=k.color.blend(this.colors.background,this.colors.selectionTransparent);var b={css:"",rgba:0};this.colors.selectionForeground=u.selectionForeground?this._parseColor(u.selectionForeground,b):void 0,this.colors.selectionForeground===b&&(this.colors.selectionForeground=void 0),k.color.isOpaque(this.colors.selectionTransparent)&&(this.colors.selectionTransparent=k.color.opacity(this.colors.selectionTransparent,.3)),this.colors.ansi[0]=this._parseColor(u.black,y.DEFAULT_ANSI_COLORS[0]),this.colors.ansi[1]=this._parseColor(u.red,y.DEFAULT_ANSI_COLORS[1]),this.colors.ansi[2]=this._parseColor(u.green,y.DEFAULT_ANSI_COLORS[2]),this.colors.ansi[3]=this._parseColor(u.yellow,y.DEFAULT_ANSI_COLORS[3]),this.colors.ansi[4]=this._parseColor(u.blue,y.DEFAULT_ANSI_COLORS[4]),this.colors.ansi[5]=this._parseColor(u.magenta,y.DEFAULT_ANSI_COLORS[5]),this.colors.ansi[6]=this._parseColor(u.cyan,y.DEFAULT_ANSI_COLORS[6]),this.colors.ansi[7]=this._parseColor(u.white,y.DEFAULT_ANSI_COLORS[7]),this.colors.ansi[8]=this._parseColor(u.brightBlack,y.DEFAULT_ANSI_COLORS[8]),this.colors.ansi[9]=this._parseColor(u.brightRed,y.DEFAULT_ANSI_COLORS[9]),this.colors.ansi[10]=this._parseColor(u.brightGreen,y.DEFAULT_ANSI_COLORS[10]),this.colors.ansi[11]=this._parseColor(u.brightYellow,y.DEFAULT_ANSI_COLORS[11]),this.colors.ansi[12]=this._parseColor(u.brightBlue,y.DEFAULT_ANSI_COLORS[12]),this.colors.ansi[13]=this._parseColor(u.brightMagenta,y.DEFAULT_ANSI_COLORS[13]),this.colors.ansi[14]=this._parseColor(u.brightCyan,y.DEFAULT_ANSI_COLORS[14]),this.colors.ansi[15]=this._parseColor(u.brightWhite,y.DEFAULT_ANSI_COLORS[15]),this._contrastCache.clear(),this._updateRestoreColors()},e.prototype.restoreColor=function(u){if(void 0!==u)switch(u){case 256:this.colors.foreground=this._restoreColors.foreground;break;case 257:this.colors.background=this._restoreColors.background;break;case 258:this.colors.cursor=this._restoreColors.cursor;break;default:this.colors.ansi[u]=this._restoreColors.ansi[u]}else for(var y=0;y<this._restoreColors.ansi.length;++y)this.colors.ansi[y]=this._restoreColors.ansi[y]},e.prototype._updateRestoreColors=function(){this._restoreColors={foreground:this.colors.foreground,background:this.colors.background,cursor:this.colors.cursor,ansi:this.colors.ansi.slice()}},e.prototype._parseColor=function(u,y,b){if(void 0===b&&(b=this.allowTransparency),void 0===u)return y;if(this._ctx.fillStyle=this._litmusColor,this._ctx.fillStyle=u,"string"!=typeof this._ctx.fillStyle)return console.warn("Color: "+u+" is invalid using fallback "+y.css),y;this._ctx.fillRect(0,0,1,1);var B=this._ctx.getImageData(0,0,1,1).data;if(255!==B[3]){if(!b)return console.warn("Color: "+u+" is using transparency, but allowTransparency is false. Using fallback "+y.css+"."),y;var P=x(this._ctx.fillStyle.substring(5,this._ctx.fillStyle.length-1).split(",").map((function(u){return Number(u)})),4),I=P[0],H=P[1],j=P[2],N=P[3],q=Math.round(255*N);return{rgba:k.channels.toRgba(I,H,j,q),css:u}}return{css:this._ctx.fillStyle,rgba:k.channels.toRgba(B[0],B[1],B[2],B[3])}},e}();y.ColorManager=q},9631:function(u,y){var b=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.removeElementFromParent=void 0,y.removeElementFromParent=function(){for(var u,y,x,k=[],B=0;B<arguments.length;B++)k[B]=arguments[B];try{for(var P=b(k),I=P.next();!I.done;I=P.next()){var H=I.value;null===(x=null==H?void 0:H.parentElement)||void 0===x||x.removeChild(H)}}catch(y){u={error:y}}finally{try{I&&!I.done&&(y=P.return)&&y.call(P)}finally{if(u)throw u.error}}}},3656:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.addDisposableDomListener=void 0,y.addDisposableDomListener=function(u,y,b,x){u.addEventListener(y,b,x);var k=!1;return{dispose:function(){k||(k=!0,u.removeEventListener(y,b,x))}}}},3551:function(u,y,b){var x=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},k=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.MouseZone=y.Linkifier=void 0;var B=b(8460),P=b(2585),I=function(){function e(u,y,b){this._bufferService=u,this._logService=y,this._unicodeService=b,this._linkMatchers=[],this._nextLinkMatcherId=0,this._onShowLinkUnderline=new B.EventEmitter,this._onHideLinkUnderline=new B.EventEmitter,this._onLinkTooltip=new B.EventEmitter,this._rowsToLinkify={start:void 0,end:void 0}}return Object.defineProperty(e.prototype,"onShowLinkUnderline",{get:function(){return this._onShowLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onHideLinkUnderline",{get:function(){return this._onHideLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onLinkTooltip",{get:function(){return this._onLinkTooltip.event},enumerable:!1,configurable:!0}),e.prototype.attachToDom=function(u,y){this._element=u,this._mouseZoneManager=y},e.prototype.linkifyRows=function(u,y){var b=this;this._mouseZoneManager&&(void 0===this._rowsToLinkify.start||void 0===this._rowsToLinkify.end?(this._rowsToLinkify.start=u,this._rowsToLinkify.end=y):(this._rowsToLinkify.start=Math.min(this._rowsToLinkify.start,u),this._rowsToLinkify.end=Math.max(this._rowsToLinkify.end,y)),this._mouseZoneManager.clearAll(u,y),this._rowsTimeoutId&&clearTimeout(this._rowsTimeoutId),this._rowsTimeoutId=setTimeout((function(){return b._linkifyRows()}),e._timeBeforeLatency))},e.prototype._linkifyRows=function(){this._rowsTimeoutId=void 0;var u=this._bufferService.buffer;if(void 0!==this._rowsToLinkify.start&&void 0!==this._rowsToLinkify.end){var y=u.ydisp+this._rowsToLinkify.start;if(!(y>=u.lines.length)){for(var b=u.ydisp+Math.min(this._rowsToLinkify.end,this._bufferService.rows)+1,x=Math.ceil(2e3/this._bufferService.cols),k=this._bufferService.buffer.iterator(!1,y,b,x,x);k.hasNext();)for(var B=k.next(),P=0;P<this._linkMatchers.length;P++)this._doLinkifyRow(B.range.first,B.content,this._linkMatchers[P]);this._rowsToLinkify.start=void 0,this._rowsToLinkify.end=void 0}}else this._logService.debug("_rowToLinkify was unset before _linkifyRows was called")},e.prototype.registerLinkMatcher=function(u,y,b){if(void 0===b&&(b={}),!y)throw Error("handler must be defined");var x={id:this._nextLinkMatcherId++,regex:u,handler:y,matchIndex:b.matchIndex,validationCallback:b.validationCallback,hoverTooltipCallback:b.tooltipCallback,hoverLeaveCallback:b.leaveCallback,willLinkActivate:b.willLinkActivate,priority:b.priority||0};return this._addLinkMatcherToList(x),x.id},e.prototype._addLinkMatcherToList=function(u){if(0!==this._linkMatchers.length){for(var y=this._linkMatchers.length-1;y>=0;y--)if(u.priority<=this._linkMatchers[y].priority)return void this._linkMatchers.splice(y+1,0,u);this._linkMatchers.splice(0,0,u)}else this._linkMatchers.push(u)},e.prototype.deregisterLinkMatcher=function(u){for(var y=0;y<this._linkMatchers.length;y++)if(this._linkMatchers[y].id===u)return this._linkMatchers.splice(y,1),!0;return!1},e.prototype._doLinkifyRow=function(u,y,b){for(var x,k=this,B=RegExp(b.regex.source,(b.regex.flags||"")+"g"),P=-1,a=function(){var H=x["number"!=typeof b.matchIndex?0:b.matchIndex];if(!H)return I._logService.debug("match found without corresponding matchIndex",x,b),"break";if(P=y.indexOf(H,P+1),B.lastIndex=P+H.length,P<0)return"break";var j=I._bufferService.buffer.stringIndexToBufferIndex(u,P);if(j[0]<0)return"break";var N=I._bufferService.buffer.lines.get(j[0]);if(!N)return"break";var q=N.getFg(j[1]),W=q?q>>9&511:void 0;b.validationCallback?b.validationCallback(H,(function(u){k._rowsTimeoutId||u&&k._addLink(j[1],j[0]-k._bufferService.buffer.ydisp,H,b,W)})):I._addLink(j[1],j[0]-I._bufferService.buffer.ydisp,H,b,W)},I=this;null!==(x=B.exec(y))&&"break"!==a(););},e.prototype._addLink=function(u,y,b,x,k){var B=this;if(this._mouseZoneManager&&this._element){var P=this._unicodeService.getStringCellWidth(b),I=u%this._bufferService.cols,H=y+Math.floor(u/this._bufferService.cols),j=(I+P)%this._bufferService.cols,N=H+Math.floor((I+P)/this._bufferService.cols);0===j&&(j=this._bufferService.cols,N--),this._mouseZoneManager.add(new c(I+1,H+1,j+1,N+1,(function(u){if(x.handler)return x.handler(u,b);var y=window.open();y?(y.opener=null,y.location.href=b):console.warn("Opening link blocked as opener could not be cleared")}),(function(){B._onShowLinkUnderline.fire(B._createLinkHoverEvent(I,H,j,N,k)),B._element.classList.add("xterm-cursor-pointer")}),(function(u){B._onLinkTooltip.fire(B._createLinkHoverEvent(I,H,j,N,k)),x.hoverTooltipCallback&&x.hoverTooltipCallback(u,b,{start:{x:I,y:H},end:{x:j,y:N}})}),(function(){B._onHideLinkUnderline.fire(B._createLinkHoverEvent(I,H,j,N,k)),B._element.classList.remove("xterm-cursor-pointer"),x.hoverLeaveCallback&&x.hoverLeaveCallback()}),(function(u){return!x.willLinkActivate||x.willLinkActivate(u,b)})))}},e.prototype._createLinkHoverEvent=function(u,y,b,x,k){return{x1:u,y1:y,x2:b,y2:x,cols:this._bufferService.cols,fg:k}},e._timeBeforeLatency=200,e=x([k(0,P.IBufferService),k(1,P.ILogService),k(2,P.IUnicodeService)],e)}();y.Linkifier=I;var c=function(u,y,b,x,k,B,P,I,H){this.x1=u,this.y1=y,this.x2=b,this.y2=x,this.clickCallback=k,this.hoverCallback=B,this.tooltipCallback=P,this.leaveCallback=I,this.willLinkActivate=H};y.MouseZone=c},6465:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}},I=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")},H=this&&this.__read||function(u,y){var b="function"==typeof Symbol&&u[Symbol.iterator];if(!b)return u;var x,k,B=b.call(u),P=[];try{for(;(void 0===y||y-- >0)&&!(x=B.next()).done;)P.push(x.value)}catch(u){k={error:u}}finally{try{x&&!x.done&&(b=B.return)&&b.call(B)}finally{if(k)throw k.error}}return P};Object.defineProperty(y,"__esModule",{value:!0}),y.Linkifier2=void 0;var j=b(2585),N=b(8460),q=b(844),W=b(3656),U=function(u){function t(y){var b=u.call(this)||this;return b._bufferService=y,b._linkProviders=[],b._linkCacheDisposables=[],b._isMouseOut=!0,b._activeLine=-1,b._onShowLinkUnderline=b.register(new N.EventEmitter),b._onHideLinkUnderline=b.register(new N.EventEmitter),b.register((0,q.getDisposeArrayDisposable)(b._linkCacheDisposables)),b}return k(t,u),Object.defineProperty(t.prototype,"currentLink",{get:function(){return this._currentLink},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onShowLinkUnderline",{get:function(){return this._onShowLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onHideLinkUnderline",{get:function(){return this._onHideLinkUnderline.event},enumerable:!1,configurable:!0}),t.prototype.registerLinkProvider=function(u){var y=this;return this._linkProviders.push(u),{dispose:function(){var b=y._linkProviders.indexOf(u);-1!==b&&y._linkProviders.splice(b,1)}}},t.prototype.attachToDom=function(u,y,b){var x=this;this._element=u,this._mouseService=y,this._renderService=b,this.register((0,W.addDisposableDomListener)(this._element,"mouseleave",(function(){x._isMouseOut=!0,x._clearCurrentLink()}))),this.register((0,W.addDisposableDomListener)(this._element,"mousemove",this._onMouseMove.bind(this))),this.register((0,W.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,W.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))},t.prototype._onMouseMove=function(u){if(this._lastMouseEvent=u,this._element&&this._mouseService){var y=this._positionFromMouseEvent(u,this._element,this._mouseService);if(y){this._isMouseOut=!1;for(var b=u.composedPath(),x=0;x<b.length;x++){var k=b[x];if(k.classList.contains("xterm"))break;if(k.classList.contains("xterm-hover"))return}this._lastBufferCell&&y.x===this._lastBufferCell.x&&y.y===this._lastBufferCell.y||(this._onHover(y),this._lastBufferCell=y)}}},t.prototype._onHover=function(u){if(this._activeLine!==u.y)return this._clearCurrentLink(),void this._askForLink(u,!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,u)||(this._clearCurrentLink(),this._askForLink(u,!0))},t.prototype._askForLink=function(u,y){var b,x,k,B,P=this;this._activeProviderReplies&&y||(null===(k=this._activeProviderReplies)||void 0===k||k.forEach((function(u){null==u||u.forEach((function(u){u.link.dispose&&u.link.dispose()}))})),this._activeProviderReplies=new Map,this._activeLine=u.y);var j=!1,h=function(b,x){y?(null===(B=N._activeProviderReplies)||void 0===B?void 0:B.get(b))&&(j=N._checkLinkProviderResult(b,u,j)):x.provideLinks(u.y,(function(y){var x,k;if(!P._isMouseOut){var B=null==y?void 0:y.map((function(u){return{link:u}}));null===(x=P._activeProviderReplies)||void 0===x||x.set(b,B),j=P._checkLinkProviderResult(b,u,j),(null===(k=P._activeProviderReplies)||void 0===k?void 0:k.size)===P._linkProviders.length&&P._removeIntersectingLinks(u.y,P._activeProviderReplies)}}))},N=this;try{for(var q=I(this._linkProviders.entries()),W=q.next();!W.done;W=q.next()){var U=H(W.value,2);h(U[0],U[1])}}catch(u){b={error:u}}finally{try{W&&!W.done&&(x=q.return)&&x.call(q)}finally{if(b)throw b.error}}},t.prototype._removeIntersectingLinks=function(u,y){for(var b=new Set,x=0;x<y.size;x++){var k=y.get(x);if(k)for(var B=0;B<k.length;B++)for(var P=k[B],I=P.link.range.start.y<u?0:P.link.range.start.x,H=P.link.range.end.y>u?this._bufferService.cols:P.link.range.end.x,j=I;j<=H;j++){if(b.has(j)){k.splice(B--,1);break}b.add(j)}}},t.prototype._checkLinkProviderResult=function(u,y,b){var x,k=this;if(!this._activeProviderReplies)return b;for(var B=this._activeProviderReplies.get(u),P=!1,I=0;I<u;I++)this._activeProviderReplies.has(I)&&!this._activeProviderReplies.get(I)||(P=!0);if(!P&&B){var H=B.find((function(u){return k._linkAtPosition(u.link,y)}));H&&(b=!0,this._handleNewLink(H))}if(this._activeProviderReplies.size===this._linkProviders.length&&!b)for(I=0;I<this._activeProviderReplies.size;I++){var j=null===(x=this._activeProviderReplies.get(I))||void 0===x?void 0:x.find((function(u){return k._linkAtPosition(u.link,y)}));if(j){b=!0,this._handleNewLink(j);break}}return b},t.prototype._handleMouseDown=function(){this._mouseDownLink=this._currentLink},t.prototype._handleMouseUp=function(u){if(this._element&&this._mouseService&&this._currentLink){var y=this._positionFromMouseEvent(u,this._element,this._mouseService);y&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,y)&&this._currentLink.link.activate(u,this._currentLink.link.text)}},t.prototype._clearCurrentLink=function(u,y){this._element&&this._currentLink&&this._lastMouseEvent&&(!u||!y||this._currentLink.link.range.start.y>=u&&this._currentLink.link.range.end.y<=y)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,q.disposeArray)(this._linkCacheDisposables))},t.prototype._handleNewLink=function(u){var y=this;if(this._element&&this._lastMouseEvent&&this._mouseService){var b=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);b&&this._linkAtPosition(u.link,b)&&(this._currentLink=u,this._currentLink.state={decorations:{underline:void 0===u.link.decorations||u.link.decorations.underline,pointerCursor:void 0===u.link.decorations||u.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,u.link,this._lastMouseEvent),u.link.decorations={},Object.defineProperties(u.link.decorations,{pointerCursor:{get:function(){var u,b;return null===(b=null===(u=y._currentLink)||void 0===u?void 0:u.state)||void 0===b?void 0:b.decorations.pointerCursor},set:function(u){var b,x;(null===(b=y._currentLink)||void 0===b?void 0:b.state)&&y._currentLink.state.decorations.pointerCursor!==u&&(y._currentLink.state.decorations.pointerCursor=u,y._currentLink.state.isHovered&&(null===(x=y._element)||void 0===x||x.classList.toggle("xterm-cursor-pointer",u)))}},underline:{get:function(){var u,b;return null===(b=null===(u=y._currentLink)||void 0===u?void 0:u.state)||void 0===b?void 0:b.decorations.underline},set:function(b){var x,k,B;(null===(x=y._currentLink)||void 0===x?void 0:x.state)&&(null===(B=null===(k=y._currentLink)||void 0===k?void 0:k.state)||void 0===B?void 0:B.decorations.underline)!==b&&(y._currentLink.state.decorations.underline=b,y._currentLink.state.isHovered&&y._fireUnderlineEvent(u.link,b))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange((function(u){var b=0===u.start?0:u.start+1+y._bufferService.buffer.ydisp;y._clearCurrentLink(b,u.end+1+y._bufferService.buffer.ydisp)}))))}},t.prototype._linkHover=function(u,y,b){var x;(null===(x=this._currentLink)||void 0===x?void 0:x.state)&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(y,!0),this._currentLink.state.decorations.pointerCursor&&u.classList.add("xterm-cursor-pointer")),y.hover&&y.hover(b,y.text)},t.prototype._fireUnderlineEvent=function(u,y){var b=u.range,x=this._bufferService.buffer.ydisp,k=this._createLinkUnderlineEvent(b.start.x-1,b.start.y-x-1,b.end.x,b.end.y-x-1,void 0);(y?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(k)},t.prototype._linkLeave=function(u,y,b){var x;(null===(x=this._currentLink)||void 0===x?void 0:x.state)&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(y,!1),this._currentLink.state.decorations.pointerCursor&&u.classList.remove("xterm-cursor-pointer")),y.leave&&y.leave(b,y.text)},t.prototype._linkAtPosition=function(u,y){var b=u.range.start.y===u.range.end.y,x=u.range.start.y<y.y,k=u.range.end.y>y.y;return(b&&u.range.start.x<=y.x&&u.range.end.x>=y.x||x&&u.range.end.x>=y.x||k&&u.range.start.x<=y.x||x&&k)&&u.range.start.y<=y.y&&u.range.end.y>=y.y},t.prototype._positionFromMouseEvent=function(u,y,b){var x=b.getCoords(u,y,this._bufferService.cols,this._bufferService.rows);if(x)return{x:x[0],y:x[1]+this._bufferService.buffer.ydisp}},t.prototype._createLinkUnderlineEvent=function(u,y,b,x,k){return{x1:u,y1:y,x2:b,y2:x,cols:this._bufferService.cols,fg:k}},B([P(0,j.IBufferService)],t)}(q.Disposable);y.Linkifier2=U},9042:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.tooMuchOutput=y.promptLabel=void 0,y.promptLabel="Terminal input",y.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},6954:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.MouseZoneManager=void 0;var I=b(844),H=b(3656),j=b(4725),N=b(2585),q=function(u){function t(y,b,x,k,B,P){var I=u.call(this)||this;return I._element=y,I._screenElement=b,I._bufferService=x,I._mouseService=k,I._selectionService=B,I._optionsService=P,I._zones=[],I._areZonesActive=!1,I._lastHoverCoords=[void 0,void 0],I._initialSelectionLength=0,I.register((0,H.addDisposableDomListener)(I._element,"mousedown",(function(u){return I._onMouseDown(u)}))),I._mouseMoveListener=function(u){return I._onMouseMove(u)},I._mouseLeaveListener=function(u){return I._onMouseLeave(u)},I._clickListener=function(u){return I._onClick(u)},I}return k(t,u),t.prototype.dispose=function(){u.prototype.dispose.call(this),this._deactivate()},t.prototype.add=function(u){this._zones.push(u),1===this._zones.length&&this._activate()},t.prototype.clearAll=function(u,y){if(0!==this._zones.length){u&&y||(u=0,y=this._bufferService.rows-1);for(var b=0;b<this._zones.length;b++){var x=this._zones[b];(x.y1>u&&x.y1<=y+1||x.y2>u&&x.y2<=y+1||x.y1<u&&x.y2>y+1)&&(this._currentZone&&this._currentZone===x&&(this._currentZone.leaveCallback(),this._currentZone=void 0),this._zones.splice(b--,1))}0===this._zones.length&&this._deactivate()}},t.prototype._activate=function(){this._areZonesActive||(this._areZonesActive=!0,this._element.addEventListener("mousemove",this._mouseMoveListener),this._element.addEventListener("mouseleave",this._mouseLeaveListener),this._element.addEventListener("click",this._clickListener))},t.prototype._deactivate=function(){this._areZonesActive&&(this._areZonesActive=!1,this._element.removeEventListener("mousemove",this._mouseMoveListener),this._element.removeEventListener("mouseleave",this._mouseLeaveListener),this._element.removeEventListener("click",this._clickListener))},t.prototype._onMouseMove=function(u){this._lastHoverCoords[0]===u.pageX&&this._lastHoverCoords[1]===u.pageY||(this._onHover(u),this._lastHoverCoords=[u.pageX,u.pageY])},t.prototype._onHover=function(u){var y=this,b=this._findZoneEventAt(u);b!==this._currentZone&&(this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=void 0,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout)),b&&(this._currentZone=b,b.hoverCallback&&b.hoverCallback(u),this._tooltipTimeout=window.setTimeout((function(){return y._onTooltip(u)}),this._optionsService.rawOptions.linkTooltipHoverDuration)))},t.prototype._onTooltip=function(u){this._tooltipTimeout=void 0;var y=this._findZoneEventAt(u);null==y||y.tooltipCallback(u)},t.prototype._onMouseDown=function(u){if(this._initialSelectionLength=this._getSelectionLength(),this._areZonesActive){var y=this._findZoneEventAt(u);(null==y?void 0:y.willLinkActivate(u))&&(u.preventDefault(),u.stopImmediatePropagation())}},t.prototype._onMouseLeave=function(u){this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=void 0,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout))},t.prototype._onClick=function(u){var y=this._findZoneEventAt(u),b=this._getSelectionLength();y&&b===this._initialSelectionLength&&(y.clickCallback(u),u.preventDefault(),u.stopImmediatePropagation())},t.prototype._getSelectionLength=function(){var u=this._selectionService.selectionText;return u?u.length:0},t.prototype._findZoneEventAt=function(u){var y=this._mouseService.getCoords(u,this._screenElement,this._bufferService.cols,this._bufferService.rows);if(y)for(var b=y[0],x=y[1],k=0;k<this._zones.length;k++){var B=this._zones[k];if(B.y1===B.y2){if(x===B.y1&&b>=B.x1&&b<B.x2)return B}else if(x===B.y1&&b>=B.x1||x===B.y2&&b<B.x2||x>B.y1&&x<B.y2)return B}},B([P(2,N.IBufferService),P(3,j.IMouseService),P(4,j.ISelectionService),P(5,N.IOptionsService)],t)}(I.Disposable);y.MouseZoneManager=q},6193:function(u,y){var b=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.RenderDebouncer=void 0;var x=function(){function e(u){this._renderCallback=u,this._refreshCallbacks=[]}return e.prototype.dispose=function(){this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},e.prototype.addRefreshCallback=function(u){var y=this;return this._refreshCallbacks.push(u),this._animationFrame||(this._animationFrame=window.requestAnimationFrame((function(){return y._innerRefresh()}))),this._animationFrame},e.prototype.refresh=function(u,y,b){var x=this;this._rowCount=b,u=void 0!==u?u:0,y=void 0!==y?y:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,u):u,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,y):y,this._animationFrame||(this._animationFrame=window.requestAnimationFrame((function(){return x._innerRefresh()})))},e.prototype._innerRefresh=function(){if(this._animationFrame=void 0,void 0!==this._rowStart&&void 0!==this._rowEnd&&void 0!==this._rowCount){var u=Math.max(this._rowStart,0),y=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(u,y),this._runRefreshCallbacks()}else this._runRefreshCallbacks()},e.prototype._runRefreshCallbacks=function(){var u,y;try{for(var x=b(this._refreshCallbacks),k=x.next();!k.done;k=x.next())(0,k.value)(0)}catch(y){u={error:y}}finally{try{k&&!k.done&&(y=x.return)&&y.call(x)}finally{if(u)throw u.error}}this._refreshCallbacks=[]},e}();y.RenderDebouncer=x},5596:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)});Object.defineProperty(y,"__esModule",{value:!0}),y.ScreenDprMonitor=void 0;var B=function(u){function t(){var y=null!==u&&u.apply(this,arguments)||this;return y._currentDevicePixelRatio=window.devicePixelRatio,y}return k(t,u),t.prototype.setListener=function(u){var y=this;this._listener&&this.clearListener(),this._listener=u,this._outerListener=function(){y._listener&&(y._listener(window.devicePixelRatio,y._currentDevicePixelRatio),y._updateDpr())},this._updateDpr()},t.prototype.dispose=function(){u.prototype.dispose.call(this),this.clearListener()},t.prototype._updateDpr=function(){var u;this._outerListener&&(null===(u=this._resolutionMediaMatchList)||void 0===u||u.removeListener(this._outerListener),this._currentDevicePixelRatio=window.devicePixelRatio,this._resolutionMediaMatchList=window.matchMedia("screen and (resolution: "+window.devicePixelRatio+"dppx)"),this._resolutionMediaMatchList.addListener(this._outerListener))},t.prototype.clearListener=function(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)},t}(b(844).Disposable);y.ScreenDprMonitor=B},3236:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")},P=this&&this.__read||function(u,y){var b="function"==typeof Symbol&&u[Symbol.iterator];if(!b)return u;var x,k,B=b.call(u),P=[];try{for(;(void 0===y||y-- >0)&&!(x=B.next()).done;)P.push(x.value)}catch(u){k={error:u}}finally{try{x&&!x.done&&(b=B.return)&&b.call(B)}finally{if(k)throw k.error}}return P},I=this&&this.__spreadArray||function(u,y,b){if(b||2===arguments.length)for(var x,k=0,B=y.length;k<B;k++)!x&&k in y||(x||(x=Array.prototype.slice.call(y,0,k)),x[k]=y[k]);return u.concat(x||Array.prototype.slice.call(y))};Object.defineProperty(y,"__esModule",{value:!0}),y.Terminal=void 0;var H=b(2950),j=b(1680),N=b(3614),q=b(2584),W=b(5435),U=b(3525),z=b(3551),K=b(9312),V=b(6114),G=b(3656),X=b(9042),Y=b(357),J=b(6954),$=b(4567),Q=b(1296),ee=b(7399),te=b(8460),re=b(8437),ie=b(5680),ne=b(3230),oe=b(4725),se=b(428),ae=b(8934),ce=b(6465),le=b(5114),he=b(8969),ue=b(8055),fe=b(4269),_e=b(5941),de=b(3107),pe=b(5744),ve=b(9074),ye=b(2585),ge="undefined"!=typeof window?window.document:null,me=function(u){function t(y){void 0===y&&(y={});var b=u.call(this,y)||this;return b.browser=V,b._keyDownHandled=!1,b._keyDownSeen=!1,b._keyPressHandled=!1,b._unprocessedDeadKey=!1,b._onCursorMove=new te.EventEmitter,b._onKey=new te.EventEmitter,b._onRender=new te.EventEmitter,b._onSelectionChange=new te.EventEmitter,b._onTitleChange=new te.EventEmitter,b._onBell=new te.EventEmitter,b._onFocus=new te.EventEmitter,b._onBlur=new te.EventEmitter,b._onA11yCharEmitter=new te.EventEmitter,b._onA11yTabEmitter=new te.EventEmitter,b._setup(),b.linkifier=b._instantiationService.createInstance(z.Linkifier),b.linkifier2=b.register(b._instantiationService.createInstance(ce.Linkifier2)),b._decorationService=b._instantiationService.createInstance(ve.DecorationService),b._instantiationService.setService(ye.IDecorationService,b._decorationService),b.register(b._inputHandler.onRequestBell((function(){return b.bell()}))),b.register(b._inputHandler.onRequestRefreshRows((function(u,y){return b.refresh(u,y)}))),b.register(b._inputHandler.onRequestSendFocus((function(){return b._reportFocus()}))),b.register(b._inputHandler.onRequestReset((function(){return b.reset()}))),b.register(b._inputHandler.onRequestWindowsOptionsReport((function(u){return b._reportWindowsOptions(u)}))),b.register(b._inputHandler.onColor((function(u){return b._handleColorEvent(u)}))),b.register((0,te.forwardEvent)(b._inputHandler.onCursorMove,b._onCursorMove)),b.register((0,te.forwardEvent)(b._inputHandler.onTitleChange,b._onTitleChange)),b.register((0,te.forwardEvent)(b._inputHandler.onA11yChar,b._onA11yCharEmitter)),b.register((0,te.forwardEvent)(b._inputHandler.onA11yTab,b._onA11yTabEmitter)),b.register(b._bufferService.onResize((function(u){return b._afterResize(u.cols,u.rows)}))),b}return k(t,u),Object.defineProperty(t.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onKey",{get:function(){return this._onKey.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onBell",{get:function(){return this._onBell.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocus",{get:function(){return this._onFocus.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onBlur",{get:function(){return this._onBlur.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onA11yChar",{get:function(){return this._onA11yCharEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onA11yTab",{get:function(){return this._onA11yTabEmitter.event},enumerable:!1,configurable:!0}),t.prototype._handleColorEvent=function(u){var y,b,x,k;if(this._colorManager){try{for(var H=B(u),j=H.next();!j.done;j=H.next()){var N=j.value,W=void 0,U="";switch(N.index){case 256:W="foreground",U="10";break;case 257:W="background",U="11";break;case 258:W="cursor",U="12";break;default:W="ansi",U="4;"+N.index}if(W)switch(N.type){case 0:var z=ue.color.toColorRGB("ansi"===W?this._colorManager.colors.ansi[N.index]:this._colorManager.colors[W]);this.coreService.triggerDataEvent(q.C0.ESC+"]"+U+";"+(0,_e.toRgbString)(z)+q.C1_ESCAPED.ST);break;case 1:"ansi"===W?this._colorManager.colors.ansi[N.index]=ue.rgba.toColor.apply(ue.rgba,I([],P(N.color),!1)):this._colorManager.colors[W]=ue.rgba.toColor.apply(ue.rgba,I([],P(N.color),!1));break;case 2:this._colorManager.restoreColor(N.index)}}}catch(u){y={error:u}}finally{try{j&&!j.done&&(b=H.return)&&b.call(H)}finally{if(y)throw y.error}}null===(x=this._renderService)||void 0===x||x.setColors(this._colorManager.colors),null===(k=this.viewport)||void 0===k||k.onThemeChange(this._colorManager.colors)}},t.prototype.dispose=function(){var y,b,x;this._isDisposed||(u.prototype.dispose.call(this),null===(y=this._renderService)||void 0===y||y.dispose(),this._customKeyEventHandler=void 0,this.write=function(){},null===(x=null===(b=this.element)||void 0===b?void 0:b.parentNode)||void 0===x||x.removeChild(this.element))},t.prototype._setup=function(){u.prototype._setup.call(this),this._customKeyEventHandler=void 0},Object.defineProperty(t.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!1,configurable:!0}),t.prototype.focus=function(){this.textarea&&this.textarea.focus({preventScroll:!0})},t.prototype._updateOptions=function(y){var b,x,k,B;switch(u.prototype._updateOptions.call(this,y),y){case"fontFamily":case"fontSize":null===(b=this._renderService)||void 0===b||b.clear(),null===(x=this._charSizeService)||void 0===x||x.measure();break;case"cursorBlink":case"cursorStyle":this.refresh(this.buffer.y,this.buffer.y);break;case"customGlyphs":case"drawBoldTextInBrightColors":case"letterSpacing":case"lineHeight":case"fontWeight":case"fontWeightBold":case"minimumContrastRatio":this._renderService&&(this._renderService.clear(),this._renderService.onResize(this.cols,this.rows),this.refresh(0,this.rows-1));break;case"rendererType":this._renderService&&(this._renderService.setRenderer(this._createRenderer()),this._renderService.onResize(this.cols,this.rows));break;case"scrollback":null===(k=this.viewport)||void 0===k||k.syncScrollArea();break;case"screenReaderMode":this.optionsService.rawOptions.screenReaderMode?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=new $.AccessibilityManager(this,this._renderService)):(null===(B=this._accessibilityManager)||void 0===B||B.dispose(),this._accessibilityManager=void 0);break;case"tabStopWidth":this.buffers.setupTabStops();break;case"theme":this._setTheme(this.optionsService.rawOptions.theme)}},t.prototype._onTextAreaFocus=function(u){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(q.C0.ESC+"[I"),this.updateCursorStyle(u),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()},t.prototype.blur=function(){var u;return null===(u=this.textarea)||void 0===u?void 0:u.blur()},t.prototype._onTextAreaBlur=function(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(q.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()},t.prototype._syncTextArea=function(){if(this.textarea&&this.buffer.isCursorInViewport&&!this._compositionHelper.isComposing&&this._renderService){var u=this.buffer.ybase+this.buffer.y,y=this.buffer.lines.get(u);if(y){var b=Math.min(this.buffer.x,this.cols-1),x=this._renderService.dimensions.actualCellHeight,k=y.getWidth(b),B=this._renderService.dimensions.actualCellWidth*k,P=this.buffer.y*this._renderService.dimensions.actualCellHeight,I=b*this._renderService.dimensions.actualCellWidth;this.textarea.style.left=I+"px",this.textarea.style.top=P+"px",this.textarea.style.width=B+"px",this.textarea.style.height=x+"px",this.textarea.style.lineHeight=x+"px",this.textarea.style.zIndex="-5"}}},t.prototype._initGlobal=function(){var u=this;this._bindKeys(),this.register((0,G.addDisposableDomListener)(this.element,"copy",(function(y){u.hasSelection()&&(0,N.copyHandler)(y,u._selectionService)})));var t=function(y){return(0,N.handlePasteEvent)(y,u.textarea,u.coreService)};this.register((0,G.addDisposableDomListener)(this.textarea,"paste",t)),this.register((0,G.addDisposableDomListener)(this.element,"paste",t)),V.isFirefox?this.register((0,G.addDisposableDomListener)(this.element,"mousedown",(function(y){2===y.button&&(0,N.rightClickHandler)(y,u.textarea,u.screenElement,u._selectionService,u.options.rightClickSelectsWord)}))):this.register((0,G.addDisposableDomListener)(this.element,"contextmenu",(function(y){(0,N.rightClickHandler)(y,u.textarea,u.screenElement,u._selectionService,u.options.rightClickSelectsWord)}))),V.isLinux&&this.register((0,G.addDisposableDomListener)(this.element,"auxclick",(function(y){1===y.button&&(0,N.moveTextAreaUnderMouseCursor)(y,u.textarea,u.screenElement)})))},t.prototype._bindKeys=function(){var u=this;this.register((0,G.addDisposableDomListener)(this.textarea,"keyup",(function(y){return u._keyUp(y)}),!0)),this.register((0,G.addDisposableDomListener)(this.textarea,"keydown",(function(y){return u._keyDown(y)}),!0)),this.register((0,G.addDisposableDomListener)(this.textarea,"keypress",(function(y){return u._keyPress(y)}),!0)),this.register((0,G.addDisposableDomListener)(this.textarea,"compositionstart",(function(){return u._compositionHelper.compositionstart()}))),this.register((0,G.addDisposableDomListener)(this.textarea,"compositionupdate",(function(y){return u._compositionHelper.compositionupdate(y)}))),this.register((0,G.addDisposableDomListener)(this.textarea,"compositionend",(function(){return u._compositionHelper.compositionend()}))),this.register((0,G.addDisposableDomListener)(this.textarea,"input",(function(y){return u._inputEvent(y)}),!0)),this.register(this.onRender((function(){return u._compositionHelper.updateCompositionElements()}))),this.register(this.onRender((function(y){return u._queueLinkification(y.start,y.end)})))},t.prototype.open=function(u){var y=this;if(!u)throw Error("Terminal requires a parent element.");u.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=u.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),u.appendChild(this.element);var b=ge.createDocumentFragment();this._viewportElement=ge.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),b.appendChild(this._viewportElement),this._viewportScrollArea=ge.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=ge.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=ge.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),b.appendChild(this.screenElement),this.textarea=ge.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",X.promptLabel),this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this.register((0,G.addDisposableDomListener)(this.textarea,"focus",(function(u){return y._onTextAreaFocus(u)}))),this.register((0,G.addDisposableDomListener)(this.textarea,"blur",(function(){return y._onTextAreaBlur()}))),this._helperContainer.appendChild(this.textarea);var x=this._instantiationService.createInstance(le.CoreBrowserService,this.textarea);this._instantiationService.setService(oe.ICoreBrowserService,x),this._charSizeService=this._instantiationService.createInstance(se.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(oe.ICharSizeService,this._charSizeService),this._theme=this.options.theme||this._theme,this._colorManager=new ie.ColorManager(ge,this.options.allowTransparency),this.register(this.optionsService.onOptionChange((function(u){return y._colorManager.onOptionsChange(u)}))),this._colorManager.setTheme(this._theme),this._characterJoinerService=this._instantiationService.createInstance(fe.CharacterJoinerService),this._instantiationService.setService(oe.ICharacterJoinerService,this._characterJoinerService);var k=this._createRenderer();this._renderService=this.register(this._instantiationService.createInstance(ne.RenderService,k,this.rows,this.screenElement)),this._instantiationService.setService(oe.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange((function(u){return y._onRender.fire(u)}))),this.onResize((function(u){return y._renderService.resize(u.cols,u.rows)})),this._compositionView=ge.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(H.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(b),this._soundService=this._instantiationService.createInstance(Y.SoundService),this._instantiationService.setService(oe.ISoundService,this._soundService),this._mouseService=this._instantiationService.createInstance(ae.MouseService),this._instantiationService.setService(oe.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(j.Viewport,(function(u){return y.scrollLines(u,!0,1)}),this._viewportElement,this._viewportScrollArea,this.element),this.viewport.onThemeChange(this._colorManager.colors),this.register(this._inputHandler.onRequestSyncScrollBar((function(){return y.viewport.syncScrollArea()}))),this.register(this.viewport),this.register(this.onCursorMove((function(){y._renderService.onCursorMove(),y._syncTextArea()}))),this.register(this.onResize((function(){return y._renderService.onResize(y.cols,y.rows)}))),this.register(this.onBlur((function(){return y._renderService.onBlur()}))),this.register(this.onFocus((function(){return y._renderService.onFocus()}))),this.register(this._renderService.onDimensionsChange((function(){return y.viewport.syncScrollArea()}))),this._selectionService=this.register(this._instantiationService.createInstance(K.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(oe.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines((function(u){return y.scrollLines(u.amount,u.suppressScrollEvent)}))),this.register(this._selectionService.onSelectionChange((function(){return y._onSelectionChange.fire()}))),this.register(this._selectionService.onRequestRedraw((function(u){return y._renderService.onSelectionChanged(u.start,u.end,u.columnSelectMode)}))),this.register(this._selectionService.onLinuxMouseSelection((function(u){y.textarea.value=u,y.textarea.focus(),y.textarea.select()}))),this.register(this._onScroll.event((function(u){y.viewport.syncScrollArea(),y._selectionService.refresh()}))),this.register((0,G.addDisposableDomListener)(this._viewportElement,"scroll",(function(){return y._selectionService.refresh()}))),this._mouseZoneManager=this._instantiationService.createInstance(J.MouseZoneManager,this.element,this.screenElement),this.register(this._mouseZoneManager),this.register(this.onScroll((function(){return y._mouseZoneManager.clearAll()}))),this.linkifier.attachToDom(this.element,this._mouseZoneManager),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(de.BufferDecorationRenderer,this.screenElement)),this.register((0,G.addDisposableDomListener)(this.element,"mousedown",(function(u){return y._selectionService.onMouseDown(u)}))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new $.AccessibilityManager(this,this._renderService)),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this._instantiationService.createInstance(pe.OverviewRulerRenderer,this._viewportElement,this.screenElement)),this.optionsService.onOptionChange((function(){!y._overviewRulerRenderer&&y.options.overviewRulerWidth&&y._viewportElement&&y.screenElement&&(y._overviewRulerRenderer=y._instantiationService.createInstance(pe.OverviewRulerRenderer,y._viewportElement,y.screenElement))})),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()},t.prototype._createRenderer=function(){switch(this.options.rendererType){case"canvas":return this._instantiationService.createInstance(U.Renderer,this._colorManager.colors,this.screenElement,this.linkifier,this.linkifier2);case"dom":return this._instantiationService.createInstance(Q.DomRenderer,this._colorManager.colors,this.element,this.screenElement,this._viewportElement,this.linkifier,this.linkifier2);default:throw Error('Unrecognized rendererType "'+this.options.rendererType+'"')}},t.prototype._setTheme=function(u){var y,b,x;this._theme=u,null===(y=this._colorManager)||void 0===y||y.setTheme(u),null===(b=this._renderService)||void 0===b||b.setColors(this._colorManager.colors),null===(x=this.viewport)||void 0===x||x.onThemeChange(this._colorManager.colors)},t.prototype.bindMouse=function(){var u=this,y=this,b=this.element;function i(u){var b,x,k=y._mouseService.getRawByteCoords(u,y.screenElement,y.cols,y.rows);if(!k)return!1;switch(u.overrideType||u.type){case"mousemove":x=32,void 0===u.buttons?(b=3,void 0!==u.button&&(b=u.button<3?u.button:3)):b=1&u.buttons?0:4&u.buttons?1:2&u.buttons?2:3;break;case"mouseup":x=0,b=u.button<3?u.button:3;break;case"mousedown":x=1,b=u.button<3?u.button:3;break;case"wheel":if(0===y.viewport.getLinesScrolled(u))return!1;x=u.deltaY<0?0:1,b=4;break;default:return!1}return!(void 0===x||void 0===b||b>4)&&y.coreMouseService.triggerMouseEvent({col:k.x-33,row:k.y-33,button:b,action:x,ctrl:u.ctrlKey,alt:u.altKey,shift:u.shiftKey})}var x={mouseup:null,wheel:null,mousedrag:null,mousemove:null},o=function(y){return i(y),y.buttons||(u._document.removeEventListener("mouseup",x.mouseup),x.mousedrag&&u._document.removeEventListener("mousemove",x.mousedrag)),u.cancel(y)},s=function(y){return i(y),u.cancel(y,!0)},a=function(u){u.buttons&&i(u)},c=function(u){u.buttons||i(u)};this.register(this.coreMouseService.onProtocolChange((function(y){y?("debug"===u.optionsService.rawOptions.logLevel&&u._logService.debug("Binding to mouse events:",u.coreMouseService.explainEvents(y)),u.element.classList.add("enable-mouse-events"),u._selectionService.disable()):(u._logService.debug("Unbinding from mouse events."),u.element.classList.remove("enable-mouse-events"),u._selectionService.enable()),8&y?x.mousemove||(b.addEventListener("mousemove",c),x.mousemove=c):(b.removeEventListener("mousemove",x.mousemove),x.mousemove=null),16&y?x.wheel||(b.addEventListener("wheel",s,{passive:!1}),x.wheel=s):(b.removeEventListener("wheel",x.wheel),x.wheel=null),2&y?x.mouseup||(x.mouseup=o):(u._document.removeEventListener("mouseup",x.mouseup),x.mouseup=null),4&y?x.mousedrag||(x.mousedrag=a):(u._document.removeEventListener("mousemove",x.mousedrag),x.mousedrag=null)}))),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,G.addDisposableDomListener)(b,"mousedown",(function(y){if(y.preventDefault(),u.focus(),u.coreMouseService.areMouseEventsActive&&!u._selectionService.shouldForceSelection(y))return i(y),x.mouseup&&u._document.addEventListener("mouseup",x.mouseup),x.mousedrag&&u._document.addEventListener("mousemove",x.mousedrag),u.cancel(y)}))),this.register((0,G.addDisposableDomListener)(b,"wheel",(function(y){if(!x.wheel){if(!u.buffer.hasScrollback){var b=u.viewport.getLinesScrolled(y);if(0===b)return;for(var k=q.C0.ESC+(u.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(y.deltaY<0?"A":"B"),B="",P=0;P<Math.abs(b);P++)B+=k;return u.coreService.triggerDataEvent(B,!0),u.cancel(y,!0)}return u.viewport.onWheel(y)?u.cancel(y):void 0}}),{passive:!1})),this.register((0,G.addDisposableDomListener)(b,"touchstart",(function(y){if(!u.coreMouseService.areMouseEventsActive)return u.viewport.onTouchStart(y),u.cancel(y)}),{passive:!0})),this.register((0,G.addDisposableDomListener)(b,"touchmove",(function(y){if(!u.coreMouseService.areMouseEventsActive)return u.viewport.onTouchMove(y)?void 0:u.cancel(y)}),{passive:!1}))},t.prototype.refresh=function(u,y){var b;null===(b=this._renderService)||void 0===b||b.refreshRows(u,y)},t.prototype._queueLinkification=function(u,y){var b;null===(b=this.linkifier)||void 0===b||b.linkifyRows(u,y)},t.prototype.updateCursorStyle=function(u){var y;(null===(y=this._selectionService)||void 0===y?void 0:y.shouldColumnSelect(u))?this.element.classList.add("column-select"):this.element.classList.remove("column-select")},t.prototype._showCursor=function(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))},t.prototype.scrollLines=function(y,b,x){void 0===x&&(x=0),u.prototype.scrollLines.call(this,y,b,x),this.refresh(0,this.rows-1)},t.prototype.paste=function(u){(0,N.paste)(u,this.textarea,this.coreService)},t.prototype.attachCustomKeyEventHandler=function(u){this._customKeyEventHandler=u},t.prototype.registerLinkMatcher=function(u,y,b){var x=this.linkifier.registerLinkMatcher(u,y,b);return this.refresh(0,this.rows-1),x},t.prototype.deregisterLinkMatcher=function(u){this.linkifier.deregisterLinkMatcher(u)&&this.refresh(0,this.rows-1)},t.prototype.registerLinkProvider=function(u){return this.linkifier2.registerLinkProvider(u)},t.prototype.registerCharacterJoiner=function(u){if(!this._characterJoinerService)throw Error("Terminal must be opened first");var y=this._characterJoinerService.register(u);return this.refresh(0,this.rows-1),y},t.prototype.deregisterCharacterJoiner=function(u){if(!this._characterJoinerService)throw Error("Terminal must be opened first");this._characterJoinerService.deregister(u)&&this.refresh(0,this.rows-1)},Object.defineProperty(t.prototype,"markers",{get:function(){return this.buffer.markers},enumerable:!1,configurable:!0}),t.prototype.addMarker=function(u){if(this.buffer===this.buffers.normal)return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+u)},t.prototype.registerDecoration=function(u){return this._decorationService.registerDecoration(u)},t.prototype.hasSelection=function(){return!!this._selectionService&&this._selectionService.hasSelection},t.prototype.select=function(u,y,b){this._selectionService.setSelection(u,y,b)},t.prototype.getSelection=function(){return this._selectionService?this._selectionService.selectionText:""},t.prototype.getSelectionPosition=function(){if(this._selectionService&&this._selectionService.hasSelection)return{startColumn:this._selectionService.selectionStart[0],startRow:this._selectionService.selectionStart[1],endColumn:this._selectionService.selectionEnd[0],endRow:this._selectionService.selectionEnd[1]}},t.prototype.clearSelection=function(){var u;null===(u=this._selectionService)||void 0===u||u.clearSelection()},t.prototype.selectAll=function(){var u;null===(u=this._selectionService)||void 0===u||u.selectAll()},t.prototype.selectLines=function(u,y){var b;null===(b=this._selectionService)||void 0===b||b.selectLines(u,y)},t.prototype._keyDown=function(u){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&!1===this._customKeyEventHandler(u))return!1;var y=this.browser.isMac&&this.options.macOptionIsMeta&&u.altKey;if(!y&&!this._compositionHelper.keydown(u))return this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;y||"Dead"!==u.key&&"AltGraph"!==u.key||(this._unprocessedDeadKey=!0);var b=(0,ee.evaluateKeyboardEvent)(u,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(u),3===b.type||2===b.type){var x=this.rows-1;return this.scrollLines(2===b.type?-x:x),this.cancel(u,!0)}return 1===b.type&&this.selectAll(),!!this._isThirdLevelShift(this.browser,u)||(b.cancel&&this.cancel(u,!0),!b.key||!!(u.key&&!u.ctrlKey&&!u.altKey&&!u.metaKey&&1===u.key.length&&u.key.charCodeAt(0)>=65&&u.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(b.key!==q.C0.ETX&&b.key!==q.C0.CR||(this.textarea.value=""),this._onKey.fire({key:b.key,domEvent:u}),this._showCursor(),this.coreService.triggerDataEvent(b.key,!0),this.optionsService.rawOptions.screenReaderMode?void(this._keyDownHandled=!0):this.cancel(u,!0))))},t.prototype._isThirdLevelShift=function(u,y){var b=u.isMac&&!this.options.macOptionIsMeta&&y.altKey&&!y.ctrlKey&&!y.metaKey||u.isWindows&&y.altKey&&y.ctrlKey&&!y.metaKey||u.isWindows&&y.getModifierState("AltGraph");return"keypress"===y.type?b:b&&(!y.keyCode||y.keyCode>47)},t.prototype._keyUp=function(u){this._keyDownSeen=!1,this._customKeyEventHandler&&!1===this._customKeyEventHandler(u)||(function(u){return 16===u.keyCode||17===u.keyCode||18===u.keyCode}(u)||this.focus(),this.updateCursorStyle(u),this._keyPressHandled=!1)},t.prototype._keyPress=function(u){var y;if(this._keyPressHandled=!1,this._keyDownHandled)return!1;if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(u))return!1;if(this.cancel(u),u.charCode)y=u.charCode;else if(null===u.which||void 0===u.which)y=u.keyCode;else{if(0===u.which||0===u.charCode)return!1;y=u.which}return!(!y||(u.altKey||u.ctrlKey||u.metaKey)&&!this._isThirdLevelShift(this.browser,u)||(y=String.fromCharCode(y),this._onKey.fire({key:y,domEvent:u}),this._showCursor(),this.coreService.triggerDataEvent(y,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))},t.prototype._inputEvent=function(u){if(u.data&&"insertText"===u.inputType&&(!u.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;var y=u.data;return this.coreService.triggerDataEvent(y,!0),this.cancel(u),!0}return!1},t.prototype.bell=function(){var u;this._soundBell()&&(null===(u=this._soundService)||void 0===u||u.playBellSound()),this._onBell.fire()},t.prototype.resize=function(y,b){y!==this.cols||b!==this.rows?u.prototype.resize.call(this,y,b):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()},t.prototype._afterResize=function(u,y){var b,x;null===(b=this._charSizeService)||void 0===b||b.measure(),null===(x=this.viewport)||void 0===x||x.syncScrollArea(!0)},t.prototype.clear=function(){if(0!==this.buffer.ybase||0!==this.buffer.y){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(var u=1;u<this.rows;u++)this.buffer.lines.push(this.buffer.getBlankLine(re.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}},t.prototype.reset=function(){var y,b;this.options.rows=this.rows,this.options.cols=this.cols;var x=this._customKeyEventHandler;this._setup(),u.prototype.reset.call(this),null===(y=this._selectionService)||void 0===y||y.reset(),this._decorationService.reset(),this._customKeyEventHandler=x,this.refresh(0,this.rows-1),null===(b=this.viewport)||void 0===b||b.syncScrollArea()},t.prototype.clearTextureAtlas=function(){var u;null===(u=this._renderService)||void 0===u||u.clearTextureAtlas()},t.prototype._reportFocus=function(){var u;(null===(u=this.element)||void 0===u?void 0:u.classList.contains("focus"))?this.coreService.triggerDataEvent(q.C0.ESC+"[I"):this.coreService.triggerDataEvent(q.C0.ESC+"[O")},t.prototype._reportWindowsOptions=function(u){if(this._renderService)switch(u){case W.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:var y=this._renderService.dimensions.scaledCanvasWidth.toFixed(0),b=this._renderService.dimensions.scaledCanvasHeight.toFixed(0);this.coreService.triggerDataEvent(q.C0.ESC+"[4;"+b+";"+y+"t");break;case W.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:var x=this._renderService.dimensions.scaledCellWidth.toFixed(0),k=this._renderService.dimensions.scaledCellHeight.toFixed(0);this.coreService.triggerDataEvent(q.C0.ESC+"[6;"+k+";"+x+"t")}},t.prototype.cancel=function(u,y){if(this.options.cancelEvents||y)return u.preventDefault(),u.stopPropagation(),!1},t.prototype._visualBell=function(){return!1},t.prototype._soundBell=function(){return"sound"===this.options.bellStyle},t}(he.CoreTerminal);y.Terminal=me},9924:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.TimeBasedDebouncer=void 0;var b=function(){function e(u,y){void 0===y&&(y=1e3),this._renderCallback=u,this._debounceThresholdMS=y,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}return e.prototype.dispose=function(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)},e.prototype.refresh=function(u,y,b){var x=this;this._rowCount=b,u=void 0!==u?u:0,y=void 0!==y?y:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,u):u,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,y):y;var k=Date.now();if(k-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=k,this._innerRefresh();else if(!this._additionalRefreshRequested){var B=k-this._lastRefreshMs,P=this._debounceThresholdMS-B;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout((function(){x._lastRefreshMs=Date.now(),x._innerRefresh(),x._additionalRefreshRequested=!1,x._refreshTimeoutID=void 0}),P)}},e.prototype._innerRefresh=function(){if(void 0!==this._rowStart&&void 0!==this._rowEnd&&void 0!==this._rowCount){var u=Math.max(this._rowStart,0),y=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(u,y)}},e}();y.TimeBasedDebouncer=b},1680:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.Viewport=void 0;var I=b(844),H=b(3656),j=b(4725),N=b(2585),q=function(u){function t(y,b,x,k,B,P,I,j){var N=u.call(this)||this;return N._scrollLines=y,N._viewportElement=b,N._scrollArea=x,N._element=k,N._bufferService=B,N._optionsService=P,N._charSizeService=I,N._renderService=j,N.scrollBarWidth=0,N._currentRowHeight=0,N._currentScaledCellHeight=0,N._lastRecordedBufferLength=0,N._lastRecordedViewportHeight=0,N._lastRecordedBufferHeight=0,N._lastTouchY=0,N._lastScrollTop=0,N._wheelPartialScroll=0,N._refreshAnimationFrame=null,N._ignoreNextScrollEvent=!1,N.scrollBarWidth=N._viewportElement.offsetWidth-N._scrollArea.offsetWidth||15,N.register((0,H.addDisposableDomListener)(N._viewportElement,"scroll",N._onScroll.bind(N))),N._activeBuffer=N._bufferService.buffer,N.register(N._bufferService.buffers.onBufferActivate((function(u){return N._activeBuffer=u.activeBuffer}))),N._renderDimensions=N._renderService.dimensions,N.register(N._renderService.onDimensionsChange((function(u){return N._renderDimensions=u}))),setTimeout((function(){return N.syncScrollArea()}),0),N}return k(t,u),t.prototype.onThemeChange=function(u){this._viewportElement.style.backgroundColor=u.background.css},t.prototype._refresh=function(u){var y=this;if(u)return this._innerRefresh(),void(null!==this._refreshAnimationFrame&&cancelAnimationFrame(this._refreshAnimationFrame));null===this._refreshAnimationFrame&&(this._refreshAnimationFrame=requestAnimationFrame((function(){return y._innerRefresh()})))},t.prototype._innerRefresh=function(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.scaledCellHeight/window.devicePixelRatio,this._currentScaledCellHeight=this._renderService.dimensions.scaledCellHeight,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;var u=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.canvasHeight);this._lastRecordedBufferHeight!==u&&(this._lastRecordedBufferHeight=u,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}var y=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==y&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=y),this._refreshAnimationFrame=null},t.prototype.syncScrollArea=function(u){if(void 0===u&&(u=!1),this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(u);this._lastRecordedViewportHeight===this._renderService.dimensions.canvasHeight&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.scaledCellHeight===this._currentScaledCellHeight||this._refresh(u)},t.prototype._onScroll=function(u){if(this._lastScrollTop=this._viewportElement.scrollTop,this._viewportElement.offsetParent){if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);var y=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(y)}},t.prototype._bubbleScroll=function(u,y){var b=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(y<0&&0!==this._viewportElement.scrollTop||y>0&&b<this._lastRecordedBufferHeight)||(u.cancelable&&u.preventDefault(),!1)},t.prototype.onWheel=function(u){var y=this._getPixelsScrolled(u);return 0!==y&&(this._viewportElement.scrollTop+=y,this._bubbleScroll(u,y))},t.prototype._getPixelsScrolled=function(u){if(0===u.deltaY||u.shiftKey)return 0;var y=this._applyScrollModifier(u.deltaY,u);return u.deltaMode===WheelEvent.DOM_DELTA_LINE?y*=this._currentRowHeight:u.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(y*=this._currentRowHeight*this._bufferService.rows),y},t.prototype.getLinesScrolled=function(u){if(0===u.deltaY||u.shiftKey)return 0;var y=this._applyScrollModifier(u.deltaY,u);return u.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(y/=this._currentRowHeight+0,this._wheelPartialScroll+=y,y=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):u.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(y*=this._bufferService.rows),y},t.prototype._applyScrollModifier=function(u,y){var b=this._optionsService.rawOptions.fastScrollModifier;return"alt"===b&&y.altKey||"ctrl"===b&&y.ctrlKey||"shift"===b&&y.shiftKey?u*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:u*this._optionsService.rawOptions.scrollSensitivity},t.prototype.onTouchStart=function(u){this._lastTouchY=u.touches[0].pageY},t.prototype.onTouchMove=function(u){var y=this._lastTouchY-u.touches[0].pageY;return this._lastTouchY=u.touches[0].pageY,0!==y&&(this._viewportElement.scrollTop+=y,this._bubbleScroll(u,y))},B([P(4,N.IBufferService),P(5,N.IOptionsService),P(6,j.ICharSizeService),P(7,j.IRenderService)],t)}(I.Disposable);y.Viewport=q},3107:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}},I=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.BufferDecorationRenderer=void 0;var H=b(3656),j=b(4725),N=b(844),q=b(2585),W=function(u){function t(y,b,x,k){var B=u.call(this)||this;return B._screenElement=y,B._bufferService=b,B._decorationService=x,B._renderService=k,B._decorationElements=new Map,B._altBufferIsActive=!1,B._dimensionsChanged=!1,B._container=document.createElement("div"),B._container.classList.add("xterm-decoration-container"),B._screenElement.appendChild(B._container),B.register(B._renderService.onRenderedViewportChange((function(){return B._queueRefresh()}))),B.register(B._renderService.onDimensionsChange((function(){B._dimensionsChanged=!0,B._queueRefresh()}))),B.register((0,H.addDisposableDomListener)(window,"resize",(function(){return B._queueRefresh()}))),B.register(B._bufferService.buffers.onBufferActivate((function(){B._altBufferIsActive=B._bufferService.buffer===B._bufferService.buffers.alt}))),B.register(B._decorationService.onDecorationRegistered((function(){return B._queueRefresh()}))),B.register(B._decorationService.onDecorationRemoved((function(u){return B._removeDecoration(u)}))),B}return k(t,u),t.prototype.dispose=function(){this._container.remove(),this._decorationElements.clear(),u.prototype.dispose.call(this)},t.prototype._queueRefresh=function(){var u=this;void 0===this._animationFrame&&(this._animationFrame=this._renderService.addRefreshCallback((function(){u.refreshDecorations(),u._animationFrame=void 0})))},t.prototype.refreshDecorations=function(){var u,y;try{for(var b=I(this._decorationService.decorations),x=b.next();!x.done;x=b.next()){var k=x.value;this._renderDecoration(k)}}catch(y){u={error:y}}finally{try{x&&!x.done&&(y=b.return)&&y.call(b)}finally{if(u)throw u.error}}this._dimensionsChanged=!1},t.prototype._renderDecoration=function(u){this._refreshStyle(u),this._dimensionsChanged&&this._refreshXPosition(u)},t.prototype._createElement=function(u){var y,b=document.createElement("div");b.classList.add("xterm-decoration"),b.style.width=Math.round((u.options.width||1)*this._renderService.dimensions.actualCellWidth)+"px",b.style.height=(u.options.height||1)*this._renderService.dimensions.actualCellHeight+"px",b.style.top=(u.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.actualCellHeight+"px",b.style.lineHeight=this._renderService.dimensions.actualCellHeight+"px";var x=null!==(y=u.options.x)&&void 0!==y?y:0;return x&&x>this._bufferService.cols&&(b.style.display="none"),this._refreshXPosition(u,b),b},t.prototype._refreshStyle=function(u){var y=this,b=u.marker.line-this._bufferService.buffers.active.ydisp;if(b<0||b>=this._bufferService.rows)u.element&&(u.element.style.display="none",u.onRenderEmitter.fire(u.element));else{var x=this._decorationElements.get(u);x||(u.onDispose((function(){return y._removeDecoration(u)})),x=this._createElement(u),u.element=x,this._decorationElements.set(u,x),this._container.appendChild(x)),x.style.top=b*this._renderService.dimensions.actualCellHeight+"px",x.style.display=this._altBufferIsActive?"none":"block",u.onRenderEmitter.fire(x)}},t.prototype._refreshXPosition=function(u,y){var b;if(void 0===y&&(y=u.element),y){var x=null!==(b=u.options.x)&&void 0!==b?b:0;"right"===(u.options.anchor||"left")?y.style.right=x?x*this._renderService.dimensions.actualCellWidth+"px":"":y.style.left=x?x*this._renderService.dimensions.actualCellWidth+"px":""}},t.prototype._removeDecoration=function(u){var y;null===(y=this._decorationElements.get(u))||void 0===y||y.remove(),this._decorationElements.delete(u)},B([P(1,q.IBufferService),P(2,q.IDecorationService),P(3,j.IRenderService)],t)}(N.Disposable);y.BufferDecorationRenderer=W},5871:function(u,y){var b=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.ColorZoneStore=void 0;var x=function(){function e(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}return Object.defineProperty(e.prototype,"zones",{get:function(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this._zones.length=0,this._zonePoolIndex=0},e.prototype.addDecoration=function(u){var y,x;if(u.options.overviewRulerOptions){try{for(var k=b(this._zones),B=k.next();!B.done;B=k.next()){var P=B.value;if(P.color===u.options.overviewRulerOptions.color&&P.position===u.options.overviewRulerOptions.position){if(this._lineIntersectsZone(P,u.marker.line))return;if(this._lineAdjacentToZone(P,u.marker.line,u.options.overviewRulerOptions.position))return void this._addLineToZone(P,u.marker.line)}}}catch(u){y={error:u}}finally{try{B&&!B.done&&(x=k.return)&&x.call(k)}finally{if(y)throw y.error}}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=u.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=u.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=u.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=u.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:u.options.overviewRulerOptions.color,position:u.options.overviewRulerOptions.position,startBufferLine:u.marker.line,endBufferLine:u.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}},e.prototype.setPadding=function(u){this._linePadding=u},e.prototype._lineIntersectsZone=function(u,y){return y>=u.startBufferLine&&y<=u.endBufferLine},e.prototype._lineAdjacentToZone=function(u,y,b){return y>=u.startBufferLine-this._linePadding[b||"full"]&&y<=u.endBufferLine+this._linePadding[b||"full"]},e.prototype._addLineToZone=function(u,y){u.startBufferLine=Math.min(u.startBufferLine,y),u.endBufferLine=Math.max(u.endBufferLine,y)},e}();y.ColorZoneStore=x},5744:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}},I=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.OverviewRulerRenderer=void 0;var H=b(5871),j=b(3656),N=b(4725),q=b(844),W=b(2585),U={full:0,left:0,center:0,right:0},z={full:0,left:0,center:0,right:0},K={full:0,left:0,center:0,right:0},V=function(u){function t(y,b,x,k,B,P){var I,j=u.call(this)||this;j._viewportElement=y,j._screenElement=b,j._bufferService=x,j._decorationService=k,j._renderService=B,j._optionsService=P,j._colorZoneStore=new H.ColorZoneStore,j._shouldUpdateDimensions=!0,j._shouldUpdateAnchor=!0,j._lastKnownBufferLength=0,j._canvas=document.createElement("canvas"),j._canvas.classList.add("xterm-decoration-overview-ruler"),j._refreshCanvasDimensions(),null===(I=j._viewportElement.parentElement)||void 0===I||I.insertBefore(j._canvas,j._viewportElement);var N=j._canvas.getContext("2d");if(!N)throw Error("Ctx cannot be null");return j._ctx=N,j._registerDecorationListeners(),j._registerBufferChangeListeners(),j._registerDimensionChangeListeners(),j}return k(t,u),Object.defineProperty(t.prototype,"_width",{get:function(){return this._optionsService.options.overviewRulerWidth||0},enumerable:!1,configurable:!0}),t.prototype._registerDecorationListeners=function(){var u=this;this.register(this._decorationService.onDecorationRegistered((function(){return u._queueRefresh(void 0,!0)}))),this.register(this._decorationService.onDecorationRemoved((function(){return u._queueRefresh(void 0,!0)})))},t.prototype._registerBufferChangeListeners=function(){var u=this;this.register(this._renderService.onRenderedViewportChange((function(){return u._queueRefresh()}))),this.register(this._bufferService.buffers.onBufferActivate((function(){u._canvas.style.display=u._bufferService.buffer===u._bufferService.buffers.alt?"none":"block"}))),this.register(this._bufferService.onScroll((function(){u._lastKnownBufferLength!==u._bufferService.buffers.normal.lines.length&&(u._refreshDrawHeightConstants(),u._refreshColorZonePadding())})))},t.prototype._registerDimensionChangeListeners=function(){var u=this;this.register(this._renderService.onRender((function(){u._containerHeight&&u._containerHeight===u._screenElement.clientHeight||(u._queueRefresh(!0),u._containerHeight=u._screenElement.clientHeight)}))),this.register(this._optionsService.onOptionChange((function(y){"overviewRulerWidth"===y&&u._queueRefresh(!0)}))),this.register((0,j.addDisposableDomListener)(window,"resize",(function(){u._queueRefresh(!0)}))),this._queueRefresh(!0)},t.prototype.dispose=function(){var y;null===(y=this._canvas)||void 0===y||y.remove(),u.prototype.dispose.call(this)},t.prototype._refreshDrawConstants=function(){var u=Math.floor(this._canvas.width/3),y=Math.ceil(this._canvas.width/3);z.full=this._canvas.width,z.left=u,z.center=y,z.right=u,this._refreshDrawHeightConstants(),K.full=0,K.left=0,K.center=z.left,K.right=z.left+z.center},t.prototype._refreshDrawHeightConstants=function(){U.full=Math.round(2*window.devicePixelRatio);var u=this._canvas.height/this._bufferService.buffer.lines.length,y=Math.round(Math.max(Math.min(u,12),6)*window.devicePixelRatio);U.left=y,U.center=y,U.right=y},t.prototype._refreshColorZonePadding=function(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*U.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*U.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*U.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*U.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length},t.prototype._refreshCanvasDimensions=function(){this._canvas.style.width=this._width+"px",this._canvas.width=Math.round(this._width*window.devicePixelRatio),this._canvas.style.height=this._screenElement.clientHeight+"px",this._canvas.height=Math.round(this._screenElement.clientHeight*window.devicePixelRatio),this._refreshDrawConstants(),this._refreshColorZonePadding()},t.prototype._refreshDecorations=function(){var u,y,b,x,k,B;this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();try{for(var P=I(this._decorationService.decorations),H=P.next();!H.done;H=P.next()){var j=H.value;this._colorZoneStore.addDecoration(j)}}catch(y){u={error:y}}finally{try{H&&!H.done&&(y=P.return)&&y.call(P)}finally{if(u)throw u.error}}this._ctx.lineWidth=1;var N=this._colorZoneStore.zones;try{for(var q=I(N),W=q.next();!W.done;W=q.next())"full"!==(K=W.value).position&&this._renderColorZone(K)}catch(u){b={error:u}}finally{try{W&&!W.done&&(x=q.return)&&x.call(q)}finally{if(b)throw b.error}}try{for(var U=I(N),z=U.next();!z.done;z=U.next()){var K;"full"===(K=z.value).position&&this._renderColorZone(K)}}catch(u){k={error:u}}finally{try{z&&!z.done&&(B=U.return)&&B.call(U)}finally{if(k)throw k.error}}this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1},t.prototype._renderColorZone=function(u){this._ctx.fillStyle=u.color,this._ctx.fillRect(K[u.position||"full"],Math.round((this._canvas.height-1)*(u.startBufferLine/this._bufferService.buffers.active.lines.length)-U[u.position||"full"]/2),z[u.position||"full"],Math.round((this._canvas.height-1)*((u.endBufferLine-u.startBufferLine)/this._bufferService.buffers.active.lines.length)+U[u.position||"full"]))},t.prototype._queueRefresh=function(u,y){var b=this;this._shouldUpdateDimensions=u||this._shouldUpdateDimensions,this._shouldUpdateAnchor=y||this._shouldUpdateAnchor,void 0===this._animationFrame&&(this._animationFrame=window.requestAnimationFrame((function(){b._refreshDecorations(),b._animationFrame=void 0})))},B([P(2,W.IBufferService),P(3,W.IDecorationService),P(4,N.IRenderService),P(5,W.IOptionsService)],t)}(q.Disposable);y.OverviewRulerRenderer=V},2950:function(u,y,b){var x=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},k=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.CompositionHelper=void 0;var B=b(4725),P=b(2585),I=function(){function e(u,y,b,x,k,B){this._textarea=u,this._compositionView=y,this._bufferService=b,this._optionsService=x,this._coreService=k,this._renderService=B,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}return Object.defineProperty(e.prototype,"isComposing",{get:function(){return this._isComposing},enumerable:!1,configurable:!0}),e.prototype.compositionstart=function(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")},e.prototype.compositionupdate=function(u){var y=this;this._compositionView.textContent=u.data,this.updateCompositionElements(),setTimeout((function(){y._compositionPosition.end=y._textarea.value.length}),0)},e.prototype.compositionend=function(){this._finalizeComposition(!0)},e.prototype.keydown=function(u){if(this._isComposing||this._isSendingComposition){if(229===u.keyCode)return!1;if(16===u.keyCode||17===u.keyCode||18===u.keyCode)return!1;this._finalizeComposition(!1)}return 229!==u.keyCode||(this._handleAnyTextareaChanges(),!1)},e.prototype._finalizeComposition=function(u){var y=this;if(this._compositionView.classList.remove("active"),this._isComposing=!1,u){var b={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout((function(){var u;y._isSendingComposition&&(y._isSendingComposition=!1,b.start+=y._dataAlreadySent.length,(u=y._isComposing?y._textarea.value.substring(b.start,b.end):y._textarea.value.substring(b.start)).length>0&&y._coreService.triggerDataEvent(u,!0))}),0)}else{this._isSendingComposition=!1;var x=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(x,!0)}},e.prototype._handleAnyTextareaChanges=function(){var u=this,y=this._textarea.value;setTimeout((function(){if(!u._isComposing){var b=u._textarea.value.replace(y,"");b.length>0&&(u._dataAlreadySent=b,u._coreService.triggerDataEvent(b,!0))}}),0)},e.prototype.updateCompositionElements=function(u){var y=this;if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){var b=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),x=this._renderService.dimensions.actualCellHeight,k=this._bufferService.buffer.y*this._renderService.dimensions.actualCellHeight,B=b*this._renderService.dimensions.actualCellWidth;this._compositionView.style.left=B+"px",this._compositionView.style.top=k+"px",this._compositionView.style.height=x+"px",this._compositionView.style.lineHeight=x+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";var P=this._compositionView.getBoundingClientRect();this._textarea.style.left=B+"px",this._textarea.style.top=k+"px",this._textarea.style.width=Math.max(P.width,1)+"px",this._textarea.style.height=Math.max(P.height,1)+"px",this._textarea.style.lineHeight=P.height+"px"}u||setTimeout((function(){return y.updateCompositionElements(!0)}),0)}},x([k(2,P.IBufferService),k(3,P.IOptionsService),k(4,P.ICoreService),k(5,B.IRenderService)],e)}();y.CompositionHelper=I},9806:(u,y)=>{function r(u,y,b){var x=b.getBoundingClientRect(),k=u.getComputedStyle(b),B=parseInt(k.getPropertyValue("padding-left")),P=parseInt(k.getPropertyValue("padding-top"));return[y.clientX-x.left-B,y.clientY-x.top-P]}Object.defineProperty(y,"__esModule",{value:!0}),y.getRawByteCoords=y.getCoords=y.getCoordsRelativeToElement=void 0,y.getCoordsRelativeToElement=r,y.getCoords=function(u,y,b,x,k,B,P,I,H){if(B){var j=r(u,y,b);if(j)return j[0]=Math.ceil((j[0]+(H?P/2:0))/P),j[1]=Math.ceil(j[1]/I),j[0]=Math.min(Math.max(j[0],1),x+(H?1:0)),j[1]=Math.min(Math.max(j[1],1),k),j}},y.getRawByteCoords=function(u){if(u)return{x:u[0]+32,y:u[1]+32}}},9504:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.moveToCellSequence=void 0;var x=b(2584);function n(u,y,b,x){var k=u-o(b,u),B=y-o(b,y),P=Math.abs(k-B)-function(u,y,b){for(var x=0,k=u-o(b,u),B=y-o(b,y),P=0;P<Math.abs(k-B);P++){var I="A"===s(u,y)?-1:1,H=b.buffer.lines.get(k+I*P);(null==H?void 0:H.isWrapped)&&x++}return x}(u,y,b);return l(P,c(s(u,y),x))}function o(u,y){for(var b=0,x=u.buffer.lines.get(y),k=null==x?void 0:x.isWrapped;k&&y>=0&&y<u.rows;)b++,k=null==(x=u.buffer.lines.get(--y))?void 0:x.isWrapped;return b}function s(u,y){return u>y?"A":"B"}function a(u,y,b,x,k,B){for(var P=u,I=y,H="";P!==b||I!==x;)P+=k?1:-1,k&&P>B.cols-1?(H+=B.buffer.translateBufferLineToString(I,!1,u,P),P=0,u=0,I++):!k&&P<0&&(H+=B.buffer.translateBufferLineToString(I,!1,0,u+1),u=P=B.cols-1,I--);return H+B.buffer.translateBufferLineToString(I,!1,u,P)}function c(u,y){var b=y?"O":"[";return x.C0.ESC+b+u}function l(u,y){u=Math.floor(u);for(var b="",x=0;x<u;x++)b+=y;return b}y.moveToCellSequence=function(u,y,b,x){var k,B=b.buffer.x,P=b.buffer.y;if(!b.buffer.hasScrollback)return function(u,y,b,x,k,B){return 0===n(y,x,k,B).length?"":l(a(u,y,u,y-o(k,y),!1,k).length,c("D",B))}(B,P,0,y,b,x)+n(P,y,b,x)+function(u,y,b,x,k,B){var P;P=n(y,x,k,B).length>0?x-o(k,x):y;var I=x,H=function(u,y,b,x,k,B){var P;return P=n(b,x,k,B).length>0?x-o(k,x):y,u<b&&P<=x||u>=b&&P<x?"C":"D"}(u,y,b,x,k,B);return l(a(u,P,b,I,"C"===H,k).length,c(H,B))}(B,P,u,y,b,x);if(P===y)return k=B>u?"D":"C",l(Math.abs(B-u),c(k,x));k=P>y?"D":"C";var I=Math.abs(P-y);return l(function(u,y){return y.cols-u}(P>y?u:B,b)+(I-1)*b.cols+1+((P>y?B:u)-1),c(k,x))}},4389:function(u,y,b){var x=this&&this.__assign||function(){return x=Object.assign||function(u){for(var y,b=1,x=arguments.length;b<x;b++)for(var k in y=arguments[b])Object.prototype.hasOwnProperty.call(y,k)&&(u[k]=y[k]);return u},x.apply(this,arguments)},k=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.Terminal=void 0;var B=b(3236),P=b(9042),I=b(7975),H=b(7090),j=b(5741),N=b(8285),q=["cols","rows"],W=function(){function e(u){var y=this;this._core=new B.Terminal(u),this._addonManager=new j.AddonManager,this._publicOptions=x({},this._core.options);var r=function(u){return y._core.options[u]},n=function(u,b){y._checkReadonlyOptions(u),y._core.options[u]=b};for(var b in this._core.options){var k={get:r.bind(this,b),set:n.bind(this,b)};Object.defineProperty(this._publicOptions,b,k)}}return e.prototype._checkReadonlyOptions=function(u){if(q.includes(u))throw Error('Option "'+u+'" can only be set in the constructor')},e.prototype._checkProposedApi=function(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw Error("You must set the allowProposedApi option to true to use proposed API")},Object.defineProperty(e.prototype,"onBell",{get:function(){return this._core.onBell},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onBinary",{get:function(){return this._core.onBinary},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCursorMove",{get:function(){return this._core.onCursorMove},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onData",{get:function(){return this._core.onData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onKey",{get:function(){return this._core.onKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onLineFeed",{get:function(){return this._core.onLineFeed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRender",{get:function(){return this._core.onRender},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onResize",{get:function(){return this._core.onResize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onScroll",{get:function(){return this._core.onScroll},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onSelectionChange",{get:function(){return this._core.onSelectionChange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onTitleChange",{get:function(){return this._core.onTitleChange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onWriteParsed",{get:function(){return this._core.onWriteParsed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this._core.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parser",{get:function(){return this._checkProposedApi(),this._parser||(this._parser=new I.ParserApi(this._core)),this._parser},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unicode",{get:function(){return this._checkProposedApi(),new H.UnicodeApi(this._core)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textarea",{get:function(){return this._core.textarea},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){return this._core.rows},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cols",{get:function(){return this._core.cols},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffer",{get:function(){return this._checkProposedApi(),this._buffer||(this._buffer=new N.BufferNamespaceApi(this._core)),this._buffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"markers",{get:function(){return this._checkProposedApi(),this._core.markers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modes",{get:function(){var u=this._core.coreService.decPrivateModes,y="none";switch(this._core.coreMouseService.activeProtocol){case"X10":y="x10";break;case"VT200":y="vt200";break;case"DRAG":y="drag";break;case"ANY":y="any"}return{applicationCursorKeysMode:u.applicationCursorKeys,applicationKeypadMode:u.applicationKeypad,bracketedPasteMode:u.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:y,originMode:u.origin,reverseWraparoundMode:u.reverseWraparound,sendFocusMode:u.sendFocus,wraparoundMode:u.wraparound}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._publicOptions},set:function(u){for(var y in u)this._publicOptions[y]=u[y]},enumerable:!1,configurable:!0}),e.prototype.blur=function(){this._core.blur()},e.prototype.focus=function(){this._core.focus()},e.prototype.resize=function(u,y){this._verifyIntegers(u,y),this._core.resize(u,y)},e.prototype.open=function(u){this._core.open(u)},e.prototype.attachCustomKeyEventHandler=function(u){this._core.attachCustomKeyEventHandler(u)},e.prototype.registerLinkMatcher=function(u,y,b){return this._checkProposedApi(),this._core.registerLinkMatcher(u,y,b)},e.prototype.deregisterLinkMatcher=function(u){this._checkProposedApi(),this._core.deregisterLinkMatcher(u)},e.prototype.registerLinkProvider=function(u){return this._checkProposedApi(),this._core.registerLinkProvider(u)},e.prototype.registerCharacterJoiner=function(u){return this._checkProposedApi(),this._core.registerCharacterJoiner(u)},e.prototype.deregisterCharacterJoiner=function(u){this._checkProposedApi(),this._core.deregisterCharacterJoiner(u)},e.prototype.registerMarker=function(u){return void 0===u&&(u=0),this._checkProposedApi(),this._verifyIntegers(u),this._core.addMarker(u)},e.prototype.registerDecoration=function(u){var y,b,x;return this._checkProposedApi(),this._verifyPositiveIntegers(null!==(y=u.x)&&void 0!==y?y:0,null!==(b=u.width)&&void 0!==b?b:0,null!==(x=u.height)&&void 0!==x?x:0),this._core.registerDecoration(u)},e.prototype.addMarker=function(u){return this.registerMarker(u)},e.prototype.hasSelection=function(){return this._core.hasSelection()},e.prototype.select=function(u,y,b){this._verifyIntegers(u,y,b),this._core.select(u,y,b)},e.prototype.getSelection=function(){return this._core.getSelection()},e.prototype.getSelectionPosition=function(){return this._core.getSelectionPosition()},e.prototype.clearSelection=function(){this._core.clearSelection()},e.prototype.selectAll=function(){this._core.selectAll()},e.prototype.selectLines=function(u,y){this._verifyIntegers(u,y),this._core.selectLines(u,y)},e.prototype.dispose=function(){this._addonManager.dispose(),this._core.dispose()},e.prototype.scrollLines=function(u){this._verifyIntegers(u),this._core.scrollLines(u)},e.prototype.scrollPages=function(u){this._verifyIntegers(u),this._core.scrollPages(u)},e.prototype.scrollToTop=function(){this._core.scrollToTop()},e.prototype.scrollToBottom=function(){this._core.scrollToBottom()},e.prototype.scrollToLine=function(u){this._verifyIntegers(u),this._core.scrollToLine(u)},e.prototype.clear=function(){this._core.clear()},e.prototype.write=function(u,y){this._core.write(u,y)},e.prototype.writeUtf8=function(u,y){this._core.write(u,y)},e.prototype.writeln=function(u,y){this._core.write(u),this._core.write("\r\n",y)},e.prototype.paste=function(u){this._core.paste(u)},e.prototype.getOption=function(u){return this._core.optionsService.getOption(u)},e.prototype.setOption=function(u,y){this._checkReadonlyOptions(u),this._core.optionsService.setOption(u,y)},e.prototype.refresh=function(u,y){this._verifyIntegers(u,y),this._core.refresh(u,y)},e.prototype.reset=function(){this._core.reset()},e.prototype.clearTextureAtlas=function(){this._core.clearTextureAtlas()},e.prototype.loadAddon=function(u){return this._addonManager.loadAddon(this,u)},Object.defineProperty(e,"strings",{get:function(){return P},enumerable:!1,configurable:!0}),e.prototype._verifyIntegers=function(){for(var u,y,b=[],x=0;x<arguments.length;x++)b[x]=arguments[x];try{for(var B=k(b),P=B.next();!P.done;P=B.next()){var I=P.value;if(I===1/0||isNaN(I)||I%1!=0)throw Error("This API only accepts integers")}}catch(y){u={error:y}}finally{try{P&&!P.done&&(y=B.return)&&y.call(B)}finally{if(u)throw u.error}}},e.prototype._verifyPositiveIntegers=function(){for(var u,y,b=[],x=0;x<arguments.length;x++)b[x]=arguments[x];try{for(var B=k(b),P=B.next();!P.done;P=B.next()){var I=P.value;if(I&&(I===1/0||isNaN(I)||I%1!=0||I<0))throw Error("This API only accepts positive integers")}}catch(y){u={error:y}}finally{try{P&&!P.done&&(y=B.return)&&y.call(B)}finally{if(u)throw u.error}}},e}();y.Terminal=W},1546:function(u,y,b){var x=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.BaseRenderLayer=void 0;var k=b(643),B=b(8803),P=b(1420),I=b(3734),H=b(1752),j=b(8055),N=b(9631),q=b(8978),W=function(){function e(u,y,b,x,k,B,P,I,H){this._container=u,this._alpha=x,this._colors=k,this._rendererId=B,this._bufferService=P,this._optionsService=I,this._decorationService=H,this._scaledCharWidth=0,this._scaledCharHeight=0,this._scaledCellWidth=0,this._scaledCellHeight=0,this._scaledCharLeft=0,this._scaledCharTop=0,this._columnSelectMode=!1,this._currentGlyphIdentifier={chars:"",code:0,bg:0,fg:0,bold:!1,dim:!1,italic:!1},this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-"+y+"-layer"),this._canvas.style.zIndex=b.toString(),this._initCanvas(),this._container.appendChild(this._canvas)}return e.prototype.dispose=function(){var u;(0,N.removeElementFromParent)(this._canvas),null===(u=this._charAtlas)||void 0===u||u.dispose()},e.prototype._initCanvas=function(){this._ctx=(0,H.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()},e.prototype.onOptionsChanged=function(){},e.prototype.onBlur=function(){},e.prototype.onFocus=function(){},e.prototype.onCursorMove=function(){},e.prototype.onGridChanged=function(u,y){},e.prototype.onSelectionChanged=function(u,y,b){void 0===b&&(b=!1),this._selectionStart=u,this._selectionEnd=y,this._columnSelectMode=b},e.prototype.setColors=function(u){this._refreshCharAtlas(u)},e.prototype._setTransparency=function(u){if(u!==this._alpha){var y=this._canvas;this._alpha=u,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,y),this._refreshCharAtlas(this._colors),this.onGridChanged(0,this._bufferService.rows-1)}},e.prototype._refreshCharAtlas=function(u){this._scaledCharWidth<=0&&this._scaledCharHeight<=0||(this._charAtlas=(0,P.acquireCharAtlas)(this._optionsService.rawOptions,this._rendererId,u,this._scaledCharWidth,this._scaledCharHeight),this._charAtlas.warmUp())},e.prototype.resize=function(u){this._scaledCellWidth=u.scaledCellWidth,this._scaledCellHeight=u.scaledCellHeight,this._scaledCharWidth=u.scaledCharWidth,this._scaledCharHeight=u.scaledCharHeight,this._scaledCharLeft=u.scaledCharLeft,this._scaledCharTop=u.scaledCharTop,this._canvas.width=u.scaledCanvasWidth,this._canvas.height=u.scaledCanvasHeight,this._canvas.style.width=u.canvasWidth+"px",this._canvas.style.height=u.canvasHeight+"px",this._alpha||this._clearAll(),this._refreshCharAtlas(this._colors)},e.prototype.clearTextureAtlas=function(){var u;null===(u=this._charAtlas)||void 0===u||u.clear()},e.prototype._fillCells=function(u,y,b,x){this._ctx.fillRect(u*this._scaledCellWidth,y*this._scaledCellHeight,b*this._scaledCellWidth,x*this._scaledCellHeight)},e.prototype._fillMiddleLineAtCells=function(u,y,b){void 0===b&&(b=1);var x=Math.ceil(.5*this._scaledCellHeight);this._ctx.fillRect(u*this._scaledCellWidth,(y+1)*this._scaledCellHeight-x-window.devicePixelRatio,b*this._scaledCellWidth,window.devicePixelRatio)},e.prototype._fillBottomLineAtCells=function(u,y,b){void 0===b&&(b=1),this._ctx.fillRect(u*this._scaledCellWidth,(y+1)*this._scaledCellHeight-window.devicePixelRatio-1,b*this._scaledCellWidth,window.devicePixelRatio)},e.prototype._fillLeftLineAtCell=function(u,y,b){this._ctx.fillRect(u*this._scaledCellWidth,y*this._scaledCellHeight,window.devicePixelRatio*b,this._scaledCellHeight)},e.prototype._strokeRectAtCell=function(u,y,b,x){this._ctx.lineWidth=window.devicePixelRatio,this._ctx.strokeRect(u*this._scaledCellWidth+window.devicePixelRatio/2,y*this._scaledCellHeight+window.devicePixelRatio/2,b*this._scaledCellWidth-window.devicePixelRatio,x*this._scaledCellHeight-window.devicePixelRatio)},e.prototype._clearAll=function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))},e.prototype._clearCells=function(u,y,b,x){this._alpha?this._ctx.clearRect(u*this._scaledCellWidth,y*this._scaledCellHeight,b*this._scaledCellWidth,x*this._scaledCellHeight):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(u*this._scaledCellWidth,y*this._scaledCellHeight,b*this._scaledCellWidth,x*this._scaledCellHeight))},e.prototype._fillCharTrueColor=function(u,y,b){this._ctx.font=this._getFont(!1,!1),this._ctx.textBaseline=B.TEXT_BASELINE,this._clipRow(b);var x=!1;!1!==this._optionsService.rawOptions.customGlyphs&&(x=(0,q.tryDrawCustomChar)(this._ctx,u.getChars(),y*this._scaledCellWidth,b*this._scaledCellHeight,this._scaledCellWidth,this._scaledCellHeight)),x||this._ctx.fillText(u.getChars(),y*this._scaledCellWidth+this._scaledCharLeft,b*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight)},e.prototype._drawChars=function(u,y,b){var P,I,H,j=this._getContrastColor(u,y,b);if(j||u.isFgRGB()||u.isBgRGB())this._drawUncachedChars(u,y,b,j);else{var N,q;u.isInverse()?(N=u.isBgDefault()?B.INVERTED_DEFAULT_COLOR:u.getBgColor(),q=u.isFgDefault()?B.INVERTED_DEFAULT_COLOR:u.getFgColor()):(q=u.isBgDefault()?k.DEFAULT_COLOR:u.getBgColor(),N=u.isFgDefault()?k.DEFAULT_COLOR:u.getFgColor()),N+=this._optionsService.rawOptions.drawBoldTextInBrightColors&&u.isBold()&&N<8?8:0,this._currentGlyphIdentifier.chars=u.getChars()||k.WHITESPACE_CELL_CHAR,this._currentGlyphIdentifier.code=u.getCode()||k.WHITESPACE_CELL_CODE,this._currentGlyphIdentifier.bg=q,this._currentGlyphIdentifier.fg=N,this._currentGlyphIdentifier.bold=!!u.isBold(),this._currentGlyphIdentifier.dim=!!u.isDim(),this._currentGlyphIdentifier.italic=!!u.isItalic();var W=!1;try{for(var U=x(this._decorationService.getDecorationsAtCell(y,b)),z=U.next();!z.done;z=U.next()){var K=z.value;if(K.backgroundColorRGB||K.foregroundColorRGB){W=!0;break}}}catch(u){P={error:u}}finally{try{z&&!z.done&&(I=U.return)&&I.call(U)}finally{if(P)throw P.error}}!W&&(null===(H=this._charAtlas)||void 0===H?void 0:H.draw(this._ctx,this._currentGlyphIdentifier,y*this._scaledCellWidth+this._scaledCharLeft,b*this._scaledCellHeight+this._scaledCharTop))||this._drawUncachedChars(u,y,b)}},e.prototype._drawUncachedChars=function(u,y,b,x){if(this._ctx.save(),this._ctx.font=this._getFont(!!u.isBold(),!!u.isItalic()),this._ctx.textBaseline=B.TEXT_BASELINE,u.isInverse())if(x)this._ctx.fillStyle=x.css;else if(u.isBgDefault())this._ctx.fillStyle=j.color.opaque(this._colors.background).css;else if(u.isBgRGB())this._ctx.fillStyle="rgb("+I.AttributeData.toColorRGB(u.getBgColor()).join(",")+")";else{var k=u.getBgColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&u.isBold()&&k<8&&(k+=8),this._ctx.fillStyle=this._colors.ansi[k].css}else if(x)this._ctx.fillStyle=x.css;else if(u.isFgDefault())this._ctx.fillStyle=this._colors.foreground.css;else if(u.isFgRGB())this._ctx.fillStyle="rgb("+I.AttributeData.toColorRGB(u.getFgColor()).join(",")+")";else{var P=u.getFgColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&u.isBold()&&P<8&&(P+=8),this._ctx.fillStyle=this._colors.ansi[P].css}this._clipRow(b),u.isDim()&&(this._ctx.globalAlpha=B.DIM_OPACITY);var H=!1;!1!==this._optionsService.rawOptions.customGlyphs&&(H=(0,q.tryDrawCustomChar)(this._ctx,u.getChars(),y*this._scaledCellWidth,b*this._scaledCellHeight,this._scaledCellWidth,this._scaledCellHeight)),H||this._ctx.fillText(u.getChars(),y*this._scaledCellWidth+this._scaledCharLeft,b*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight),this._ctx.restore()},e.prototype._clipRow=function(u){this._ctx.beginPath(),this._ctx.rect(0,u*this._scaledCellHeight,this._bufferService.cols*this._scaledCellWidth,this._scaledCellHeight),this._ctx.clip()},e.prototype._getFont=function(u,y){return(y?"italic":"")+" "+(u?this._optionsService.rawOptions.fontWeightBold:this._optionsService.rawOptions.fontWeight)+" "+this._optionsService.rawOptions.fontSize*window.devicePixelRatio+"px "+this._optionsService.rawOptions.fontFamily},e.prototype._getContrastColor=function(u,y,b){var k,B,P,I,N=!1;try{for(var q=x(this._decorationService.getDecorationsAtCell(y,b)),W=q.next();!W.done;W=q.next()){var U=W.value;"top"!==U.options.layer&&N||(U.backgroundColorRGB&&(P=U.backgroundColorRGB.rgba),U.foregroundColorRGB&&(I=U.foregroundColorRGB.rgba),N="top"===U.options.layer)}}catch(u){k={error:u}}finally{try{W&&!W.done&&(B=q.return)&&B.call(q)}finally{if(k)throw k.error}}if(N||this._colors.selectionForeground&&this._isCellInSelection(y,b)&&(I=this._colors.selectionForeground.rgba),P||I||1!==this._optionsService.rawOptions.minimumContrastRatio&&!(0,H.excludeFromContrastRatioDemands)(u.getCode())){if(!P&&!I){var z=this._colors.contrastCache.getColor(u.bg,u.fg);if(void 0!==z)return z||void 0}var K=u.getFgColor(),V=u.getFgColorMode(),G=u.getBgColor(),X=u.getBgColorMode(),Y=!!u.isInverse(),J=!!u.isInverse();if(Y){var $=K;K=G,G=$;var Q=V;V=X,X=Q}var ee=this._resolveBackgroundRgba(void 0!==P?50331648:X,null!=P?P:G,Y),te=this._resolveForegroundRgba(V,K,Y,J),re=j.rgba.ensureContrastRatio(null!=P?P:ee,null!=I?I:te,this._optionsService.rawOptions.minimumContrastRatio);if(!re){if(!I)return void this._colors.contrastCache.setColor(u.bg,u.fg,null);re=I}var ie={css:j.channels.toCss(re>>24&255,re>>16&255,re>>8&255),rgba:re};return P||I||this._colors.contrastCache.setColor(u.bg,u.fg,ie),ie}},e.prototype._resolveBackgroundRgba=function(u,y,b){switch(u){case 16777216:case 33554432:return this._colors.ansi[y].rgba;case 50331648:return y<<8;default:return b?this._colors.foreground.rgba:this._colors.background.rgba}},e.prototype._resolveForegroundRgba=function(u,y,b,x){switch(u){case 16777216:case 33554432:return this._optionsService.rawOptions.drawBoldTextInBrightColors&&x&&y<8&&(y+=8),this._colors.ansi[y].rgba;case 50331648:return y<<8;default:return b?this._colors.background.rgba:this._colors.foreground.rgba}},e.prototype._isCellInSelection=function(u,y){var b=this._selectionStart,x=this._selectionEnd;return!(!b||!x)&&(this._columnSelectMode?u>=b[0]&&y>=b[1]&&u<x[0]&&y<x[1]:y>b[1]&&y<x[1]||b[1]===x[1]&&y===b[1]&&u>=b[0]&&u<x[0]||b[1]<x[1]&&y===x[1]&&u<x[0]||b[1]<x[1]&&y===b[1]&&u>=b[0])},e}();y.BaseRenderLayer=W},2512:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.CursorRenderLayer=void 0;var I=b(1546),H=b(511),j=b(2585),N=b(4725),q=600,W=function(u){function t(y,b,x,k,B,P,I,j,N,q){var W=u.call(this,y,"cursor",b,!0,x,k,P,I,q)||this;return W._onRequestRedraw=B,W._coreService=j,W._coreBrowserService=N,W._cell=new H.CellData,W._state={x:0,y:0,isFocused:!1,style:"",width:0},W._cursorRenderers={bar:W._renderBarCursor.bind(W),block:W._renderBlockCursor.bind(W),underline:W._renderUnderlineCursor.bind(W)},W}return k(t,u),t.prototype.dispose=function(){this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this._cursorBlinkStateManager=void 0),u.prototype.dispose.call(this)},t.prototype.resize=function(y){u.prototype.resize.call(this,y),this._state={x:0,y:0,isFocused:!1,style:"",width:0}},t.prototype.reset=function(){var u;this._clearCursor(),null===(u=this._cursorBlinkStateManager)||void 0===u||u.restartBlinkAnimation(),this.onOptionsChanged()},t.prototype.onBlur=function(){var u;null===(u=this._cursorBlinkStateManager)||void 0===u||u.pause(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},t.prototype.onFocus=function(){var u;null===(u=this._cursorBlinkStateManager)||void 0===u||u.resume(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},t.prototype.onOptionsChanged=function(){var u,y=this;this._optionsService.rawOptions.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new U(this._coreBrowserService.isFocused,(function(){y._render(!0)}))):(null===(u=this._cursorBlinkStateManager)||void 0===u||u.dispose(),this._cursorBlinkStateManager=void 0),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},t.prototype.onCursorMove=function(){var u;null===(u=this._cursorBlinkStateManager)||void 0===u||u.restartBlinkAnimation()},t.prototype.onGridChanged=function(u,y){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(!1):this._cursorBlinkStateManager.restartBlinkAnimation()},t.prototype._render=function(u){if(this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden){var y=this._bufferService.buffer.ybase+this._bufferService.buffer.y,b=y-this._bufferService.buffer.ydisp;if(b<0||b>=this._bufferService.rows)this._clearCursor();else{var x=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1);if(this._bufferService.buffer.lines.get(y).loadCell(x,this._cell),void 0!==this._cell.content){if(!this._coreBrowserService.isFocused){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css;var k=this._optionsService.rawOptions.cursorStyle;return k&&"block"!==k?this._cursorRenderers[k](x,b,this._cell):this._renderBlurCursor(x,b,this._cell),this._ctx.restore(),this._state.x=x,this._state.y=b,this._state.isFocused=!1,this._state.style=k,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===x&&this._state.y===b&&this._state.isFocused===this._coreBrowserService.isFocused&&this._state.style===this._optionsService.rawOptions.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[this._optionsService.rawOptions.cursorStyle||"block"](x,b,this._cell),this._ctx.restore(),this._state.x=x,this._state.y=b,this._state.isFocused=!1,this._state.style=this._optionsService.rawOptions.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}}else this._clearCursor()},t.prototype._clearCursor=function(){this._state&&(window.devicePixelRatio<1?this._clearAll():this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})},t.prototype._renderBarCursor=function(u,y,b){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillLeftLineAtCell(u,y,this._optionsService.rawOptions.cursorWidth),this._ctx.restore()},t.prototype._renderBlockCursor=function(u,y,b){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillCells(u,y,b.getWidth(),1),this._ctx.fillStyle=this._colors.cursorAccent.css,this._fillCharTrueColor(b,u,y),this._ctx.restore()},t.prototype._renderUnderlineCursor=function(u,y,b){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillBottomLineAtCells(u,y),this._ctx.restore()},t.prototype._renderBlurCursor=function(u,y,b){this._ctx.save(),this._ctx.strokeStyle=this._colors.cursor.css,this._strokeRectAtCell(u,y,b.getWidth(),1),this._ctx.restore()},B([P(5,j.IBufferService),P(6,j.IOptionsService),P(7,j.ICoreService),P(8,N.ICoreBrowserService),P(9,j.IDecorationService)],t)}(I.BaseRenderLayer);y.CursorRenderLayer=W;var U=function(){function e(u,y){this._renderCallback=y,this.isCursorVisible=!0,u&&this._restartInterval()}return Object.defineProperty(e.prototype,"isPaused",{get:function(){return!(this._blinkStartTimeout||this._blinkInterval)},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},e.prototype.restartBlinkAnimation=function(){var u=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=window.requestAnimationFrame((function(){u._renderCallback(),u._animationFrame=void 0}))))},e.prototype._restartInterval=function(u){var y=this;void 0===u&&(u=q),this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=window.setTimeout((function(){if(y._animationTimeRestarted){var u=q-(Date.now()-y._animationTimeRestarted);if(y._animationTimeRestarted=void 0,u>0)return void y._restartInterval(u)}y.isCursorVisible=!1,y._animationFrame=window.requestAnimationFrame((function(){y._renderCallback(),y._animationFrame=void 0})),y._blinkInterval=window.setInterval((function(){if(y._animationTimeRestarted){var u=q-(Date.now()-y._animationTimeRestarted);return y._animationTimeRestarted=void 0,void y._restartInterval(u)}y.isCursorVisible=!y.isCursorVisible,y._animationFrame=window.requestAnimationFrame((function(){y._renderCallback(),y._animationFrame=void 0}))}),q)}),u)},e.prototype.pause=function(){this.isCursorVisible=!0,this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},e.prototype.resume=function(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()},e}()},8978:function(u,y,b){var x,k,B,P,I,H,j,N,q,W,U,z,K,V,G,X,Y,J,$,Q,ee,te,re,ie,ne,oe,se,ae,ce,le,he,ue,fe,_e,de,pe,ve,ye,ge,me,be,Se,Ce,we,Le,Ee,xe,ke,Re,Ae,Oe,Me,Te,Be,De,Pe,Ie,He,je,Fe,Ne,qe,We,Ue,ze,Ze,Ke,Ve,Ge,Xe,Ye,Je,$e,Qe,et,tt,rt,it,nt,ot,st,at,ct,lt,ht,ut,ft,_t,dt,pt,vt,yt,gt,mt,bt,St,Ct,wt,Lt,Et,xt,Rt,Ot,Mt,Tt,Bt,Dt,Pt,It,Ht,jt,Ft,Nt,qt,Wt,Ut,zt,Zt,Kt,Vt,Gt,Xt,Yt,Jt,$t,Qt,er,tr,rr=this&&this.__read||function(u,y){var b="function"==typeof Symbol&&u[Symbol.iterator];if(!b)return u;var x,k,B=b.call(u),P=[];try{for(;(void 0===y||y-- >0)&&!(x=B.next()).done;)P.push(x.value)}catch(u){k={error:u}}finally{try{x&&!x.done&&(b=B.return)&&b.call(B)}finally{if(k)throw k.error}}return P},ir=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.tryDrawCustomChar=y.powerlineDefinitions=y.boxDrawingDefinitions=y.blockElementDefinitions=void 0;var nr=b(1752);y.blockElementDefinitions={"▀":[{x:0,y:0,w:8,h:4}],"▁":[{x:0,y:7,w:8,h:1}],"▂":[{x:0,y:6,w:8,h:2}],"▃":[{x:0,y:5,w:8,h:3}],"▄":[{x:0,y:4,w:8,h:4}],"▅":[{x:0,y:3,w:8,h:5}],"▆":[{x:0,y:2,w:8,h:6}],"▇":[{x:0,y:1,w:8,h:7}],"█":[{x:0,y:0,w:8,h:8}],"▉":[{x:0,y:0,w:7,h:8}],"▊":[{x:0,y:0,w:6,h:8}],"▋":[{x:0,y:0,w:5,h:8}],"▌":[{x:0,y:0,w:4,h:8}],"▍":[{x:0,y:0,w:3,h:8}],"▎":[{x:0,y:0,w:2,h:8}],"▏":[{x:0,y:0,w:1,h:8}],"▐":[{x:4,y:0,w:4,h:8}],"▔":[{x:0,y:0,w:9,h:1}],"▕":[{x:7,y:0,w:1,h:8}],"▖":[{x:0,y:4,w:4,h:4}],"▗":[{x:4,y:4,w:4,h:4}],"▘":[{x:0,y:0,w:4,h:4}],"▙":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"▚":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"▛":[{x:0,y:0,w:4,h:8},{x:0,y:0,w:4,h:8}],"▜":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"▝":[{x:4,y:0,w:4,h:4}],"▞":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"▟":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"🭰":[{x:1,y:0,w:1,h:8}],"🭱":[{x:2,y:0,w:1,h:8}],"🭲":[{x:3,y:0,w:1,h:8}],"🭳":[{x:4,y:0,w:1,h:8}],"🭴":[{x:5,y:0,w:1,h:8}],"🭵":[{x:6,y:0,w:1,h:8}],"🭶":[{x:0,y:1,w:8,h:1}],"🭷":[{x:0,y:2,w:8,h:1}],"🭸":[{x:0,y:3,w:8,h:1}],"🭹":[{x:0,y:4,w:8,h:1}],"🭺":[{x:0,y:5,w:8,h:1}],"🭻":[{x:0,y:6,w:8,h:1}],"🭼":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"🭽":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"🭾":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"🭿":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"🮀":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"🮁":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"🮂":[{x:0,y:0,w:8,h:2}],"🮃":[{x:0,y:0,w:8,h:3}],"🮄":[{x:0,y:0,w:8,h:5}],"🮅":[{x:0,y:0,w:8,h:6}],"🮆":[{x:0,y:0,w:8,h:7}],"🮇":[{x:6,y:0,w:2,h:8}],"🮈":[{x:5,y:0,w:3,h:8}],"🮉":[{x:3,y:0,w:5,h:8}],"🮊":[{x:2,y:0,w:6,h:8}],"🮋":[{x:1,y:0,w:7,h:8}],"🮕":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"🮖":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"🮗":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};var or={"░":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"▒":[[1,0],[0,0],[0,1],[0,0]],"▓":[[0,1],[1,1],[1,0],[1,1]]};y.boxDrawingDefinitions={"─":(x={},x[1]="M0,.5 L1,.5",x),"━":(k={},k[3]="M0,.5 L1,.5",k),"│":(B={},B[1]="M.5,0 L.5,1",B),"┃":(P={},P[3]="M.5,0 L.5,1",P),"┌":(I={},I[1]="M0.5,1 L.5,.5 L1,.5",I),"┏":(H={},H[3]="M0.5,1 L.5,.5 L1,.5",H),"┐":(j={},j[1]="M0,.5 L.5,.5 L.5,1",j),"┓":(N={},N[3]="M0,.5 L.5,.5 L.5,1",N),"└":(q={},q[1]="M.5,0 L.5,.5 L1,.5",q),"┗":(W={},W[3]="M.5,0 L.5,.5 L1,.5",W),"┘":(U={},U[1]="M.5,0 L.5,.5 L0,.5",U),"┛":(z={},z[3]="M.5,0 L.5,.5 L0,.5",z),"├":(K={},K[1]="M.5,0 L.5,1 M.5,.5 L1,.5",K),"┣":(V={},V[3]="M.5,0 L.5,1 M.5,.5 L1,.5",V),"┤":(G={},G[1]="M.5,0 L.5,1 M.5,.5 L0,.5",G),"┫":(X={},X[3]="M.5,0 L.5,1 M.5,.5 L0,.5",X),"┬":(Y={},Y[1]="M0,.5 L1,.5 M.5,.5 L.5,1",Y),"┳":(J={},J[3]="M0,.5 L1,.5 M.5,.5 L.5,1",J),"┴":($={},$[1]="M0,.5 L1,.5 M.5,.5 L.5,0",$),"┻":(Q={},Q[3]="M0,.5 L1,.5 M.5,.5 L.5,0",Q),"┼":(ee={},ee[1]="M0,.5 L1,.5 M.5,0 L.5,1",ee),"╋":(te={},te[3]="M0,.5 L1,.5 M.5,0 L.5,1",te),"╴":(re={},re[1]="M.5,.5 L0,.5",re),"╸":(ie={},ie[3]="M.5,.5 L0,.5",ie),"╵":(ne={},ne[1]="M.5,.5 L.5,0",ne),"╹":(oe={},oe[3]="M.5,.5 L.5,0",oe),"╶":(se={},se[1]="M.5,.5 L1,.5",se),"╺":(ae={},ae[3]="M.5,.5 L1,.5",ae),"╷":(ce={},ce[1]="M.5,.5 L.5,1",ce),"╻":(le={},le[3]="M.5,.5 L.5,1",le),"═":(he={},he[1]=function(u,y){return"M0,"+(.5-y)+" L1,"+(.5-y)+" M0,"+(.5+y)+" L1,"+(.5+y)},he),"║":(ue={},ue[1]=function(u,y){return"M"+(.5-u)+",0 L"+(.5-u)+",1 M"+(.5+u)+",0 L"+(.5+u)+",1"},ue),"╒":(fe={},fe[1]=function(u,y){return"M.5,1 L.5,"+(.5-y)+" L1,"+(.5-y)+" M.5,"+(.5+y)+" L1,"+(.5+y)},fe),"╓":(_e={},_e[1]=function(u,y){return"M"+(.5-u)+",1 L"+(.5-u)+",.5 L1,.5 M"+(.5+u)+",.5 L"+(.5+u)+",1"},_e),"╔":(de={},de[1]=function(u,y){return"M1,"+(.5-y)+" L"+(.5-u)+","+(.5-y)+" L"+(.5-u)+",1 M1,"+(.5+y)+" L"+(.5+u)+","+(.5+y)+" L"+(.5+u)+",1"},de),"╕":(pe={},pe[1]=function(u,y){return"M0,"+(.5-y)+" L.5,"+(.5-y)+" L.5,1 M0,"+(.5+y)+" L.5,"+(.5+y)},pe),"╖":(ve={},ve[1]=function(u,y){return"M"+(.5+u)+",1 L"+(.5+u)+",.5 L0,.5 M"+(.5-u)+",.5 L"+(.5-u)+",1"},ve),"╗":(ye={},ye[1]=function(u,y){return"M0,"+(.5+y)+" L"+(.5-u)+","+(.5+y)+" L"+(.5-u)+",1 M0,"+(.5-y)+" L"+(.5+u)+","+(.5-y)+" L"+(.5+u)+",1"},ye),"╘":(ge={},ge[1]=function(u,y){return"M.5,0 L.5,"+(.5+y)+" L1,"+(.5+y)+" M.5,"+(.5-y)+" L1,"+(.5-y)},ge),"╙":(me={},me[1]=function(u,y){return"M1,.5 L"+(.5-u)+",.5 L"+(.5-u)+",0 M"+(.5+u)+",.5 L"+(.5+u)+",0"},me),"╚":(be={},be[1]=function(u,y){return"M1,"+(.5-y)+" L"+(.5+u)+","+(.5-y)+" L"+(.5+u)+",0 M1,"+(.5+y)+" L"+(.5-u)+","+(.5+y)+" L"+(.5-u)+",0"},be),"╛":(Se={},Se[1]=function(u,y){return"M0,"+(.5+y)+" L.5,"+(.5+y)+" L.5,0 M0,"+(.5-y)+" L.5,"+(.5-y)},Se),"╜":(Ce={},Ce[1]=function(u,y){return"M0,.5 L"+(.5+u)+",.5 L"+(.5+u)+",0 M"+(.5-u)+",.5 L"+(.5-u)+",0"},Ce),"╝":(we={},we[1]=function(u,y){return"M0,"+(.5-y)+" L"+(.5-u)+","+(.5-y)+" L"+(.5-u)+",0 M0,"+(.5+y)+" L"+(.5+u)+","+(.5+y)+" L"+(.5+u)+",0"},we),"╞":(Le={},Le[1]=function(u,y){return"M.5,0 L.5,1 M.5,"+(.5-y)+" L1,"+(.5-y)+" M.5,"+(.5+y)+" L1,"+(.5+y)},Le),"╟":(Ee={},Ee[1]=function(u,y){return"M"+(.5-u)+",0 L"+(.5-u)+",1 M"+(.5+u)+",0 L"+(.5+u)+",1 M"+(.5+u)+",.5 L1,.5"},Ee),"╠":(xe={},xe[1]=function(u,y){return"M"+(.5-u)+",0 L"+(.5-u)+",1 M1,"+(.5+y)+" L"+(.5+u)+","+(.5+y)+" L"+(.5+u)+",1 M1,"+(.5-y)+" L"+(.5+u)+","+(.5-y)+" L"+(.5+u)+",0"},xe),"╡":(ke={},ke[1]=function(u,y){return"M.5,0 L.5,1 M0,"+(.5-y)+" L.5,"+(.5-y)+" M0,"+(.5+y)+" L.5,"+(.5+y)},ke),"╢":(Re={},Re[1]=function(u,y){return"M0,.5 L"+(.5-u)+",.5 M"+(.5-u)+",0 L"+(.5-u)+",1 M"+(.5+u)+",0 L"+(.5+u)+",1"},Re),"╣":(Ae={},Ae[1]=function(u,y){return"M"+(.5+u)+",0 L"+(.5+u)+",1 M0,"+(.5+y)+" L"+(.5-u)+","+(.5+y)+" L"+(.5-u)+",1 M0,"+(.5-y)+" L"+(.5-u)+","+(.5-y)+" L"+(.5-u)+",0"},Ae),"╤":(Oe={},Oe[1]=function(u,y){return"M0,"+(.5-y)+" L1,"+(.5-y)+" M0,"+(.5+y)+" L1,"+(.5+y)+" M.5,"+(.5+y)+" L.5,1"},Oe),"╥":(Me={},Me[1]=function(u,y){return"M0,.5 L1,.5 M"+(.5-u)+",.5 L"+(.5-u)+",1 M"+(.5+u)+",.5 L"+(.5+u)+",1"},Me),"╦":(Te={},Te[1]=function(u,y){return"M0,"+(.5-y)+" L1,"+(.5-y)+" M0,"+(.5+y)+" L"+(.5-u)+","+(.5+y)+" L"+(.5-u)+",1 M1,"+(.5+y)+" L"+(.5+u)+","+(.5+y)+" L"+(.5+u)+",1"},Te),"╧":(Be={},Be[1]=function(u,y){return"M.5,0 L.5,"+(.5-y)+" M0,"+(.5-y)+" L1,"+(.5-y)+" M0,"+(.5+y)+" L1,"+(.5+y)},Be),"╨":(De={},De[1]=function(u,y){return"M0,.5 L1,.5 M"+(.5-u)+",.5 L"+(.5-u)+",0 M"+(.5+u)+",.5 L"+(.5+u)+",0"},De),"╩":(Pe={},Pe[1]=function(u,y){return"M0,"+(.5+y)+" L1,"+(.5+y)+" M0,"+(.5-y)+" L"+(.5-u)+","+(.5-y)+" L"+(.5-u)+",0 M1,"+(.5-y)+" L"+(.5+u)+","+(.5-y)+" L"+(.5+u)+",0"},Pe),"╪":(Ie={},Ie[1]=function(u,y){return"M.5,0 L.5,1 M0,"+(.5-y)+" L1,"+(.5-y)+" M0,"+(.5+y)+" L1,"+(.5+y)},Ie),"╫":(He={},He[1]=function(u,y){return"M0,.5 L1,.5 M"+(.5-u)+",0 L"+(.5-u)+",1 M"+(.5+u)+",0 L"+(.5+u)+",1"},He),"╬":(je={},je[1]=function(u,y){return"M0,"+(.5+y)+" L"+(.5-u)+","+(.5+y)+" L"+(.5-u)+",1 M1,"+(.5+y)+" L"+(.5+u)+","+(.5+y)+" L"+(.5+u)+",1 M0,"+(.5-y)+" L"+(.5-u)+","+(.5-y)+" L"+(.5-u)+",0 M1,"+(.5-y)+" L"+(.5+u)+","+(.5-y)+" L"+(.5+u)+",0"},je),"╱":(Fe={},Fe[1]="M1,0 L0,1",Fe),"╲":(Ne={},Ne[1]="M0,0 L1,1",Ne),"╳":(qe={},qe[1]="M1,0 L0,1 M0,0 L1,1",qe),"╼":(We={},We[1]="M.5,.5 L0,.5",We[3]="M.5,.5 L1,.5",We),"╽":(Ue={},Ue[1]="M.5,.5 L.5,0",Ue[3]="M.5,.5 L.5,1",Ue),"╾":(ze={},ze[1]="M.5,.5 L1,.5",ze[3]="M.5,.5 L0,.5",ze),"╿":(Ze={},Ze[1]="M.5,.5 L.5,1",Ze[3]="M.5,.5 L.5,0",Ze),"┍":(Ke={},Ke[1]="M.5,.5 L.5,1",Ke[3]="M.5,.5 L1,.5",Ke),"┎":(Ve={},Ve[1]="M.5,.5 L1,.5",Ve[3]="M.5,.5 L.5,1",Ve),"┑":(Ge={},Ge[1]="M.5,.5 L.5,1",Ge[3]="M.5,.5 L0,.5",Ge),"┒":(Xe={},Xe[1]="M.5,.5 L0,.5",Xe[3]="M.5,.5 L.5,1",Xe),"┕":(Ye={},Ye[1]="M.5,.5 L.5,0",Ye[3]="M.5,.5 L1,.5",Ye),"┖":(Je={},Je[1]="M.5,.5 L1,.5",Je[3]="M.5,.5 L.5,0",Je),"┙":($e={},$e[1]="M.5,.5 L.5,0",$e[3]="M.5,.5 L0,.5",$e),"┚":(Qe={},Qe[1]="M.5,.5 L0,.5",Qe[3]="M.5,.5 L.5,0",Qe),"┝":(et={},et[1]="M.5,0 L.5,1",et[3]="M.5,.5 L1,.5",et),"┞":(tt={},tt[1]="M0.5,1 L.5,.5 L1,.5",tt[3]="M.5,.5 L.5,0",tt),"┟":(rt={},rt[1]="M.5,0 L.5,.5 L1,.5",rt[3]="M.5,.5 L.5,1",rt),"┠":(it={},it[1]="M.5,.5 L1,.5",it[3]="M.5,0 L.5,1",it),"┡":(nt={},nt[1]="M.5,.5 L.5,1",nt[3]="M.5,0 L.5,.5 L1,.5",nt),"┢":(ot={},ot[1]="M.5,.5 L.5,0",ot[3]="M0.5,1 L.5,.5 L1,.5",ot),"┥":(st={},st[1]="M.5,0 L.5,1",st[3]="M.5,.5 L0,.5",st),"┦":(at={},at[1]="M0,.5 L.5,.5 L.5,1",at[3]="M.5,.5 L.5,0",at),"┧":(ct={},ct[1]="M.5,0 L.5,.5 L0,.5",ct[3]="M.5,.5 L.5,1",ct),"┨":(lt={},lt[1]="M.5,.5 L0,.5",lt[3]="M.5,0 L.5,1",lt),"┩":(ht={},ht[1]="M.5,.5 L.5,1",ht[3]="M.5,0 L.5,.5 L0,.5",ht),"┪":(ut={},ut[1]="M.5,.5 L.5,0",ut[3]="M0,.5 L.5,.5 L.5,1",ut),"┭":(ft={},ft[1]="M0.5,1 L.5,.5 L1,.5",ft[3]="M.5,.5 L0,.5",ft),"┮":(_t={},_t[1]="M0,.5 L.5,.5 L.5,1",_t[3]="M.5,.5 L1,.5",_t),"┯":(dt={},dt[1]="M.5,.5 L.5,1",dt[3]="M0,.5 L1,.5",dt),"┰":(pt={},pt[1]="M0,.5 L1,.5",pt[3]="M.5,.5 L.5,1",pt),"┱":(vt={},vt[1]="M.5,.5 L1,.5",vt[3]="M0,.5 L.5,.5 L.5,1",vt),"┲":(yt={},yt[1]="M.5,.5 L0,.5",yt[3]="M0.5,1 L.5,.5 L1,.5",yt),"┵":(gt={},gt[1]="M.5,0 L.5,.5 L1,.5",gt[3]="M.5,.5 L0,.5",gt),"┶":(mt={},mt[1]="M.5,0 L.5,.5 L0,.5",mt[3]="M.5,.5 L1,.5",mt),"┷":(bt={},bt[1]="M.5,.5 L.5,0",bt[3]="M0,.5 L1,.5",bt),"┸":(St={},St[1]="M0,.5 L1,.5",St[3]="M.5,.5 L.5,0",St),"┹":(Ct={},Ct[1]="M.5,.5 L1,.5",Ct[3]="M.5,0 L.5,.5 L0,.5",Ct),"┺":(wt={},wt[1]="M.5,.5 L0,.5",wt[3]="M.5,0 L.5,.5 L1,.5",wt),"┽":(Lt={},Lt[1]="M.5,0 L.5,1 M.5,.5 L1,.5",Lt[3]="M.5,.5 L0,.5",Lt),"┾":(Et={},Et[1]="M.5,0 L.5,1 M.5,.5 L0,.5",Et[3]="M.5,.5 L1,.5",Et),"┿":(xt={},xt[1]="M.5,0 L.5,1",xt[3]="M0,.5 L1,.5",xt),"╀":(Rt={},Rt[1]="M0,.5 L1,.5 M.5,.5 L.5,1",Rt[3]="M.5,.5 L.5,0",Rt),"╁":(Ot={},Ot[1]="M.5,.5 L.5,0 M0,.5 L1,.5",Ot[3]="M.5,.5 L.5,1",Ot),"╂":(Mt={},Mt[1]="M0,.5 L1,.5",Mt[3]="M.5,0 L.5,1",Mt),"╃":(Tt={},Tt[1]="M0.5,1 L.5,.5 L1,.5",Tt[3]="M.5,0 L.5,.5 L0,.5",Tt),"╄":(Bt={},Bt[1]="M0,.5 L.5,.5 L.5,1",Bt[3]="M.5,0 L.5,.5 L1,.5",Bt),"╅":(Dt={},Dt[1]="M.5,0 L.5,.5 L1,.5",Dt[3]="M0,.5 L.5,.5 L.5,1",Dt),"╆":(Pt={},Pt[1]="M.5,0 L.5,.5 L0,.5",Pt[3]="M0.5,1 L.5,.5 L1,.5",Pt),"╇":(It={},It[1]="M.5,.5 L.5,1",It[3]="M.5,.5 L.5,0 M0,.5 L1,.5",It),"╈":(Ht={},Ht[1]="M.5,.5 L.5,0",Ht[3]="M0,.5 L1,.5 M.5,.5 L.5,1",Ht),"╉":(jt={},jt[1]="M.5,.5 L1,.5",jt[3]="M.5,0 L.5,1 M.5,.5 L0,.5",jt),"╊":(Ft={},Ft[1]="M.5,.5 L0,.5",Ft[3]="M.5,0 L.5,1 M.5,.5 L1,.5",Ft),"╌":(Nt={},Nt[1]="M.1,.5 L.4,.5 M.6,.5 L.9,.5",Nt),"╍":(qt={},qt[3]="M.1,.5 L.4,.5 M.6,.5 L.9,.5",qt),"┄":(Wt={},Wt[1]="M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5",Wt),"┅":(Ut={},Ut[3]="M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5",Ut),"┈":(zt={},zt[1]="M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5",zt),"┉":(Zt={},Zt[3]="M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5",Zt),"╎":(Kt={},Kt[1]="M.5,.1 L.5,.4 M.5,.6 L.5,.9",Kt),"╏":(Vt={},Vt[3]="M.5,.1 L.5,.4 M.5,.6 L.5,.9",Vt),"┆":(Gt={},Gt[1]="M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333",Gt),"┇":(Xt={},Xt[3]="M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333",Xt),"┊":(Yt={},Yt[1]="M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95",Yt),"┋":(Jt={},Jt[3]="M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95",Jt),"╭":($t={},$t[1]="C.5,1,.5,.5,1,.5",$t),"╮":(Qt={},Qt[1]="C.5,1,.5,.5,0,.5",Qt),"╯":(er={},er[1]="C.5,0,.5,.5,0,.5",er),"╰":(tr={},tr[1]="C.5,0,.5,.5,1,.5",tr)},y.powerlineDefinitions={"":{d:"M0,0 L1,.5 L0,1",type:0},"":{d:"M0,0 L1,.5 L0,1",type:1,horizontalPadding:.5},"":{d:"M1,0 L0,.5 L1,1",type:0},"":{d:"M1,0 L0,.5 L1,1",type:1,horizontalPadding:.5}},y.tryDrawCustomChar=function(u,b,x,k,B,P){var I=y.blockElementDefinitions[b];if(I)return function(u,y,b,x,k,B){for(var P=0;P<y.length;P++){var I=y[P],H=k/8,j=B/8;u.fillRect(b+I.x*H,x+I.y*j,I.w*H,I.h*j)}}(u,I,x,k,B,P),!0;var H=or[b];if(H)return function(u,y,b,x,k,B){var P,I=sr.get(y);I||(I=new Map,sr.set(y,I));var H=u.fillStyle;if("string"!=typeof H)throw Error('Unexpected fillStyle type "'+H+'"');var j=I.get(H);if(!j){var N=y[0].length,q=y.length,W=document.createElement("canvas");W.width=N,W.height=q;var U=(0,nr.throwIfFalsy)(W.getContext("2d")),z=new ImageData(N,q),K=void 0,V=void 0,G=void 0,X=void 0;if(H.startsWith("#"))K=parseInt(H.slice(1,3),16),V=parseInt(H.slice(3,5),16),G=parseInt(H.slice(5,7),16),X=H.length>7&&parseInt(H.slice(7,9),16)||1;else{if(!H.startsWith("rgba"))throw Error('Unexpected fillStyle color format "'+H+'" when drawing pattern glyph');K=(P=rr(H.substring(5,H.length-1).split(",").map((function(u){return parseFloat(u)})),4))[0],V=P[1],G=P[2],X=P[3]}for(var Y=0;Y<q;Y++)for(var J=0;J<N;J++)z.data[4*(Y*N+J)]=K,z.data[4*(Y*N+J)+1]=V,z.data[4*(Y*N+J)+2]=G,z.data[4*(Y*N+J)+3]=y[Y][J]*(255*X);U.putImageData(z,0,0),j=(0,nr.throwIfFalsy)(u.createPattern(W,null)),I.set(H,j)}u.fillStyle=j,u.fillRect(b,x,k,B)}(u,H,x,k,B,P),!0;var j=y.boxDrawingDefinitions[b];if(j)return function(u,y,b,x,k,B){var P,I,H,j;u.strokeStyle=u.fillStyle;try{for(var N=ir(Object.entries(y)),q=N.next();!q.done;q=N.next()){var W=rr(q.value,2),U=W[0],z=W[1];u.beginPath(),u.lineWidth=window.devicePixelRatio*Number.parseInt(U);var K=void 0;K="function"==typeof z?z(.15,.15/B*k):z;try{for(var V=(H=void 0,ir(K.split(" "))),G=V.next();!G.done;G=V.next()){var X=G.value,Y=X[0],J=ar[Y];if(J){var $=X.substring(1).split(",");$[0]&&$[1]&&J(u,At($,k,B,b,x))}else console.error('Could not find drawing instructions for "'+Y+'"')}}catch(u){H={error:u}}finally{try{G&&!G.done&&(j=V.return)&&j.call(V)}finally{if(H)throw H.error}}u.stroke(),u.closePath()}}catch(u){P={error:u}}finally{try{q&&!q.done&&(I=N.return)&&I.call(N)}finally{if(P)throw P.error}}}(u,j,x,k,B,P),!0;var N=y.powerlineDefinitions[b];return!!N&&(function(u,y,b,x,k,B){var P,I;u.beginPath(),u.lineWidth=window.devicePixelRatio;try{for(var H=ir(y.d.split(" ")),j=H.next();!j.done;j=H.next()){var N=j.value,q=N[0],W=ar[q];if(W){var U=N.substring(1).split(",");U[0]&&U[1]&&W(u,At(U,k,B,b,x,y.horizontalPadding))}else console.error('Could not find drawing instructions for "'+q+'"')}}catch(u){P={error:u}}finally{try{j&&!j.done&&(I=H.return)&&I.call(H)}finally{if(P)throw P.error}}1===y.type?(u.strokeStyle=u.fillStyle,u.stroke()):u.fill(),u.closePath()}(u,N,x,k,B,P),!0)};var sr=new Map;function kt(u,y,b){return void 0===b&&(b=0),Math.max(Math.min(u,y),b)}var ar={C:function(u,y){return u.bezierCurveTo(y[0],y[1],y[2],y[3],y[4],y[5])},L:function(u,y){return u.lineTo(y[0],y[1])},M:function(u,y){return u.moveTo(y[0],y[1])}};function At(u,y,b,x,k,B){void 0===B&&(B=0);var P=u.map((function(u){return parseFloat(u)||parseInt(u)}));if(P.length<2)throw Error("Too few arguments for instruction");for(var I=0;I<P.length;I+=2)P[I]*=y-2*B*window.devicePixelRatio,0!==P[I]&&(P[I]=kt(Math.round(P[I]+.5)-.5,y,0)),P[I]+=x+B*window.devicePixelRatio;for(var H=1;H<P.length;H+=2)P[H]*=b,0!==P[H]&&(P[H]=kt(Math.round(P[H]+.5)-.5,b,0)),P[H]+=k;return P}},3700:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.GridCache=void 0;var b=function(){function e(){this.cache=[]}return e.prototype.resize=function(u,y){for(var b=0;b<u;b++){this.cache.length<=b&&this.cache.push([]);for(var x=this.cache[b].length;x<y;x++)this.cache[b].push(void 0);this.cache[b].length=y}this.cache.length=u},e.prototype.clear=function(){for(var u=0;u<this.cache.length;u++)for(var y=0;y<this.cache[u].length;y++)this.cache[u][y]=void 0},e}();y.GridCache=b},5098:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.LinkRenderLayer=void 0;var I=b(1546),H=b(8803),j=b(2040),N=b(2585),q=function(u){function t(y,b,x,k,B,P,I,H,j){var N=u.call(this,y,"link",b,!0,x,k,I,H,j)||this;return B.onShowLinkUnderline((function(u){return N._onShowLinkUnderline(u)})),B.onHideLinkUnderline((function(u){return N._onHideLinkUnderline(u)})),P.onShowLinkUnderline((function(u){return N._onShowLinkUnderline(u)})),P.onHideLinkUnderline((function(u){return N._onHideLinkUnderline(u)})),N}return k(t,u),t.prototype.resize=function(y){u.prototype.resize.call(this,y),this._state=void 0},t.prototype.reset=function(){this._clearCurrentLink()},t.prototype._clearCurrentLink=function(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var u=this._state.y2-this._state.y1-1;u>0&&this._clearCells(0,this._state.y1+1,this._state.cols,u),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}},t.prototype._onShowLinkUnderline=function(u){if(u.fg===H.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._colors.background.css:u.fg&&(0,j.is256Color)(u.fg)?this._ctx.fillStyle=this._colors.ansi[u.fg].css:this._ctx.fillStyle=this._colors.foreground.css,u.y1===u.y2)this._fillBottomLineAtCells(u.x1,u.y1,u.x2-u.x1);else{this._fillBottomLineAtCells(u.x1,u.y1,u.cols-u.x1);for(var y=u.y1+1;y<u.y2;y++)this._fillBottomLineAtCells(0,y,u.cols);this._fillBottomLineAtCells(0,u.y2,u.x2)}this._state=u},t.prototype._onHideLinkUnderline=function(u){this._clearCurrentLink()},B([P(6,N.IBufferService),P(7,N.IOptionsService),P(8,N.IDecorationService)],t)}(I.BaseRenderLayer);y.LinkRenderLayer=q},3525:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}},I=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.Renderer=void 0;var H=b(9596),j=b(4149),N=b(2512),q=b(5098),W=b(844),U=b(4725),z=b(2585),K=b(1420),V=b(8460),G=1,X=function(u){function t(y,b,x,k,B,P,I,W){var U=u.call(this)||this;U._colors=y,U._screenElement=b,U._bufferService=P,U._charSizeService=I,U._optionsService=W,U._id=G++,U._onRequestRedraw=new V.EventEmitter;var z=U._optionsService.rawOptions.allowTransparency;return U._renderLayers=[B.createInstance(H.TextRenderLayer,U._screenElement,0,U._colors,z,U._id),B.createInstance(j.SelectionRenderLayer,U._screenElement,1,U._colors,U._id),B.createInstance(q.LinkRenderLayer,U._screenElement,2,U._colors,U._id,x,k),B.createInstance(N.CursorRenderLayer,U._screenElement,3,U._colors,U._id,U._onRequestRedraw)],U.dimensions={scaledCharWidth:0,scaledCharHeight:0,scaledCellWidth:0,scaledCellHeight:0,scaledCharLeft:0,scaledCharTop:0,scaledCanvasWidth:0,scaledCanvasHeight:0,canvasWidth:0,canvasHeight:0,actualCellWidth:0,actualCellHeight:0},U._devicePixelRatio=window.devicePixelRatio,U._updateDimensions(),U.onOptionsChanged(),U}return k(t,u),Object.defineProperty(t.prototype,"onRequestRedraw",{get:function(){return this._onRequestRedraw.event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){var y,b;try{for(var x=I(this._renderLayers),k=x.next();!k.done;k=x.next())k.value.dispose()}catch(u){y={error:u}}finally{try{k&&!k.done&&(b=x.return)&&b.call(x)}finally{if(y)throw y.error}}u.prototype.dispose.call(this),(0,K.removeTerminalFromCache)(this._id)},t.prototype.onDevicePixelRatioChange=function(){this._devicePixelRatio!==window.devicePixelRatio&&(this._devicePixelRatio=window.devicePixelRatio,this.onResize(this._bufferService.cols,this._bufferService.rows))},t.prototype.setColors=function(u){var y,b;this._colors=u;try{for(var x=I(this._renderLayers),k=x.next();!k.done;k=x.next()){var B=k.value;B.setColors(this._colors),B.reset()}}catch(u){y={error:u}}finally{try{k&&!k.done&&(b=x.return)&&b.call(x)}finally{if(y)throw y.error}}},t.prototype.onResize=function(u,y){var b,x;this._updateDimensions();try{for(var k=I(this._renderLayers),B=k.next();!B.done;B=k.next())B.value.resize(this.dimensions)}catch(u){b={error:u}}finally{try{B&&!B.done&&(x=k.return)&&x.call(k)}finally{if(b)throw b.error}}this._screenElement.style.width=this.dimensions.canvasWidth+"px",this._screenElement.style.height=this.dimensions.canvasHeight+"px"},t.prototype.onCharSizeChanged=function(){this.onResize(this._bufferService.cols,this._bufferService.rows)},t.prototype.onBlur=function(){this._runOperation((function(u){return u.onBlur()}))},t.prototype.onFocus=function(){this._runOperation((function(u){return u.onFocus()}))},t.prototype.onSelectionChanged=function(u,y,b){void 0===b&&(b=!1),this._runOperation((function(x){return x.onSelectionChanged(u,y,b)})),this._colors.selectionForeground&&this._onRequestRedraw.fire({start:0,end:this._bufferService.rows-1})},t.prototype.onCursorMove=function(){this._runOperation((function(u){return u.onCursorMove()}))},t.prototype.onOptionsChanged=function(){this._runOperation((function(u){return u.onOptionsChanged()}))},t.prototype.clear=function(){this._runOperation((function(u){return u.reset()}))},t.prototype._runOperation=function(u){var y,b;try{for(var x=I(this._renderLayers),k=x.next();!k.done;k=x.next())u(k.value)}catch(u){y={error:u}}finally{try{k&&!k.done&&(b=x.return)&&b.call(x)}finally{if(y)throw y.error}}},t.prototype.renderRows=function(u,y){var b,x;try{for(var k=I(this._renderLayers),B=k.next();!B.done;B=k.next())B.value.onGridChanged(u,y)}catch(u){b={error:u}}finally{try{B&&!B.done&&(x=k.return)&&x.call(k)}finally{if(b)throw b.error}}},t.prototype.clearTextureAtlas=function(){var u,y;try{for(var b=I(this._renderLayers),x=b.next();!x.done;x=b.next())x.value.clearTextureAtlas()}catch(y){u={error:y}}finally{try{x&&!x.done&&(y=b.return)&&y.call(b)}finally{if(u)throw u.error}}},t.prototype._updateDimensions=function(){this._charSizeService.hasValidSize&&(this.dimensions.scaledCharWidth=Math.floor(this._charSizeService.width*window.devicePixelRatio),this.dimensions.scaledCharHeight=Math.ceil(this._charSizeService.height*window.devicePixelRatio),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._optionsService.rawOptions.lineHeight),this.dimensions.scaledCharTop=1===this._optionsService.rawOptions.lineHeight?0:Math.round((this.dimensions.scaledCellHeight-this.dimensions.scaledCharHeight)/2),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.scaledCharLeft=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.scaledCanvasHeight=this._bufferService.rows*this.dimensions.scaledCellHeight,this.dimensions.scaledCanvasWidth=this._bufferService.cols*this.dimensions.scaledCellWidth,this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._bufferService.rows,this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._bufferService.cols)},B([P(4,z.IInstantiationService),P(5,z.IBufferService),P(6,U.ICharSizeService),P(7,z.IOptionsService)],t)}(W.Disposable);y.Renderer=X},1752:(u,y)=>{function r(u){return 57508<=u&&u<=57558}Object.defineProperty(y,"__esModule",{value:!0}),y.excludeFromContrastRatioDemands=y.isPowerlineGlyph=y.throwIfFalsy=void 0,y.throwIfFalsy=function(u){if(!u)throw Error("value must not be falsy");return u},y.isPowerlineGlyph=r,y.excludeFromContrastRatioDemands=function(u){return r(u)||function(u){return 9472<=u&&u<=9631}(u)}},4149:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.SelectionRenderLayer=void 0;var I=b(1546),H=b(2585),j=function(u){function t(y,b,x,k,B,P,I){var H=u.call(this,y,"selection",b,!0,x,k,B,P,I)||this;return H._clearState(),H}return k(t,u),t.prototype._clearState=function(){this._state={start:void 0,end:void 0,columnSelectMode:void 0,ydisp:void 0}},t.prototype.resize=function(y){u.prototype.resize.call(this,y),this._clearState()},t.prototype.reset=function(){this._state.start&&this._state.end&&(this._clearState(),this._clearAll())},t.prototype.onSelectionChanged=function(y,b,x){if(u.prototype.onSelectionChanged.call(this,y,b,x),this._didStateChange(y,b,x,this._bufferService.buffer.ydisp))if(this._clearAll(),y&&b){var k=y[1]-this._bufferService.buffer.ydisp,B=b[1]-this._bufferService.buffer.ydisp,P=Math.max(k,0),I=Math.min(B,this._bufferService.rows-1);if(P>=this._bufferService.rows||I<0)this._state.ydisp=this._bufferService.buffer.ydisp;else{if(this._ctx.fillStyle=this._colors.selectionTransparent.css,x){var H=y[0],j=b[0]-H,N=I-P+1;this._fillCells(H,P,j,N)}else{H=k===P?y[0]:0;var q=P===B?b[0]:this._bufferService.cols;this._fillCells(H,P,q-H,1);var W=Math.max(I-P-1,0);if(this._fillCells(0,P+1,this._bufferService.cols,W),P!==I){var U=B===I?b[0]:this._bufferService.cols;this._fillCells(0,I,U,1)}}this._state.start=[y[0],y[1]],this._state.end=[b[0],b[1]],this._state.columnSelectMode=x,this._state.ydisp=this._bufferService.buffer.ydisp}}else this._clearState()},t.prototype._didStateChange=function(u,y,b,x){return!this._areCoordinatesEqual(u,this._state.start)||!this._areCoordinatesEqual(y,this._state.end)||b!==this._state.columnSelectMode||x!==this._state.ydisp},t.prototype._areCoordinatesEqual=function(u,y){return!(!u||!y)&&u[0]===y[0]&&u[1]===y[1]},B([P(4,H.IBufferService),P(5,H.IOptionsService),P(6,H.IDecorationService)],t)}(I.BaseRenderLayer);y.SelectionRenderLayer=j},9596:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}},I=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.TextRenderLayer=void 0;var H=b(3700),j=b(1546),N=b(3734),q=b(643),W=b(511),U=b(2585),z=b(4725),K=b(4269),V=function(u){function t(y,b,x,k,B,P,I,j,N){var q=u.call(this,y,"text",b,k,x,B,P,I,N)||this;return q._characterJoinerService=j,q._characterWidth=0,q._characterFont="",q._characterOverlapCache={},q._workCell=new W.CellData,q._state=new H.GridCache,q}return k(t,u),t.prototype.resize=function(y){u.prototype.resize.call(this,y);var b=this._getFont(!1,!1);this._characterWidth===y.scaledCharWidth&&this._characterFont===b||(this._characterWidth=y.scaledCharWidth,this._characterFont=b,this._characterOverlapCache={}),this._state.clear(),this._state.resize(this._bufferService.cols,this._bufferService.rows)},t.prototype.reset=function(){this._state.clear(),this._clearAll()},t.prototype._forEachCell=function(u,y,b){for(var x=u;x<=y;x++)for(var k=x+this._bufferService.buffer.ydisp,B=this._bufferService.buffer.lines.get(k),P=this._characterJoinerService.getJoinedCharacters(k),I=0;I<this._bufferService.cols;I++){B.loadCell(I,this._workCell);var H=this._workCell,j=!1,N=I;if(0!==H.getWidth()){if(P.length>0&&I===P[0][0]){j=!0;var W=P.shift();H=new K.JoinedCellData(this._workCell,B.translateToString(!0,W[0],W[1]),W[1]-W[0]),N=W[1]-1}!j&&this._isOverlapping(H)&&N<B.length-1&&B.getCodePoint(N+1)===q.NULL_CELL_CODE&&(H.content&=-12582913,H.content|=2<<22),b(H,I,x),I=N}}},t.prototype._drawBackground=function(u,y){var b=this,x=this._ctx,k=this._bufferService.cols,B=0,P=0,H=null;x.save(),this._forEachCell(u,y,(function(u,y,j){var q,W,U=null;u.isInverse()?U=u.isFgDefault()?b._colors.foreground.css:u.isFgRGB()?"rgb("+N.AttributeData.toColorRGB(u.getFgColor()).join(",")+")":b._colors.ansi[u.getFgColor()].css:u.isBgRGB()?U="rgb("+N.AttributeData.toColorRGB(u.getBgColor()).join(",")+")":u.isBgPalette()&&(U=b._colors.ansi[u.getBgColor()].css);var z=!1;try{for(var K=I(b._decorationService.getDecorationsAtCell(y,b._bufferService.buffer.ydisp+j)),V=K.next();!V.done;V=K.next()){var G=V.value;"top"!==G.options.layer&&z||(G.backgroundColorRGB&&(U=G.backgroundColorRGB.css),z="top"===G.options.layer)}}catch(u){q={error:u}}finally{try{V&&!V.done&&(W=K.return)&&W.call(K)}finally{if(q)throw q.error}}null===H&&(B=y,P=j),j!==P?(x.fillStyle=H||"",b._fillCells(B,P,k-B,1),B=y,P=j):H!==U&&(x.fillStyle=H||"",b._fillCells(B,P,y-B,1),B=y,P=j),H=U})),null!==H&&(x.fillStyle=H,this._fillCells(B,P,k-B,1)),x.restore()},t.prototype._drawForeground=function(u,y){var b=this;this._forEachCell(u,y,(function(u,y,x){if(!u.isInvisible()&&(b._drawChars(u,y,x),u.isUnderline()||u.isStrikethrough())){if(b._ctx.save(),u.isInverse())if(u.isBgDefault())b._ctx.fillStyle=b._colors.background.css;else if(u.isBgRGB())b._ctx.fillStyle="rgb("+N.AttributeData.toColorRGB(u.getBgColor()).join(",")+")";else{var k=u.getBgColor();b._optionsService.rawOptions.drawBoldTextInBrightColors&&u.isBold()&&k<8&&(k+=8),b._ctx.fillStyle=b._colors.ansi[k].css}else if(u.isFgDefault())b._ctx.fillStyle=b._colors.foreground.css;else if(u.isFgRGB())b._ctx.fillStyle="rgb("+N.AttributeData.toColorRGB(u.getFgColor()).join(",")+")";else{var B=u.getFgColor();b._optionsService.rawOptions.drawBoldTextInBrightColors&&u.isBold()&&B<8&&(B+=8),b._ctx.fillStyle=b._colors.ansi[B].css}u.isStrikethrough()&&b._fillMiddleLineAtCells(y,x,u.getWidth()),u.isUnderline()&&b._fillBottomLineAtCells(y,x,u.getWidth()),b._ctx.restore()}}))},t.prototype.onGridChanged=function(u,y){0!==this._state.cache.length&&(this._charAtlas&&this._charAtlas.beginFrame(),this._clearCells(0,u,this._bufferService.cols,y-u+1),this._drawBackground(u,y),this._drawForeground(u,y))},t.prototype.onOptionsChanged=function(){this._setTransparency(this._optionsService.rawOptions.allowTransparency)},t.prototype._isOverlapping=function(u){if(1!==u.getWidth())return!1;if(u.getCode()<256)return!1;var y=u.getChars();if(this._characterOverlapCache.hasOwnProperty(y))return this._characterOverlapCache[y];this._ctx.save(),this._ctx.font=this._characterFont;var b=Math.floor(this._ctx.measureText(y).width)>this._characterWidth;return this._ctx.restore(),this._characterOverlapCache[y]=b,b},B([P(5,U.IBufferService),P(6,U.IOptionsService),P(7,z.ICharacterJoinerService),P(8,U.IDecorationService)],t)}(j.BaseRenderLayer);y.TextRenderLayer=V},9616:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.BaseCharAtlas=void 0;var b=function(){function e(){this._didWarmUp=!1}return e.prototype.dispose=function(){},e.prototype.warmUp=function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)},e.prototype._doWarmUp=function(){},e.prototype.clear=function(){},e.prototype.beginFrame=function(){},e}();y.BaseCharAtlas=b},1420:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.removeTerminalFromCache=y.acquireCharAtlas=void 0;var x=b(2040),k=b(1906),B=[];y.acquireCharAtlas=function(u,y,b,P,I){for(var H=(0,x.generateConfig)(P,I,u,b),j=0;j<B.length;j++){var N=(q=B[j]).ownedBy.indexOf(y);if(N>=0){if((0,x.configEquals)(q.config,H))return q.atlas;1===q.ownedBy.length?(q.atlas.dispose(),B.splice(j,1)):q.ownedBy.splice(N,1);break}}for(j=0;j<B.length;j++){var q=B[j];if((0,x.configEquals)(q.config,H))return q.ownedBy.push(y),q.atlas}var W={atlas:new k.DynamicCharAtlas(document,H),config:H,ownedBy:[y]};return B.push(W),W.atlas},y.removeTerminalFromCache=function(u){for(var y=0;y<B.length;y++){var b=B[y].ownedBy.indexOf(u);if(-1!==b){1===B[y].ownedBy.length?(B[y].atlas.dispose(),B.splice(y,1)):B[y].ownedBy.splice(b,1);break}}}},2040:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.is256Color=y.configEquals=y.generateConfig=void 0;var x=b(643);y.generateConfig=function(u,y,b,x){var k={foreground:x.foreground,background:x.background,cursor:void 0,cursorAccent:void 0,selection:void 0,ansi:x.ansi.slice()};return{devicePixelRatio:window.devicePixelRatio,scaledCharWidth:u,scaledCharHeight:y,fontFamily:b.fontFamily,fontSize:b.fontSize,fontWeight:b.fontWeight,fontWeightBold:b.fontWeightBold,allowTransparency:b.allowTransparency,colors:k}},y.configEquals=function(u,y){for(var b=0;b<u.colors.ansi.length;b++)if(u.colors.ansi[b].rgba!==y.colors.ansi[b].rgba)return!1;return u.devicePixelRatio===y.devicePixelRatio&&u.fontFamily===y.fontFamily&&u.fontSize===y.fontSize&&u.fontWeight===y.fontWeight&&u.fontWeightBold===y.fontWeightBold&&u.allowTransparency===y.allowTransparency&&u.scaledCharWidth===y.scaledCharWidth&&u.scaledCharHeight===y.scaledCharHeight&&u.colors.foreground===y.colors.foreground&&u.colors.background===y.colors.background},y.is256Color=function(u){return u<x.DEFAULT_COLOR}},8803:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.CHAR_ATLAS_CELL_SPACING=y.TEXT_BASELINE=y.DIM_OPACITY=y.INVERTED_DEFAULT_COLOR=void 0;var x=b(6114);y.INVERTED_DEFAULT_COLOR=257,y.DIM_OPACITY=.5,y.TEXT_BASELINE=x.isFirefox||x.isLegacyEdge?"bottom":"ideographic",y.CHAR_ATLAS_CELL_SPACING=1},1906:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)});Object.defineProperty(y,"__esModule",{value:!0}),y.NoneCharAtlas=y.DynamicCharAtlas=y.getGlyphCacheKey=void 0;var B=b(8803),P=b(9616),I=b(5680),H=b(7001),j=b(6114),N=b(1752),q=b(8055),W=1024,U=1024,z={css:"rgba(0, 0, 0, 0)",rgba:0};function p(u){return u.code<<21|u.bg<<12|u.fg<<3|(u.bold?0:4)+(u.dim?0:2)+(u.italic?0:1)}y.getGlyphCacheKey=p;var K=function(u){function t(y,b){var x=u.call(this)||this;x._config=b,x._drawToCacheCount=0,x._glyphsWaitingOnBitmap=[],x._bitmapCommitTimeout=null,x._bitmap=null,x._cacheCanvas=y.createElement("canvas"),x._cacheCanvas.width=W,x._cacheCanvas.height=U,x._cacheCtx=(0,N.throwIfFalsy)(x._cacheCanvas.getContext("2d",{alpha:!0}));var k=y.createElement("canvas");k.width=x._config.scaledCharWidth,k.height=x._config.scaledCharHeight,x._tmpCtx=(0,N.throwIfFalsy)(k.getContext("2d",{alpha:x._config.allowTransparency})),x._width=Math.floor(W/x._config.scaledCharWidth),x._height=Math.floor(U/x._config.scaledCharHeight);var B=x._width*x._height;return x._cacheMap=new H.LRUMap(B),x._cacheMap.prealloc(B),x}return k(t,u),t.prototype.dispose=function(){null!==this._bitmapCommitTimeout&&(window.clearTimeout(this._bitmapCommitTimeout),this._bitmapCommitTimeout=null)},t.prototype.beginFrame=function(){this._drawToCacheCount=0},t.prototype.clear=function(){if(this._cacheMap.size>0){var u=this._width*this._height;this._cacheMap=new H.LRUMap(u),this._cacheMap.prealloc(u)}this._cacheCtx.clearRect(0,0,W,U),this._tmpCtx.clearRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight)},t.prototype.draw=function(u,y,b,x){if(32===y.code)return!0;if(!this._canCache(y))return!1;var k=p(y),B=this._cacheMap.get(k);if(null!=B)return this._drawFromCache(u,B,b,x),!0;if(this._drawToCacheCount<100){var P;P=this._cacheMap.size<this._cacheMap.capacity?this._cacheMap.size:this._cacheMap.peek().index;var I=this._drawToCache(y,P);return this._cacheMap.set(k,I),this._drawFromCache(u,I,b,x),!0}return!1},t.prototype._canCache=function(u){return u.code<256},t.prototype._toCoordinateX=function(u){return u%this._width*this._config.scaledCharWidth},t.prototype._toCoordinateY=function(u){return Math.floor(u/this._width)*this._config.scaledCharHeight},t.prototype._drawFromCache=function(u,y,b,x){if(!y.isEmpty){var k=this._toCoordinateX(y.index),B=this._toCoordinateY(y.index);u.drawImage(y.inBitmap?this._bitmap:this._cacheCanvas,k,B,this._config.scaledCharWidth,this._config.scaledCharHeight,b,x,this._config.scaledCharWidth,this._config.scaledCharHeight)}},t.prototype._getColorFromAnsiIndex=function(u){return u<this._config.colors.ansi.length?this._config.colors.ansi[u]:I.DEFAULT_ANSI_COLORS[u]},t.prototype._getBackgroundColor=function(u){return this._config.allowTransparency?z:u.bg===B.INVERTED_DEFAULT_COLOR?this._config.colors.foreground:u.bg<256?this._getColorFromAnsiIndex(u.bg):this._config.colors.background},t.prototype._getForegroundColor=function(u){return u.fg===B.INVERTED_DEFAULT_COLOR?q.color.opaque(this._config.colors.background):u.fg<256?this._getColorFromAnsiIndex(u.fg):this._config.colors.foreground},t.prototype._drawToCache=function(u,y){this._drawToCacheCount++,this._tmpCtx.save();var b=this._getBackgroundColor(u);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=b.css,this._tmpCtx.fillRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),this._tmpCtx.globalCompositeOperation="source-over";var x=u.bold?this._config.fontWeightBold:this._config.fontWeight,k=u.italic?"italic":"";this._tmpCtx.font=k+" "+x+" "+this._config.fontSize*this._config.devicePixelRatio+"px "+this._config.fontFamily,this._tmpCtx.textBaseline=B.TEXT_BASELINE,this._tmpCtx.fillStyle=this._getForegroundColor(u).css,u.dim&&(this._tmpCtx.globalAlpha=B.DIM_OPACITY),this._tmpCtx.fillText(u.chars,0,this._config.scaledCharHeight);var P=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),I=!1;if(this._config.allowTransparency||(I=g(P,b)),I&&"_"===u.chars&&!this._config.allowTransparency)for(var H=1;H<=5&&(this._tmpCtx.fillText(u.chars,0,this._config.scaledCharHeight-H),I=g(P=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),b));H++);this._tmpCtx.restore();var j=this._toCoordinateX(y),N=this._toCoordinateY(y);this._cacheCtx.putImageData(P,j,N);var q={index:y,isEmpty:I,inBitmap:!1};return this._addGlyphToBitmap(q),q},t.prototype._addGlyphToBitmap=function(u){var y=this;!("createImageBitmap"in window)||j.isFirefox||j.isSafari||(this._glyphsWaitingOnBitmap.push(u),null===this._bitmapCommitTimeout&&(this._bitmapCommitTimeout=window.setTimeout((function(){return y._generateBitmap()}),100)))},t.prototype._generateBitmap=function(){var u=this,y=this._glyphsWaitingOnBitmap;this._glyphsWaitingOnBitmap=[],window.createImageBitmap(this._cacheCanvas).then((function(b){u._bitmap=b;for(var x=0;x<y.length;x++)y[x].inBitmap=!0})),this._bitmapCommitTimeout=null},t}(P.BaseCharAtlas);y.DynamicCharAtlas=K;var V=function(u){function t(y,b){return u.call(this)||this}return k(t,u),t.prototype.draw=function(u,y,b,x){return!1},t}(P.BaseCharAtlas);function g(u,y){for(var b=!0,x=y.rgba>>>24,k=y.rgba>>>16&255,B=y.rgba>>>8&255,P=0;P<u.data.length;P+=4)u.data[P]===x&&u.data[P+1]===k&&u.data[P+2]===B?u.data[P+3]=0:b=!1;return b}y.NoneCharAtlas=V},7001:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.LRUMap=void 0;var b=function(){function e(u){this.capacity=u,this._map={},this._head=null,this._tail=null,this._nodePool=[],this.size=0}return e.prototype._unlinkNode=function(u){var y=u.prev,b=u.next;u===this._head&&(this._head=b),u===this._tail&&(this._tail=y),null!==y&&(y.next=b),null!==b&&(b.prev=y)},e.prototype._appendNode=function(u){var y=this._tail;null!==y&&(y.next=u),u.prev=y,u.next=null,this._tail=u,null===this._head&&(this._head=u)},e.prototype.prealloc=function(u){for(var y=this._nodePool,b=0;b<u;b++)y.push({prev:null,next:null,key:null,value:null})},e.prototype.get=function(u){var y=this._map[u];return void 0!==y?(this._unlinkNode(y),this._appendNode(y),y.value):null},e.prototype.peekValue=function(u){var y=this._map[u];return void 0!==y?y.value:null},e.prototype.peek=function(){var u=this._head;return null===u?null:u.value},e.prototype.set=function(u,y){var b=this._map[u];if(void 0!==b)b=this._map[u],this._unlinkNode(b),b.value=y;else if(this.size>=this.capacity)b=this._head,this._unlinkNode(b),delete this._map[b.key],b.key=u,b.value=y,this._map[u]=b;else{var x=this._nodePool;x.length>0?((b=x.pop()).key=u,b.value=y):b={prev:null,next:null,key:u,value:y},this._map[u]=b,this.size++}this._appendNode(b)},e}();y.LRUMap=b},1296:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}},I=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.DomRenderer=void 0;var H=b(3787),j=b(8803),N=b(844),q=b(4725),W=b(2585),U=b(8460),z=b(8055),K=b(9631),V="xterm-dom-renderer-owner-",G="xterm-fg-",X="xterm-bg-",Y="xterm-focus",J=1,$=function(u){function t(y,b,x,k,B,P,I,j,N,q){var W=u.call(this)||this;return W._colors=y,W._element=b,W._screenElement=x,W._viewportElement=k,W._linkifier=B,W._linkifier2=P,W._charSizeService=j,W._optionsService=N,W._bufferService=q,W._terminalClass=J++,W._rowElements=[],W._rowContainer=document.createElement("div"),W._rowContainer.classList.add("xterm-rows"),W._rowContainer.style.lineHeight="normal",W._rowContainer.setAttribute("aria-hidden","true"),W._refreshRowElements(W._bufferService.cols,W._bufferService.rows),W._selectionContainer=document.createElement("div"),W._selectionContainer.classList.add("xterm-selection"),W._selectionContainer.setAttribute("aria-hidden","true"),W.dimensions={scaledCharWidth:0,scaledCharHeight:0,scaledCellWidth:0,scaledCellHeight:0,scaledCharLeft:0,scaledCharTop:0,scaledCanvasWidth:0,scaledCanvasHeight:0,canvasWidth:0,canvasHeight:0,actualCellWidth:0,actualCellHeight:0},W._updateDimensions(),W._injectCss(),W._rowFactory=I.createInstance(H.DomRendererRowFactory,document,W._colors),W._element.classList.add(V+W._terminalClass),W._screenElement.appendChild(W._rowContainer),W._screenElement.appendChild(W._selectionContainer),W.register(W._linkifier.onShowLinkUnderline((function(u){return W._onLinkHover(u)}))),W.register(W._linkifier.onHideLinkUnderline((function(u){return W._onLinkLeave(u)}))),W.register(W._linkifier2.onShowLinkUnderline((function(u){return W._onLinkHover(u)}))),W.register(W._linkifier2.onHideLinkUnderline((function(u){return W._onLinkLeave(u)}))),W}return k(t,u),Object.defineProperty(t.prototype,"onRequestRedraw",{get:function(){return(new U.EventEmitter).event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._element.classList.remove(V+this._terminalClass),(0,K.removeElementFromParent)(this._rowContainer,this._selectionContainer,this._themeStyleElement,this._dimensionsStyleElement),u.prototype.dispose.call(this)},t.prototype._updateDimensions=function(){var u,y;this.dimensions.scaledCharWidth=this._charSizeService.width*window.devicePixelRatio,this.dimensions.scaledCharHeight=Math.ceil(this._charSizeService.height*window.devicePixelRatio),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._optionsService.rawOptions.lineHeight),this.dimensions.scaledCharLeft=0,this.dimensions.scaledCharTop=0,this.dimensions.scaledCanvasWidth=this.dimensions.scaledCellWidth*this._bufferService.cols,this.dimensions.scaledCanvasHeight=this.dimensions.scaledCellHeight*this._bufferService.rows,this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._bufferService.cols,this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._bufferService.rows;try{for(var b=I(this._rowElements),x=b.next();!x.done;x=b.next()){var k=x.value;k.style.width=this.dimensions.canvasWidth+"px",k.style.height=this.dimensions.actualCellHeight+"px",k.style.lineHeight=this.dimensions.actualCellHeight+"px",k.style.overflow="hidden"}}catch(y){u={error:y}}finally{try{x&&!x.done&&(y=b.return)&&y.call(b)}finally{if(u)throw u.error}}this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));var B=this._terminalSelector+" .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: "+this.dimensions.actualCellWidth+"px}";this._dimensionsStyleElement.textContent=B,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=this.dimensions.canvasWidth+"px",this._screenElement.style.height=this.dimensions.canvasHeight+"px"},t.prototype.setColors=function(u){this._colors=u,this._injectCss()},t.prototype._injectCss=function(){var u=this;this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));var y=this._terminalSelector+" .xterm-rows { color: "+this._colors.foreground.css+"; font-family: "+this._optionsService.rawOptions.fontFamily+"; font-size: "+this._optionsService.rawOptions.fontSize+"px;}";y+=this._terminalSelector+" span:not(."+H.BOLD_CLASS+") { font-weight: "+this._optionsService.rawOptions.fontWeight+";}"+this._terminalSelector+" span."+H.BOLD_CLASS+" { font-weight: "+this._optionsService.rawOptions.fontWeightBold+";}"+this._terminalSelector+" span."+H.ITALIC_CLASS+" { font-style: italic;}",y+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",y+="@keyframes blink_block_"+this._terminalClass+" { 0% {  background-color: "+this._colors.cursor.css+";  color: "+this._colors.cursorAccent.css+"; } 50% {  background-color: "+this._colors.cursorAccent.css+";  color: "+this._colors.cursor.css+"; }}",y+=this._terminalSelector+" .xterm-rows:not(.xterm-focus) ."+H.CURSOR_CLASS+"."+H.CURSOR_STYLE_BLOCK_CLASS+" { outline: 1px solid "+this._colors.cursor.css+"; outline-offset: -1px;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+H.CURSOR_CLASS+"."+H.CURSOR_BLINK_CLASS+":not(."+H.CURSOR_STYLE_BLOCK_CLASS+") { animation: blink_box_shadow_"+this._terminalClass+" 1s step-end infinite;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+H.CURSOR_CLASS+"."+H.CURSOR_BLINK_CLASS+"."+H.CURSOR_STYLE_BLOCK_CLASS+" { animation: blink_block_"+this._terminalClass+" 1s step-end infinite;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+H.CURSOR_CLASS+"."+H.CURSOR_STYLE_BLOCK_CLASS+" { background-color: "+this._colors.cursor.css+"; color: "+this._colors.cursorAccent.css+";}"+this._terminalSelector+" .xterm-rows ."+H.CURSOR_CLASS+"."+H.CURSOR_STYLE_BAR_CLASS+" { box-shadow: "+this._optionsService.rawOptions.cursorWidth+"px 0 0 "+this._colors.cursor.css+" inset;}"+this._terminalSelector+" .xterm-rows ."+H.CURSOR_CLASS+"."+H.CURSOR_STYLE_UNDERLINE_CLASS+" { box-shadow: 0 -1px 0 "+this._colors.cursor.css+" inset;}",y+=this._terminalSelector+" .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}"+this._terminalSelector+" .xterm-selection div { position: absolute; background-color: "+this._colors.selectionOpaque.css+";}",this._colors.ansi.forEach((function(b,x){y+=u._terminalSelector+" ."+G+x+" { color: "+b.css+"; }"+u._terminalSelector+" ."+X+x+" { background-color: "+b.css+"; }"})),y+=this._terminalSelector+" ."+G+j.INVERTED_DEFAULT_COLOR+" { color: "+z.color.opaque(this._colors.background).css+"; }"+this._terminalSelector+" ."+X+j.INVERTED_DEFAULT_COLOR+" { background-color: "+this._colors.foreground.css+"; }",this._themeStyleElement.textContent=y},t.prototype.onDevicePixelRatioChange=function(){this._updateDimensions()},t.prototype._refreshRowElements=function(u,y){for(var b=this._rowElements.length;b<=y;b++){var x=document.createElement("div");this._rowContainer.appendChild(x),this._rowElements.push(x)}for(;this._rowElements.length>y;)this._rowContainer.removeChild(this._rowElements.pop())},t.prototype.onResize=function(u,y){this._refreshRowElements(u,y),this._updateDimensions()},t.prototype.onCharSizeChanged=function(){this._updateDimensions()},t.prototype.onBlur=function(){this._rowContainer.classList.remove(Y)},t.prototype.onFocus=function(){this._rowContainer.classList.add(Y)},t.prototype.onSelectionChanged=function(u,y,b){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.onSelectionChanged(u,y,b),this.renderRows(0,this._bufferService.rows-1),u&&y){var x=u[1]-this._bufferService.buffer.ydisp,k=y[1]-this._bufferService.buffer.ydisp,B=Math.max(x,0),P=Math.min(k,this._bufferService.rows-1);if(!(B>=this._bufferService.rows||P<0)){var I=document.createDocumentFragment();if(b){var H=u[0]>y[0];I.appendChild(this._createSelectionElement(B,H?y[0]:u[0],H?u[0]:y[0],P-B+1))}else{var j=x===B?u[0]:0,N=B===k?y[0]:this._bufferService.cols;I.appendChild(this._createSelectionElement(B,j,N));var q=P-B-1;if(I.appendChild(this._createSelectionElement(B+1,0,this._bufferService.cols,q)),B!==P){var W=k===P?y[0]:this._bufferService.cols;I.appendChild(this._createSelectionElement(P,0,W))}}this._selectionContainer.appendChild(I)}}},t.prototype._createSelectionElement=function(u,y,b,x){void 0===x&&(x=1);var k=document.createElement("div");return k.style.height=x*this.dimensions.actualCellHeight+"px",k.style.top=u*this.dimensions.actualCellHeight+"px",k.style.left=y*this.dimensions.actualCellWidth+"px",k.style.width=this.dimensions.actualCellWidth*(b-y)+"px",k},t.prototype.onCursorMove=function(){},t.prototype.onOptionsChanged=function(){this._updateDimensions(),this._injectCss()},t.prototype.clear=function(){var u,y;try{for(var b=I(this._rowElements),x=b.next();!x.done;x=b.next())x.value.innerText=""}catch(y){u={error:y}}finally{try{x&&!x.done&&(y=b.return)&&y.call(b)}finally{if(u)throw u.error}}},t.prototype.renderRows=function(u,y){for(var b=this._bufferService.buffer.ybase+this._bufferService.buffer.y,x=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),k=this._optionsService.rawOptions.cursorBlink,B=u;B<=y;B++){var P=this._rowElements[B];P.innerText="";var I=B+this._bufferService.buffer.ydisp,H=this._bufferService.buffer.lines.get(I),j=this._optionsService.rawOptions.cursorStyle;P.appendChild(this._rowFactory.createRow(H,I,I===b,j,x,k,this.dimensions.actualCellWidth,this._bufferService.cols))}},Object.defineProperty(t.prototype,"_terminalSelector",{get:function(){return"."+V+this._terminalClass},enumerable:!1,configurable:!0}),t.prototype._onLinkHover=function(u){this._setCellUnderline(u.x1,u.x2,u.y1,u.y2,u.cols,!0)},t.prototype._onLinkLeave=function(u){this._setCellUnderline(u.x1,u.x2,u.y1,u.y2,u.cols,!1)},t.prototype._setCellUnderline=function(u,y,b,x,k,B){for(;u!==y||b!==x;){var P=this._rowElements[b];if(!P)return;var I=P.children[u];I&&(I.style.textDecoration=B?"underline":"none"),++u>=k&&(u=0,b++)}},B([P(6,W.IInstantiationService),P(7,q.ICharSizeService),P(8,W.IOptionsService),P(9,W.IBufferService)],t)}(N.Disposable);y.DomRenderer=$},3787:function(u,y,b){var x=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},k=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}},B=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.DomRendererRowFactory=y.CURSOR_STYLE_UNDERLINE_CLASS=y.CURSOR_STYLE_BAR_CLASS=y.CURSOR_STYLE_BLOCK_CLASS=y.CURSOR_BLINK_CLASS=y.CURSOR_CLASS=y.STRIKETHROUGH_CLASS=y.UNDERLINE_CLASS=y.ITALIC_CLASS=y.DIM_CLASS=y.BOLD_CLASS=void 0;var P=b(8803),I=b(643),H=b(511),j=b(2585),N=b(8055),q=b(4725),W=b(4269),U=b(1752);y.BOLD_CLASS="xterm-bold",y.DIM_CLASS="xterm-dim",y.ITALIC_CLASS="xterm-italic",y.UNDERLINE_CLASS="xterm-underline",y.STRIKETHROUGH_CLASS="xterm-strikethrough",y.CURSOR_CLASS="xterm-cursor",y.CURSOR_BLINK_CLASS="xterm-cursor-blink",y.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",y.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",y.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";var z=function(){function e(u,y,b,x,k,B){this._document=u,this._colors=y,this._characterJoinerService=b,this._optionsService=x,this._coreService=k,this._decorationService=B,this._workCell=new H.CellData,this._columnSelectMode=!1}return e.prototype.setColors=function(u){this._colors=u},e.prototype.onSelectionChanged=function(u,y,b){this._selectionStart=u,this._selectionEnd=y,this._columnSelectMode=b},e.prototype.createRow=function(u,b,x,k,H,j,q,U){for(var z,K,V=this._document.createDocumentFragment(),G=this._characterJoinerService.getJoinedCharacters(b),X=0,Y=Math.min(u.length,U)-1;Y>=0;Y--)if(u.loadCell(Y,this._workCell).getCode()!==I.NULL_CELL_CODE||x&&Y===H){X=Y+1;break}for(Y=0;Y<X;Y++){u.loadCell(Y,this._workCell);var J=this._workCell.getWidth();if(0!==J){var $=!1,Q=Y,ee=this._workCell;if(G.length>0&&Y===G[0][0]){$=!0;var te=G.shift();ee=new W.JoinedCellData(this._workCell,u.translateToString(!0,te[0],te[1]),te[1]-te[0]),Q=te[1]-1,J=ee.getWidth()}var re=this._document.createElement("span");if(J>1&&(re.style.width=q*J+"px"),$&&(re.style.display="inline",H>=Y&&H<=Q&&(H=Y)),!this._coreService.isCursorHidden&&x&&Y===H)switch(re.classList.add(y.CURSOR_CLASS),j&&re.classList.add(y.CURSOR_BLINK_CLASS),k){case"bar":re.classList.add(y.CURSOR_STYLE_BAR_CLASS);break;case"underline":re.classList.add(y.CURSOR_STYLE_UNDERLINE_CLASS);break;default:re.classList.add(y.CURSOR_STYLE_BLOCK_CLASS)}ee.isBold()&&re.classList.add(y.BOLD_CLASS),ee.isItalic()&&re.classList.add(y.ITALIC_CLASS),ee.isDim()&&re.classList.add(y.DIM_CLASS),ee.isUnderline()&&re.classList.add(y.UNDERLINE_CLASS),ee.isInvisible()?re.textContent=I.WHITESPACE_CELL_CHAR:re.textContent=ee.getChars()||I.WHITESPACE_CELL_CHAR,ee.isStrikethrough()&&re.classList.add(y.STRIKETHROUGH_CLASS);var ie=ee.getFgColor(),ne=ee.getFgColorMode(),oe=ee.getBgColor(),se=ee.getBgColorMode(),ae=!!ee.isInverse();if(ae){var ce=ie;ie=oe,oe=ce;var le=ne;ne=se,se=le}var he=void 0,ue=void 0,fe=!1;try{for(var _e=(z=void 0,B(this._decorationService.getDecorationsAtCell(Y,b))),de=_e.next();!de.done;de=_e.next()){var pe=de.value;"top"!==pe.options.layer&&fe||(pe.backgroundColorRGB&&(se=50331648,oe=pe.backgroundColorRGB.rgba>>8&16777215,he=pe.backgroundColorRGB),pe.foregroundColorRGB&&(ne=50331648,ie=pe.foregroundColorRGB.rgba>>8&16777215,ue=pe.foregroundColorRGB),fe="top"===pe.options.layer)}}catch(u){z={error:u}}finally{try{de&&!de.done&&(K=_e.return)&&K.call(_e)}finally{if(z)throw z.error}}var ve=this._isCellInSelection(Y,b);fe||this._colors.selectionForeground&&ve&&(ne=50331648,ie=this._colors.selectionForeground.rgba>>8&16777215,ue=this._colors.selectionForeground),ve&&(he=this._colors.selectionOpaque,fe=!0),fe&&re.classList.add("xterm-decoration-top");var ye=void 0;switch(se){case 16777216:case 33554432:ye=this._colors.ansi[oe],re.classList.add("xterm-bg-"+oe);break;case 50331648:ye=N.rgba.toColor(oe>>16,oe>>8&255,255&oe),this._addStyle(re,"background-color:#"+p((oe>>>0).toString(16),"0",6));break;default:ae?(ye=this._colors.foreground,re.classList.add("xterm-bg-"+P.INVERTED_DEFAULT_COLOR)):ye=this._colors.background}switch(ne){case 16777216:case 33554432:ee.isBold()&&ie<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(ie+=8),this._applyMinimumContrast(re,ye,this._colors.ansi[ie],ee,he,void 0)||re.classList.add("xterm-fg-"+ie);break;case 50331648:var ge=N.rgba.toColor(ie>>16&255,ie>>8&255,255&ie);this._applyMinimumContrast(re,ye,ge,ee,he,ue)||this._addStyle(re,"color:#"+p(ie.toString(16),"0",6));break;default:this._applyMinimumContrast(re,ye,this._colors.foreground,ee,he,void 0)||ae&&re.classList.add("xterm-fg-"+P.INVERTED_DEFAULT_COLOR)}V.appendChild(re),Y=Q}}return V},e.prototype._applyMinimumContrast=function(u,y,b,x,k,B){if(1===this._optionsService.rawOptions.minimumContrastRatio||(0,U.excludeFromContrastRatioDemands)(x.getCode()))return!1;var P=void 0;return k||B||(P=this._colors.contrastCache.getColor(y.rgba,b.rgba)),void 0===P&&(P=N.color.ensureContrastRatio(k||y,B||b,this._optionsService.rawOptions.minimumContrastRatio),this._colors.contrastCache.setColor((k||y).rgba,(B||b).rgba,null!=P?P:null)),!!P&&(this._addStyle(u,"color:"+P.css),!0)},e.prototype._addStyle=function(u,y){u.setAttribute("style",""+(u.getAttribute("style")||"")+y+";")},e.prototype._isCellInSelection=function(u,y){var b=this._selectionStart,x=this._selectionEnd;return!(!b||!x)&&(this._columnSelectMode?b[0]<=x[0]?u>=b[0]&&y>=b[1]&&u<x[0]&&y<=x[1]:u<b[0]&&y>=b[1]&&u>=x[0]&&y<=x[1]:y>b[1]&&y<x[1]||b[1]===x[1]&&y===b[1]&&u>=b[0]&&u<x[0]||b[1]<x[1]&&y===x[1]&&u<x[0]||b[1]<x[1]&&y===b[1]&&u>=b[0])},x([k(2,q.ICharacterJoinerService),k(3,j.IOptionsService),k(4,j.ICoreService),k(5,j.IDecorationService)],e)}();function p(u,y,b){for(;u.length<b;)u=y+u;return u}y.DomRendererRowFactory=z},456:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.SelectionModel=void 0;var b=function(){function e(u){this._bufferService=u,this.isSelectAllActive=!1,this.selectionStartLength=0}return e.prototype.clearSelection=function(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0},Object.defineProperty(e.prototype,"finalSelectionStart",{get:function(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"finalSelectionEnd",{get:function(){return this.isSelectAllActive?[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1]:this.selectionStart?!this.selectionEnd||this.areSelectionValuesReversed()?(u=this.selectionStart[0]+this.selectionStartLength)>this._bufferService.cols?u%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)-1]:[u%this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)]:[u,this.selectionStart[1]]:this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]?(u=this.selectionStart[0]+this.selectionStartLength)>this._bufferService.cols?[u%this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)]:[Math.max(u,this.selectionEnd[0]),this.selectionEnd[1]]:this.selectionEnd:void 0;var u},enumerable:!1,configurable:!0}),e.prototype.areSelectionValuesReversed=function(){var u=this.selectionStart,y=this.selectionEnd;return!(!u||!y)&&(u[1]>y[1]||u[1]===y[1]&&u[0]>y[0])},e.prototype.onTrim=function(u){return this.selectionStart&&(this.selectionStart[1]-=u),this.selectionEnd&&(this.selectionEnd[1]-=u),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)},e}();y.SelectionModel=b},428:function(u,y,b){var x=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},k=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.CharSizeService=void 0;var B=b(2585),P=b(8460),I=function(){function e(u,y,b){this._optionsService=b,this.width=0,this.height=0,this._onCharSizeChange=new P.EventEmitter,this._measureStrategy=new H(u,y,this._optionsService)}return Object.defineProperty(e.prototype,"hasValidSize",{get:function(){return this.width>0&&this.height>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCharSizeChange",{get:function(){return this._onCharSizeChange.event},enumerable:!1,configurable:!0}),e.prototype.measure=function(){var u=this._measureStrategy.measure();u.width===this.width&&u.height===this.height||(this.width=u.width,this.height=u.height,this._onCharSizeChange.fire())},x([k(2,B.IOptionsService)],e)}();y.CharSizeService=I;var H=function(){function e(u,y,b){this._document=u,this._parentElement=y,this._optionsService=b,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}return e.prototype.measure=function(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=this._optionsService.rawOptions.fontSize+"px";var u=this._measureElement.getBoundingClientRect();return 0!==u.width&&0!==u.height&&(this._result.width=u.width,this._result.height=Math.ceil(u.height)),this._result},e}()},4269:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.CharacterJoinerService=y.JoinedCellData=void 0;var I=b(3734),H=b(643),j=b(511),N=b(2585),q=function(u){function t(y,b,x){var k=u.call(this)||this;return k.content=0,k.combinedData="",k.fg=y.fg,k.bg=y.bg,k.combinedData=b,k._width=x,k}return k(t,u),t.prototype.isCombined=function(){return 2097152},t.prototype.getWidth=function(){return this._width},t.prototype.getChars=function(){return this.combinedData},t.prototype.getCode=function(){return 2097151},t.prototype.setFromCharData=function(u){throw Error("not implemented")},t.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},t}(I.AttributeData);y.JoinedCellData=q;var W=function(){function e(u){this._bufferService=u,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new j.CellData}return e.prototype.register=function(u){var y={id:this._nextCharacterJoinerId++,handler:u};return this._characterJoiners.push(y),y.id},e.prototype.deregister=function(u){for(var y=0;y<this._characterJoiners.length;y++)if(this._characterJoiners[y].id===u)return this._characterJoiners.splice(y,1),!0;return!1},e.prototype.getJoinedCharacters=function(u){if(0===this._characterJoiners.length)return[];var y=this._bufferService.buffer.lines.get(u);if(!y||0===y.length)return[];for(var b=[],x=y.translateToString(!0),k=0,B=0,P=0,I=y.getFg(0),j=y.getBg(0),N=0;N<y.getTrimmedLength();N++)if(y.loadCell(N,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==I||this._workCell.bg!==j){if(N-k>1)for(var q=this._getJoinedRanges(x,P,B,y,k),W=0;W<q.length;W++)b.push(q[W]);k=N,P=B,I=this._workCell.fg,j=this._workCell.bg}B+=this._workCell.getChars().length||H.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-k>1)for(q=this._getJoinedRanges(x,P,B,y,k),W=0;W<q.length;W++)b.push(q[W]);return b},e.prototype._getJoinedRanges=function(u,y,b,x,k){var B=u.substring(y,b),P=[];try{P=this._characterJoiners[0].handler(B)}catch(u){console.error(u)}for(var I=1;I<this._characterJoiners.length;I++)try{for(var H=this._characterJoiners[I].handler(B),j=0;j<H.length;j++)e._mergeRanges(P,H[j])}catch(u){console.error(u)}return this._stringRangesToCellRanges(P,x,k),P},e.prototype._stringRangesToCellRanges=function(u,y,b){var x=0,k=!1,B=0,P=u[x];if(P){for(var I=b;I<this._bufferService.cols;I++){var j=y.getWidth(I),N=y.getString(I).length||H.WHITESPACE_CELL_CHAR.length;if(0!==j){if(!k&&P[0]<=B&&(P[0]=I,k=!0),P[1]<=B){if(P[1]=I,!(P=u[++x]))break;P[0]<=B?(P[0]=I,k=!0):k=!1}B+=N}}P&&(P[1]=this._bufferService.cols)}},e._mergeRanges=function(u,y){for(var b=!1,x=0;x<u.length;x++){var k=u[x];if(b){if(y[1]<=k[0])return u[x-1][1]=y[1],u;if(y[1]<=k[1])return u[x-1][1]=Math.max(y[1],k[1]),u.splice(x,1),u;u.splice(x,1),x--}else{if(y[1]<=k[0])return u.splice(x,0,y),u;if(y[1]<=k[1])return k[0]=Math.min(y[0],k[0]),u;y[0]<k[1]&&(k[0]=Math.min(y[0],k[0]),b=!0)}}return b?u[u.length-1][1]=y[1]:u.push(y),u},e=B([P(0,N.IBufferService)],e)}();y.CharacterJoinerService=W},5114:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.CoreBrowserService=void 0;var b=function(){function e(u){this._textarea=u}return Object.defineProperty(e.prototype,"isFocused",{get:function(){return(this._textarea.getRootNode?this._textarea.getRootNode():document).activeElement===this._textarea&&document.hasFocus()},enumerable:!1,configurable:!0}),e}();y.CoreBrowserService=b},8934:function(u,y,b){var x=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},k=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.MouseService=void 0;var B=b(4725),P=b(9806),I=function(){function e(u,y){this._renderService=u,this._charSizeService=y}return e.prototype.getCoords=function(u,y,b,x,k){return(0,P.getCoords)(window,u,y,b,x,this._charSizeService.hasValidSize,this._renderService.dimensions.actualCellWidth,this._renderService.dimensions.actualCellHeight,k)},e.prototype.getRawByteCoords=function(u,y,b,x){var k=this.getCoords(u,y,b,x);return(0,P.getRawByteCoords)(k)},x([k(0,B.IRenderService),k(1,B.ICharSizeService)],e)}();y.MouseService=I},3230:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.RenderService=void 0;var I=b(6193),H=b(8460),j=b(844),N=b(5596),q=b(3656),W=b(2585),U=b(4725),z=function(u){function t(y,b,x,k,B,P,j){var W=u.call(this)||this;if(W._renderer=y,W._rowCount=b,W._charSizeService=B,W._isPaused=!1,W._needsFullRefresh=!1,W._isNextRenderRedrawOnly=!0,W._needsSelectionRefresh=!1,W._canvasWidth=0,W._canvasHeight=0,W._selectionState={start:void 0,end:void 0,columnSelectMode:!1},W._onDimensionsChange=new H.EventEmitter,W._onRenderedViewportChange=new H.EventEmitter,W._onRender=new H.EventEmitter,W._onRefreshRequest=new H.EventEmitter,W.register({dispose:function(){return W._renderer.dispose()}}),W._renderDebouncer=new I.RenderDebouncer((function(u,y){return W._renderRows(u,y)})),W.register(W._renderDebouncer),W._screenDprMonitor=new N.ScreenDprMonitor,W._screenDprMonitor.setListener((function(){return W.onDevicePixelRatioChange()})),W.register(W._screenDprMonitor),W.register(j.onResize((function(){return W._fullRefresh()}))),W.register(j.buffers.onBufferActivate((function(){var u;return null===(u=W._renderer)||void 0===u?void 0:u.clear()}))),W.register(k.onOptionChange((function(){return W._handleOptionsChanged()}))),W.register(W._charSizeService.onCharSizeChange((function(){return W.onCharSizeChanged()}))),W.register(P.onDecorationRegistered((function(){return W._fullRefresh()}))),W.register(P.onDecorationRemoved((function(){return W._fullRefresh()}))),W._renderer.onRequestRedraw((function(u){return W.refreshRows(u.start,u.end,!0)})),W.register((0,q.addDisposableDomListener)(window,"resize",(function(){return W.onDevicePixelRatioChange()}))),"IntersectionObserver"in window){var U=new IntersectionObserver((function(u){return W._onIntersectionChange(u[u.length-1])}),{threshold:0});U.observe(x),W.register({dispose:function(){return U.disconnect()}})}return W}return k(t,u),Object.defineProperty(t.prototype,"onDimensionsChange",{get:function(){return this._onDimensionsChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRenderedViewportChange",{get:function(){return this._onRenderedViewportChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRefreshRequest",{get:function(){return this._onRefreshRequest.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dimensions",{get:function(){return this._renderer.dimensions},enumerable:!1,configurable:!0}),t.prototype._onIntersectionChange=function(u){this._isPaused=void 0===u.isIntersecting?0===u.intersectionRatio:!u.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)},t.prototype.refreshRows=function(u,y,b){void 0===b&&(b=!1),this._isPaused?this._needsFullRefresh=!0:(b||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(u,y,this._rowCount))},t.prototype._renderRows=function(u,y){this._renderer.renderRows(u,y),this._needsSelectionRefresh&&(this._renderer.onSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:u,end:y}),this._onRender.fire({start:u,end:y}),this._isNextRenderRedrawOnly=!0},t.prototype.resize=function(u,y){this._rowCount=y,this._fireOnCanvasResize()},t.prototype._handleOptionsChanged=function(){this._renderer.onOptionsChanged(),this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize()},t.prototype._fireOnCanvasResize=function(){this._renderer.dimensions.canvasWidth===this._canvasWidth&&this._renderer.dimensions.canvasHeight===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions)},t.prototype.dispose=function(){u.prototype.dispose.call(this)},t.prototype.setRenderer=function(u){var y=this;this._renderer.dispose(),this._renderer=u,this._renderer.onRequestRedraw((function(u){return y.refreshRows(u.start,u.end,!0)})),this._needsSelectionRefresh=!0,this._fullRefresh()},t.prototype.addRefreshCallback=function(u){return this._renderDebouncer.addRefreshCallback(u)},t.prototype._fullRefresh=function(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)},t.prototype.clearTextureAtlas=function(){var u,y;null===(y=null===(u=this._renderer)||void 0===u?void 0:u.clearTextureAtlas)||void 0===y||y.call(u),this._fullRefresh()},t.prototype.setColors=function(u){this._renderer.setColors(u),this._fullRefresh()},t.prototype.onDevicePixelRatioChange=function(){this._charSizeService.measure(),this._renderer.onDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1)},t.prototype.onResize=function(u,y){this._renderer.onResize(u,y),this._fullRefresh()},t.prototype.onCharSizeChanged=function(){this._renderer.onCharSizeChanged()},t.prototype.onBlur=function(){this._renderer.onBlur()},t.prototype.onFocus=function(){this._renderer.onFocus()},t.prototype.onSelectionChanged=function(u,y,b){this._selectionState.start=u,this._selectionState.end=y,this._selectionState.columnSelectMode=b,this._renderer.onSelectionChanged(u,y,b)},t.prototype.onCursorMove=function(){this._renderer.onCursorMove()},t.prototype.clear=function(){this._renderer.clear()},B([P(3,W.IOptionsService),P(4,U.ICharSizeService),P(5,W.IDecorationService),P(6,W.IBufferService)],t)}(j.Disposable);y.RenderService=z},9312:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.SelectionService=void 0;var I=b(6114),H=b(456),j=b(511),N=b(8460),q=b(4725),W=b(2585),U=b(9806),z=b(9504),K=b(844),V=b(4841),G=/ /g,X=function(u){function t(y,b,x,k,B,P,I,q){var W=u.call(this)||this;return W._element=y,W._screenElement=b,W._linkifier=x,W._bufferService=k,W._coreService=B,W._mouseService=P,W._optionsService=I,W._renderService=q,W._dragScrollAmount=0,W._enabled=!0,W._workCell=new j.CellData,W._mouseDownTimeStamp=0,W._oldHasSelection=!1,W._oldSelectionStart=void 0,W._oldSelectionEnd=void 0,W._onLinuxMouseSelection=W.register(new N.EventEmitter),W._onRedrawRequest=W.register(new N.EventEmitter),W._onSelectionChange=W.register(new N.EventEmitter),W._onRequestScrollLines=W.register(new N.EventEmitter),W._mouseMoveListener=function(u){return W._onMouseMove(u)},W._mouseUpListener=function(u){return W._onMouseUp(u)},W._coreService.onUserInput((function(){W.hasSelection&&W.clearSelection()})),W._trimListener=W._bufferService.buffer.lines.onTrim((function(u){return W._onTrim(u)})),W.register(W._bufferService.buffers.onBufferActivate((function(u){return W._onBufferActivate(u)}))),W.enable(),W._model=new H.SelectionModel(W._bufferService),W._activeSelectionMode=0,W}return k(t,u),Object.defineProperty(t.prototype,"onLinuxMouseSelection",{get:function(){return this._onLinuxMouseSelection.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestRedraw",{get:function(){return this._onRedrawRequest.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestScrollLines",{get:function(){return this._onRequestScrollLines.event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._removeMouseDownListeners()},t.prototype.reset=function(){this.clearSelection()},t.prototype.disable=function(){this.clearSelection(),this._enabled=!1},t.prototype.enable=function(){this._enabled=!0},Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this._model.finalSelectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this._model.finalSelectionEnd},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSelection",{get:function(){var u=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;return!(!u||!y||u[0]===y[0]&&u[1]===y[1])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionText",{get:function(){var u=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;if(!u||!y)return"";var b=this._bufferService.buffer,x=[];if(3===this._activeSelectionMode){if(u[0]===y[0])return"";for(var k=u[0]<y[0]?u[0]:y[0],B=u[0]<y[0]?y[0]:u[0],P=u[1];P<=y[1];P++){var H=b.translateBufferLineToString(P,!0,k,B);x.push(H)}}else{var j=u[1]===y[1]?y[0]:void 0;for(x.push(b.translateBufferLineToString(u[1],!0,u[0],j)),P=u[1]+1;P<=y[1]-1;P++){var N=b.lines.get(P);H=b.translateBufferLineToString(P,!0),(null==N?void 0:N.isWrapped)?x[x.length-1]+=H:x.push(H)}u[1]!==y[1]&&(N=b.lines.get(y[1]),H=b.translateBufferLineToString(y[1],!0,0,y[0]),N&&N.isWrapped?x[x.length-1]+=H:x.push(H))}return x.map((function(u){return u.replace(G," ")})).join(I.isWindows?"\r\n":"\n")},enumerable:!1,configurable:!0}),t.prototype.clearSelection=function(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()},t.prototype.refresh=function(u){var y=this;this._refreshAnimationFrame||(this._refreshAnimationFrame=window.requestAnimationFrame((function(){return y._refresh()}))),I.isLinux&&u&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)},t.prototype._refresh=function(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:3===this._activeSelectionMode})},t.prototype._isClickInSelection=function(u){var y=this._getMouseBufferCoords(u),b=this._model.finalSelectionStart,x=this._model.finalSelectionEnd;return!!(b&&x&&y)&&this._areCoordsInSelection(y,b,x)},t.prototype.isCellInSelection=function(u,y){var b=this._model.finalSelectionStart,x=this._model.finalSelectionEnd;return!(!b||!x)&&this._areCoordsInSelection([u,y],b,x)},t.prototype._areCoordsInSelection=function(u,y,b){return u[1]>y[1]&&u[1]<b[1]||y[1]===b[1]&&u[1]===y[1]&&u[0]>=y[0]&&u[0]<b[0]||y[1]<b[1]&&u[1]===b[1]&&u[0]<b[0]||y[1]<b[1]&&u[1]===y[1]&&u[0]>=y[0]},t.prototype._selectWordAtCursor=function(u,y){var b,x,k=null===(x=null===(b=this._linkifier.currentLink)||void 0===b?void 0:b.link)||void 0===x?void 0:x.range;if(k)return this._model.selectionStart=[k.start.x-1,k.start.y-1],this._model.selectionStartLength=(0,V.getRangeLength)(k,this._bufferService.cols),this._model.selectionEnd=void 0,!0;var B=this._getMouseBufferCoords(u);return!!B&&(this._selectWordAt(B,y),this._model.selectionEnd=void 0,!0)},t.prototype.selectAll=function(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()},t.prototype.selectLines=function(u,y){this._model.clearSelection(),u=Math.max(u,0),y=Math.min(y,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,u],this._model.selectionEnd=[this._bufferService.cols,y],this.refresh(),this._onSelectionChange.fire()},t.prototype._onTrim=function(u){this._model.onTrim(u)&&this.refresh()},t.prototype._getMouseBufferCoords=function(u){var y=this._mouseService.getCoords(u,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(y)return y[0]--,y[1]--,y[1]+=this._bufferService.buffer.ydisp,y},t.prototype._getMouseEventScrollAmount=function(u){var y=(0,U.getCoordsRelativeToElement)(window,u,this._screenElement)[1],b=this._renderService.dimensions.canvasHeight;return y>=0&&y<=b?0:(y>b&&(y-=b),y=Math.min(Math.max(y,-50),50),(y/=50)/Math.abs(y)+Math.round(14*y))},t.prototype.shouldForceSelection=function(u){return I.isMac?u.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:u.shiftKey},t.prototype.onMouseDown=function(u){if(this._mouseDownTimeStamp=u.timeStamp,(2!==u.button||!this.hasSelection)&&0===u.button){if(!this._enabled){if(!this.shouldForceSelection(u))return;u.stopPropagation()}u.preventDefault(),this._dragScrollAmount=0,this._enabled&&u.shiftKey?this._onIncrementalClick(u):1===u.detail?this._onSingleClick(u):2===u.detail?this._onDoubleClick(u):3===u.detail&&this._onTripleClick(u),this._addMouseDownListeners(),this.refresh(!0)}},t.prototype._addMouseDownListeners=function(){var u=this;this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=window.setInterval((function(){return u._dragScroll()}),50)},t.prototype._removeMouseDownListeners=function(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0},t.prototype._onIncrementalClick=function(u){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(u))},t.prototype._onSingleClick=function(u){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(u)?3:0,this._model.selectionStart=this._getMouseBufferCoords(u),this._model.selectionStart){this._model.selectionEnd=void 0;var y=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);y&&y.length!==this._model.selectionStart[0]&&0===y.hasWidth(this._model.selectionStart[0])&&this._model.selectionStart[0]++}},t.prototype._onDoubleClick=function(u){this._selectWordAtCursor(u,!0)&&(this._activeSelectionMode=1)},t.prototype._onTripleClick=function(u){var y=this._getMouseBufferCoords(u);y&&(this._activeSelectionMode=2,this._selectLineAt(y[1]))},t.prototype.shouldColumnSelect=function(u){return u.altKey&&!(I.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)},t.prototype._onMouseMove=function(u){if(u.stopImmediatePropagation(),this._model.selectionStart){var y=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(u),this._model.selectionEnd){2===this._activeSelectionMode?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:1===this._activeSelectionMode&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(u),3!==this._activeSelectionMode&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));var b=this._bufferService.buffer;if(this._model.selectionEnd[1]<b.lines.length){var x=b.lines.get(this._model.selectionEnd[1]);x&&0===x.hasWidth(this._model.selectionEnd[0])&&this._model.selectionEnd[0]++}y&&y[0]===this._model.selectionEnd[0]&&y[1]===this._model.selectionEnd[1]||this.refresh(!0)}else this.refresh(!0)}},t.prototype._dragScroll=function(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});var u=this._bufferService.buffer;this._dragScrollAmount>0?(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(u.ydisp+this._bufferService.rows,u.lines.length-1)):(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=u.ydisp),this.refresh()}},t.prototype._onMouseUp=function(u){var y=u.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&y<500&&u.altKey&&this._optionsService.getOption("altClickMovesCursor")){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){var b=this._mouseService.getCoords(u,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(b&&void 0!==b[0]&&void 0!==b[1]){var x=(0,z.moveToCellSequence)(b[0]-1,b[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(x,!0)}}}else this._fireEventIfSelectionChanged()},t.prototype._fireEventIfSelectionChanged=function(){var u=this._model.finalSelectionStart,y=this._model.finalSelectionEnd,b=!(!u||!y||u[0]===y[0]&&u[1]===y[1]);b?u&&y&&(this._oldSelectionStart&&this._oldSelectionEnd&&u[0]===this._oldSelectionStart[0]&&u[1]===this._oldSelectionStart[1]&&y[0]===this._oldSelectionEnd[0]&&y[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(u,y,b)):this._oldHasSelection&&this._fireOnSelectionChange(u,y,b)},t.prototype._fireOnSelectionChange=function(u,y,b){this._oldSelectionStart=u,this._oldSelectionEnd=y,this._oldHasSelection=b,this._onSelectionChange.fire()},t.prototype._onBufferActivate=function(u){var y=this;this.clearSelection(),this._trimListener.dispose(),this._trimListener=u.activeBuffer.lines.onTrim((function(u){return y._onTrim(u)}))},t.prototype._convertViewportColToCharacterIndex=function(u,y){for(var b=y[0],x=0;y[0]>=x;x++){var k=u.loadCell(x,this._workCell).getChars().length;0===this._workCell.getWidth()?b--:k>1&&y[0]!==x&&(b+=k-1)}return b},t.prototype.setSelection=function(u,y,b){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[u,y],this._model.selectionStartLength=b,this.refresh(),this._fireEventIfSelectionChanged()},t.prototype.rightClickSelect=function(u){this._isClickInSelection(u)||(this._selectWordAtCursor(u,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())},t.prototype._getWordAt=function(u,y,b,x){if(void 0===b&&(b=!0),void 0===x&&(x=!0),!(u[0]>=this._bufferService.cols)){var k=this._bufferService.buffer,B=k.lines.get(u[1]);if(B){var P=k.translateBufferLineToString(u[1],!1),I=this._convertViewportColToCharacterIndex(B,u),H=I,j=u[0]-I,N=0,q=0,W=0,U=0;if(" "===P.charAt(I)){for(;I>0&&" "===P.charAt(I-1);)I--;for(;H<P.length&&" "===P.charAt(H+1);)H++}else{var z=u[0],K=u[0];0===B.getWidth(z)&&(N++,z--),2===B.getWidth(K)&&(q++,K++);var V=B.getString(K).length;for(V>1&&(U+=V-1,H+=V-1);z>0&&I>0&&!this._isCharWordSeparator(B.loadCell(z-1,this._workCell));){B.loadCell(z-1,this._workCell);var G=this._workCell.getChars().length;0===this._workCell.getWidth()?(N++,z--):G>1&&(W+=G-1,I-=G-1),I--,z--}for(;K<B.length&&H+1<P.length&&!this._isCharWordSeparator(B.loadCell(K+1,this._workCell));){B.loadCell(K+1,this._workCell);var X=this._workCell.getChars().length;2===this._workCell.getWidth()?(q++,K++):X>1&&(U+=X-1,H+=X-1),H++,K++}}H++;var Y=I+j-N+W,J=Math.min(this._bufferService.cols,H-I+N+q-W-U);if(y||""!==P.slice(I,H).trim()){if(b&&0===Y&&32!==B.getCodePoint(0)){var $=k.lines.get(u[1]-1);if($&&B.isWrapped&&32!==$.getCodePoint(this._bufferService.cols-1)){var Q=this._getWordAt([this._bufferService.cols-1,u[1]-1],!1,!0,!1);if(Q){var ee=this._bufferService.cols-Q.start;Y-=ee,J+=ee}}}if(x&&Y+J===this._bufferService.cols&&32!==B.getCodePoint(this._bufferService.cols-1)){var te=k.lines.get(u[1]+1);if((null==te?void 0:te.isWrapped)&&32!==te.getCodePoint(0)){var re=this._getWordAt([0,u[1]+1],!1,!1,!0);re&&(J+=re.length)}}return{start:Y,length:J}}}}},t.prototype._selectWordAt=function(u,y){var b=this._getWordAt(u,y);if(b){for(;b.start<0;)b.start+=this._bufferService.cols,u[1]--;this._model.selectionStart=[b.start,u[1]],this._model.selectionStartLength=b.length}},t.prototype._selectToWordAt=function(u){var y=this._getWordAt(u,!0);if(y){for(var b=u[1];y.start<0;)y.start+=this._bufferService.cols,b--;if(!this._model.areSelectionValuesReversed())for(;y.start+y.length>this._bufferService.cols;)y.length-=this._bufferService.cols,b++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?y.start:y.start+y.length,b]}},t.prototype._isCharWordSeparator=function(u){return 0!==u.getWidth()&&this._optionsService.rawOptions.wordSeparator.indexOf(u.getChars())>=0},t.prototype._selectLineAt=function(u){var y=this._bufferService.buffer.getWrappedRangeForLine(u),b={start:{x:0,y:y.first},end:{x:this._bufferService.cols-1,y:y.last}};this._model.selectionStart=[0,y.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,V.getRangeLength)(b,this._bufferService.cols)},B([P(3,W.IBufferService),P(4,W.ICoreService),P(5,q.IMouseService),P(6,W.IOptionsService),P(7,q.IRenderService)],t)}(K.Disposable);y.SelectionService=X},4725:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.ICharacterJoinerService=y.ISoundService=y.ISelectionService=y.IRenderService=y.IMouseService=y.ICoreBrowserService=y.ICharSizeService=void 0;var x=b(8343);y.ICharSizeService=(0,x.createDecorator)("CharSizeService"),y.ICoreBrowserService=(0,x.createDecorator)("CoreBrowserService"),y.IMouseService=(0,x.createDecorator)("MouseService"),y.IRenderService=(0,x.createDecorator)("RenderService"),y.ISelectionService=(0,x.createDecorator)("SelectionService"),y.ISoundService=(0,x.createDecorator)("SoundService"),y.ICharacterJoinerService=(0,x.createDecorator)("CharacterJoinerService")},357:function(u,y,b){var x=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},k=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.SoundService=void 0;var B=b(2585),P=function(){function e(u){this._optionsService=u}return Object.defineProperty(e,"audioContext",{get:function(){if(!e._audioContext){var u=window.AudioContext||window.webkitAudioContext;if(!u)return console.warn("Web Audio API is not supported by this browser. Consider upgrading to the latest version"),null;e._audioContext=new u}return e._audioContext},enumerable:!1,configurable:!0}),e.prototype.playBellSound=function(){var u=e.audioContext;if(u){var y=u.createBufferSource();u.decodeAudioData(this._base64ToArrayBuffer(this._removeMimeType(this._optionsService.rawOptions.bellSound)),(function(b){y.buffer=b,y.connect(u.destination),y.start(0)}))}},e.prototype._base64ToArrayBuffer=function(u){for(var y=window.atob(u),b=y.length,x=new Uint8Array(b),k=0;k<b;k++)x[k]=y.charCodeAt(k);return x.buffer},e.prototype._removeMimeType=function(u){return u.split(",")[1]},e=x([k(0,B.IOptionsService)],e)}();y.SoundService=P},6349:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.CircularList=void 0;var x=b(8460),k=function(){function e(u){this._maxLength=u,this.onDeleteEmitter=new x.EventEmitter,this.onInsertEmitter=new x.EventEmitter,this.onTrimEmitter=new x.EventEmitter,this._array=Array(this._maxLength),this._startIndex=0,this._length=0}return Object.defineProperty(e.prototype,"onDelete",{get:function(){return this.onDeleteEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onInsert",{get:function(){return this.onInsertEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onTrim",{get:function(){return this.onTrimEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLength",{get:function(){return this._maxLength},set:function(u){if(this._maxLength!==u){for(var y=Array(u),b=0;b<Math.min(u,this.length);b++)y[b]=this._array[this._getCyclicIndex(b)];this._array=y,this._maxLength=u,this._startIndex=0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},set:function(u){if(u>this._length)for(var y=this._length;y<u;y++)this._array[y]=void 0;this._length=u},enumerable:!1,configurable:!0}),e.prototype.get=function(u){return this._array[this._getCyclicIndex(u)]},e.prototype.set=function(u,y){this._array[this._getCyclicIndex(u)]=y},e.prototype.push=function(u){this._array[this._getCyclicIndex(this._length)]=u,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++},e.prototype.recycle=function(){if(this._length!==this._maxLength)throw Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]},Object.defineProperty(e.prototype,"isFull",{get:function(){return this._length===this._maxLength},enumerable:!1,configurable:!0}),e.prototype.pop=function(){return this._array[this._getCyclicIndex(this._length---1)]},e.prototype.splice=function(u,y){for(var b=[],x=2;x<arguments.length;x++)b[x-2]=arguments[x];if(y){for(var k=u;k<this._length-y;k++)this._array[this._getCyclicIndex(k)]=this._array[this._getCyclicIndex(k+y)];this._length-=y,this.onDeleteEmitter.fire({index:u,amount:y})}for(k=this._length-1;k>=u;k--)this._array[this._getCyclicIndex(k+b.length)]=this._array[this._getCyclicIndex(k)];for(k=0;k<b.length;k++)this._array[this._getCyclicIndex(u+k)]=b[k];if(b.length&&this.onInsertEmitter.fire({index:u,amount:b.length}),this._length+b.length>this._maxLength){var B=this._length+b.length-this._maxLength;this._startIndex+=B,this._length=this._maxLength,this.onTrimEmitter.fire(B)}else this._length+=b.length},e.prototype.trimStart=function(u){u>this._length&&(u=this._length),this._startIndex+=u,this._length-=u,this.onTrimEmitter.fire(u)},e.prototype.shiftElements=function(u,y,b){if(!(y<=0)){if(u<0||u>=this._length)throw Error("start argument out of range");if(u+b<0)throw Error("Cannot shift elements in list beyond index 0");if(b>0){for(var x=y-1;x>=0;x--)this.set(u+x+b,this.get(u+x));var k=u+y+b-this._length;if(k>0)for(this._length+=k;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(x=0;x<y;x++)this.set(u+x+b,this.get(u+x))}},e.prototype._getCyclicIndex=function(u){return(this._startIndex+u)%this._maxLength},e}();y.CircularList=k},1439:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.clone=void 0,y.clone=function e(u,y){if(void 0===y&&(y=5),"object"!=typeof u)return u;var b=Array.isArray(u)?[]:{};for(var x in u)b[x]=y<=1?u[x]:u[x]&&e(u[x],y-1);return b}},8055:function(u,y){var b,x,k,B,P=this&&this.__read||function(u,y){var b="function"==typeof Symbol&&u[Symbol.iterator];if(!b)return u;var x,k,B=b.call(u),P=[];try{for(;(void 0===y||y-- >0)&&!(x=B.next()).done;)P.push(x.value)}catch(u){k={error:u}}finally{try{x&&!x.done&&(b=B.return)&&b.call(B)}finally{if(k)throw k.error}}return P};function a(u){var y=u.toString(16);return y.length<2?"0"+y:y}function c(u,y){return u<y?(y+.05)/(u+.05):(u+.05)/(y+.05)}Object.defineProperty(y,"__esModule",{value:!0}),y.contrastRatio=y.toPaddedHex=y.rgba=y.rgb=y.css=y.color=y.channels=void 0,function(u){u.toCss=function(u,y,b,x){return void 0!==x?"#"+a(u)+a(y)+a(b)+a(x):"#"+a(u)+a(y)+a(b)},u.toRgba=function(u,y,b,x){return void 0===x&&(x=255),(u<<24|y<<16|b<<8|x)>>>0}}(b=y.channels||(y.channels={})),(x=y.color||(y.color={})).blend=function(u,y){var x=(255&y.rgba)/255;if(1===x)return{css:y.css,rgba:y.rgba};var k=y.rgba>>24&255,B=y.rgba>>16&255,P=y.rgba>>8&255,I=u.rgba>>24&255,H=u.rgba>>16&255,j=u.rgba>>8&255,N=I+Math.round((k-I)*x),q=H+Math.round((B-H)*x),W=j+Math.round((P-j)*x);return{css:b.toCss(N,q,W),rgba:b.toRgba(N,q,W)}},x.isOpaque=function(u){return 255==(255&u.rgba)},x.ensureContrastRatio=function(u,y,b){var x=B.ensureContrastRatio(u.rgba,y.rgba,b);if(x)return B.toColor(x>>24&255,x>>16&255,x>>8&255)},x.opaque=function(u){var y=(255|u.rgba)>>>0,x=P(B.toChannels(y),3),k=x[0],I=x[1],H=x[2];return{css:b.toCss(k,I,H),rgba:y}},x.opacity=function(u,y){var x=Math.round(255*y),k=P(B.toChannels(u.rgba),3),I=k[0],H=k[1],j=k[2];return{css:b.toCss(I,H,j,x),rgba:b.toRgba(I,H,j,x)}},x.toColorRGB=function(u){return[u.rgba>>24&255,u.rgba>>16&255,u.rgba>>8&255]},(y.css||(y.css={})).toColor=function(u){if(u.match(/#[0-9a-f]{3,8}/i))switch(u.length){case 4:var y=parseInt(u.slice(1,2).repeat(2),16),b=parseInt(u.slice(2,3).repeat(2),16),x=parseInt(u.slice(3,4).repeat(2),16);return B.toColor(y,b,x);case 5:y=parseInt(u.slice(1,2).repeat(2),16),b=parseInt(u.slice(2,3).repeat(2),16),x=parseInt(u.slice(3,4).repeat(2),16);var k=parseInt(u.slice(4,5).repeat(2),16);return B.toColor(y,b,x,k);case 7:return{css:u,rgba:(parseInt(u.slice(1),16)<<8|255)>>>0};case 9:return{css:u,rgba:parseInt(u.slice(1),16)>>>0}}var P=u.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(P)return y=parseInt(P[1]),b=parseInt(P[2]),x=parseInt(P[3]),k=Math.round(255*(void 0===P[5]?1:parseFloat(P[5]))),B.toColor(y,b,x,k);throw Error("css.toColor: Unsupported css format")},function(u){function t(u,y,b){var x=u/255,k=y/255,B=b/255;return.2126*(x<=.03928?x/12.92:Math.pow((x+.055)/1.055,2.4))+.7152*(k<=.03928?k/12.92:Math.pow((k+.055)/1.055,2.4))+.0722*(B<=.03928?B/12.92:Math.pow((B+.055)/1.055,2.4))}u.relativeLuminance=function(u){return t(u>>16&255,u>>8&255,255&u)},u.relativeLuminance2=t}(k=y.rgb||(y.rgb={})),function(u){function t(u,y,b){for(var x=u>>24&255,B=u>>16&255,P=u>>8&255,I=y>>24&255,H=y>>16&255,j=y>>8&255,N=c(k.relativeLuminance2(I,H,j),k.relativeLuminance2(x,B,P));N<b&&(I>0||H>0||j>0);)I-=Math.max(0,Math.ceil(.1*I)),H-=Math.max(0,Math.ceil(.1*H)),j-=Math.max(0,Math.ceil(.1*j)),N=c(k.relativeLuminance2(I,H,j),k.relativeLuminance2(x,B,P));return(I<<24|H<<16|j<<8|255)>>>0}function i(u,y,b){for(var x=u>>24&255,B=u>>16&255,P=u>>8&255,I=y>>24&255,H=y>>16&255,j=y>>8&255,N=c(k.relativeLuminance2(I,H,j),k.relativeLuminance2(x,B,P));N<b&&(I<255||H<255||j<255);)I=Math.min(255,I+Math.ceil(.1*(255-I))),H=Math.min(255,H+Math.ceil(.1*(255-H))),j=Math.min(255,j+Math.ceil(.1*(255-j))),N=c(k.relativeLuminance2(I,H,j),k.relativeLuminance2(x,B,P));return(I<<24|H<<16|j<<8|255)>>>0}u.ensureContrastRatio=function(u,y,b){var x=k.relativeLuminance(u>>8),B=k.relativeLuminance(y>>8);if(c(x,B)<b){if(B<x){var P=t(u,y,b),I=c(x,k.relativeLuminance(P>>8));if(I<b){var H=i(u,u,b);return I>c(x,k.relativeLuminance(H>>8))?P:H}return P}var j=i(u,y,b),N=c(x,k.relativeLuminance(j>>8));return N<b?(H=t(u,u,b),N>c(x,k.relativeLuminance(H>>8))?j:H):j}},u.reduceLuminance=t,u.increaseLuminance=i,u.toChannels=function(u){return[u>>24&255,u>>16&255,u>>8&255,255&u]},u.toColor=function(u,y,x,k){return{css:b.toCss(u,y,x,k),rgba:b.toRgba(u,y,x,k)}}}(B=y.rgba||(y.rgba={})),y.toPaddedHex=a,y.contrastRatio=c},8969:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.CoreTerminal=void 0;var P=b(844),I=b(2585),H=b(4348),j=b(7866),N=b(744),q=b(7302),W=b(6975),U=b(8460),z=b(1753),K=b(3730),V=b(1480),G=b(7994),X=b(9282),Y=b(5435),J=b(5981),$=!1,Q=function(u){function t(y){var b=u.call(this)||this;return b._onBinary=new U.EventEmitter,b._onData=new U.EventEmitter,b._onLineFeed=new U.EventEmitter,b._onResize=new U.EventEmitter,b._onScroll=new U.EventEmitter,b._onWriteParsed=new U.EventEmitter,b._instantiationService=new H.InstantiationService,b.optionsService=new q.OptionsService(y),b._instantiationService.setService(I.IOptionsService,b.optionsService),b._bufferService=b.register(b._instantiationService.createInstance(N.BufferService)),b._instantiationService.setService(I.IBufferService,b._bufferService),b._logService=b._instantiationService.createInstance(j.LogService),b._instantiationService.setService(I.ILogService,b._logService),b.coreService=b.register(b._instantiationService.createInstance(W.CoreService,(function(){return b.scrollToBottom()}))),b._instantiationService.setService(I.ICoreService,b.coreService),b.coreMouseService=b._instantiationService.createInstance(z.CoreMouseService),b._instantiationService.setService(I.ICoreMouseService,b.coreMouseService),b._dirtyRowService=b._instantiationService.createInstance(K.DirtyRowService),b._instantiationService.setService(I.IDirtyRowService,b._dirtyRowService),b.unicodeService=b._instantiationService.createInstance(V.UnicodeService),b._instantiationService.setService(I.IUnicodeService,b.unicodeService),b._charsetService=b._instantiationService.createInstance(G.CharsetService),b._instantiationService.setService(I.ICharsetService,b._charsetService),b._inputHandler=new Y.InputHandler(b._bufferService,b._charsetService,b.coreService,b._dirtyRowService,b._logService,b.optionsService,b.coreMouseService,b.unicodeService),b.register((0,U.forwardEvent)(b._inputHandler.onLineFeed,b._onLineFeed)),b.register(b._inputHandler),b.register((0,U.forwardEvent)(b._bufferService.onResize,b._onResize)),b.register((0,U.forwardEvent)(b.coreService.onData,b._onData)),b.register((0,U.forwardEvent)(b.coreService.onBinary,b._onBinary)),b.register(b.optionsService.onOptionChange((function(u){return b._updateOptions(u)}))),b.register(b._bufferService.onScroll((function(u){b._onScroll.fire({position:b._bufferService.buffer.ydisp,source:0}),b._dirtyRowService.markRangeDirty(b._bufferService.buffer.scrollTop,b._bufferService.buffer.scrollBottom)}))),b.register(b._inputHandler.onScroll((function(u){b._onScroll.fire({position:b._bufferService.buffer.ydisp,source:0}),b._dirtyRowService.markRangeDirty(b._bufferService.buffer.scrollTop,b._bufferService.buffer.scrollBottom)}))),b._writeBuffer=new J.WriteBuffer((function(u,y){return b._inputHandler.parse(u,y)})),b.register((0,U.forwardEvent)(b._writeBuffer.onWriteParsed,b._onWriteParsed)),b}return k(t,u),Object.defineProperty(t.prototype,"onBinary",{get:function(){return this._onBinary.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onData",{get:function(){return this._onData.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onWriteParsed",{get:function(){return this._onWriteParsed.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onScroll",{get:function(){var u=this;return this._onScrollApi||(this._onScrollApi=new U.EventEmitter,this.register(this._onScroll.event((function(y){var b;null===(b=u._onScrollApi)||void 0===b||b.fire(y.position)})))),this._onScrollApi.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cols",{get:function(){return this._bufferService.cols},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this._bufferService.rows},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"buffers",{get:function(){return this._bufferService.buffers},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.optionsService.options},set:function(u){for(var y in u)this.optionsService.options[y]=u[y]},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){var y;this._isDisposed||(u.prototype.dispose.call(this),null===(y=this._windowsMode)||void 0===y||y.dispose(),this._windowsMode=void 0)},t.prototype.write=function(u,y){this._writeBuffer.write(u,y)},t.prototype.writeSync=function(u,y){this._logService.logLevel<=I.LogLevelEnum.WARN&&!$&&(this._logService.warn("writeSync is unreliable and will be removed soon."),$=!0),this._writeBuffer.writeSync(u,y)},t.prototype.resize=function(u,y){isNaN(u)||isNaN(y)||(u=Math.max(u,N.MINIMUM_COLS),y=Math.max(y,N.MINIMUM_ROWS),this._bufferService.resize(u,y))},t.prototype.scroll=function(u,y){void 0===y&&(y=!1),this._bufferService.scroll(u,y)},t.prototype.scrollLines=function(u,y,b){this._bufferService.scrollLines(u,y,b)},t.prototype.scrollPages=function(u){this._bufferService.scrollPages(u)},t.prototype.scrollToTop=function(){this._bufferService.scrollToTop()},t.prototype.scrollToBottom=function(){this._bufferService.scrollToBottom()},t.prototype.scrollToLine=function(u){this._bufferService.scrollToLine(u)},t.prototype.registerEscHandler=function(u,y){return this._inputHandler.registerEscHandler(u,y)},t.prototype.registerDcsHandler=function(u,y){return this._inputHandler.registerDcsHandler(u,y)},t.prototype.registerCsiHandler=function(u,y){return this._inputHandler.registerCsiHandler(u,y)},t.prototype.registerOscHandler=function(u,y){return this._inputHandler.registerOscHandler(u,y)},t.prototype._setup=function(){this.optionsService.rawOptions.windowsMode&&this._enableWindowsMode()},t.prototype.reset=function(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()},t.prototype._updateOptions=function(u){var y;switch(u){case"scrollback":this.buffers.resize(this.cols,this.rows);break;case"windowsMode":this.optionsService.rawOptions.windowsMode?this._enableWindowsMode():(null===(y=this._windowsMode)||void 0===y||y.dispose(),this._windowsMode=void 0)}},t.prototype._enableWindowsMode=function(){var u=this;if(!this._windowsMode){var y=[];y.push(this.onLineFeed(X.updateWindowsModeWrappedState.bind(null,this._bufferService))),y.push(this.registerCsiHandler({final:"H"},(function(){return(0,X.updateWindowsModeWrappedState)(u._bufferService),!1}))),this._windowsMode={dispose:function(){var u,b;try{for(var x=B(y),k=x.next();!k.done;k=x.next())k.value.dispose()}catch(y){u={error:y}}finally{try{k&&!k.done&&(b=x.return)&&b.call(x)}finally{if(u)throw u.error}}}}}},t}(P.Disposable);y.CoreTerminal=Q},8460:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.forwardEvent=y.EventEmitter=void 0;var b=function(){function e(){this._listeners=[],this._disposed=!1}return Object.defineProperty(e.prototype,"event",{get:function(){var u=this;return this._event||(this._event=function(y){return u._listeners.push(y),{dispose:function(){if(!u._disposed)for(var b=0;b<u._listeners.length;b++)if(u._listeners[b]===y)return void u._listeners.splice(b,1)}}}),this._event},enumerable:!1,configurable:!0}),e.prototype.fire=function(u,y){for(var b=[],x=0;x<this._listeners.length;x++)b.push(this._listeners[x]);for(x=0;x<b.length;x++)b[x].call(void 0,u,y)},e.prototype.dispose=function(){this._listeners&&(this._listeners.length=0),this._disposed=!0},e}();y.EventEmitter=b,y.forwardEvent=function(u,y){return u((function(u){return y.fire(u)}))}},5435:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)});Object.defineProperty(y,"__esModule",{value:!0}),y.InputHandler=y.WindowsOptionsReportType=void 0;var B,P=b(2584),I=b(7116),H=b(2015),j=b(844),N=b(8273),q=b(482),W=b(8437),U=b(8460),z=b(643),K=b(511),V=b(3734),G=b(2585),X=b(6242),Y=b(6351),J=b(5941),$={"(":0,")":1,"*":2,"+":3,"-":1,".":2},Q=131072;function w(u,y){if(u>24)return y.setWinLines||!1;switch(u){case 1:return!!y.restoreWin;case 2:return!!y.minimizeWin;case 3:return!!y.setWinPosition;case 4:return!!y.setWinSizePixels;case 5:return!!y.raiseWin;case 6:return!!y.lowerWin;case 7:return!!y.refreshWin;case 8:return!!y.setWinSizeChars;case 9:return!!y.maximizeWin;case 10:return!!y.fullscreenWin;case 11:return!!y.getWinState;case 13:return!!y.getWinPosition;case 14:return!!y.getWinSizePixels;case 15:return!!y.getScreenSizePixels;case 16:return!!y.getCellSizePixels;case 18:return!!y.getWinSizeChars;case 19:return!!y.getScreenSizeChars;case 20:return!!y.getIconTitle;case 21:return!!y.getWinTitle;case 22:return!!y.pushTitle;case 23:return!!y.popTitle;case 24:return!!y.setWinLines}return!1}!function(u){u[u.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",u[u.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"}(B=y.WindowsOptionsReportType||(y.WindowsOptionsReportType={}));var ee=function(){function e(u,y,b,x){this._bufferService=u,this._coreService=y,this._logService=b,this._optionsService=x,this._data=new Uint32Array(0)}return e.prototype.hook=function(u){this._data=new Uint32Array(0)},e.prototype.put=function(u,y,b){this._data=(0,N.concat)(this._data,u.subarray(y,b))},e.prototype.unhook=function(u){if(!u)return this._data=new Uint32Array(0),!0;var y=(0,q.utf32ToString)(this._data);switch(this._data=new Uint32Array(0),y){case'"q':this._coreService.triggerDataEvent(P.C0.ESC+'P1$r0"q'+P.C0.ESC+"\\");break;case'"p':this._coreService.triggerDataEvent(P.C0.ESC+'P1$r61;1"p'+P.C0.ESC+"\\");break;case"r":var b=this._bufferService.buffer.scrollTop+1+";"+(this._bufferService.buffer.scrollBottom+1)+"r";this._coreService.triggerDataEvent(P.C0.ESC+"P1$r"+b+P.C0.ESC+"\\");break;case"m":this._coreService.triggerDataEvent(P.C0.ESC+"P1$r0m"+P.C0.ESC+"\\");break;case" q":var x={block:2,underline:4,bar:6}[this._optionsService.rawOptions.cursorStyle];x-=this._optionsService.rawOptions.cursorBlink?1:0,this._coreService.triggerDataEvent(P.C0.ESC+"P1$r"+x+" q"+P.C0.ESC+"\\");break;default:this._logService.debug("Unknown DCS $q %s",y),this._coreService.triggerDataEvent(P.C0.ESC+"P0$r"+P.C0.ESC+"\\")}return!0},e}(),te=function(u){function t(y,b,x,k,B,j,N,z,V){void 0===V&&(V=new H.EscapeSequenceParser);var G=u.call(this)||this;G._bufferService=y,G._charsetService=b,G._coreService=x,G._dirtyRowService=k,G._logService=B,G._optionsService=j,G._coreMouseService=N,G._unicodeService=z,G._parser=V,G._parseBuffer=new Uint32Array(4096),G._stringDecoder=new q.StringToUtf32,G._utf8Decoder=new q.Utf8ToUtf32,G._workCell=new K.CellData,G._windowTitle="",G._iconName="",G._windowTitleStack=[],G._iconNameStack=[],G._curAttrData=W.DEFAULT_ATTR_DATA.clone(),G._eraseAttrDataInternal=W.DEFAULT_ATTR_DATA.clone(),G._onRequestBell=new U.EventEmitter,G._onRequestRefreshRows=new U.EventEmitter,G._onRequestReset=new U.EventEmitter,G._onRequestSendFocus=new U.EventEmitter,G._onRequestSyncScrollBar=new U.EventEmitter,G._onRequestWindowsOptionsReport=new U.EventEmitter,G._onA11yChar=new U.EventEmitter,G._onA11yTab=new U.EventEmitter,G._onCursorMove=new U.EventEmitter,G._onLineFeed=new U.EventEmitter,G._onScroll=new U.EventEmitter,G._onTitleChange=new U.EventEmitter,G._onColor=new U.EventEmitter,G._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},G._specialColors=[256,257,258],G.register(G._parser),G._activeBuffer=G._bufferService.buffer,G.register(G._bufferService.buffers.onBufferActivate((function(u){return G._activeBuffer=u.activeBuffer}))),G._parser.setCsiHandlerFallback((function(u,y){G._logService.debug("Unknown CSI code: ",{identifier:G._parser.identToString(u),params:y.toArray()})})),G._parser.setEscHandlerFallback((function(u){G._logService.debug("Unknown ESC code: ",{identifier:G._parser.identToString(u)})})),G._parser.setExecuteHandlerFallback((function(u){G._logService.debug("Unknown EXECUTE code: ",{code:u})})),G._parser.setOscHandlerFallback((function(u,y,b){G._logService.debug("Unknown OSC code: ",{identifier:u,action:y,data:b})})),G._parser.setDcsHandlerFallback((function(u,y,b){"HOOK"===y&&(b=b.toArray()),G._logService.debug("Unknown DCS code: ",{identifier:G._parser.identToString(u),action:y,payload:b})})),G._parser.setPrintHandler((function(u,y,b){return G.print(u,y,b)})),G._parser.registerCsiHandler({final:"@"},(function(u){return G.insertChars(u)})),G._parser.registerCsiHandler({intermediates:" ",final:"@"},(function(u){return G.scrollLeft(u)})),G._parser.registerCsiHandler({final:"A"},(function(u){return G.cursorUp(u)})),G._parser.registerCsiHandler({intermediates:" ",final:"A"},(function(u){return G.scrollRight(u)})),G._parser.registerCsiHandler({final:"B"},(function(u){return G.cursorDown(u)})),G._parser.registerCsiHandler({final:"C"},(function(u){return G.cursorForward(u)})),G._parser.registerCsiHandler({final:"D"},(function(u){return G.cursorBackward(u)})),G._parser.registerCsiHandler({final:"E"},(function(u){return G.cursorNextLine(u)})),G._parser.registerCsiHandler({final:"F"},(function(u){return G.cursorPrecedingLine(u)})),G._parser.registerCsiHandler({final:"G"},(function(u){return G.cursorCharAbsolute(u)})),G._parser.registerCsiHandler({final:"H"},(function(u){return G.cursorPosition(u)})),G._parser.registerCsiHandler({final:"I"},(function(u){return G.cursorForwardTab(u)})),G._parser.registerCsiHandler({final:"J"},(function(u){return G.eraseInDisplay(u)})),G._parser.registerCsiHandler({prefix:"?",final:"J"},(function(u){return G.eraseInDisplay(u)})),G._parser.registerCsiHandler({final:"K"},(function(u){return G.eraseInLine(u)})),G._parser.registerCsiHandler({prefix:"?",final:"K"},(function(u){return G.eraseInLine(u)})),G._parser.registerCsiHandler({final:"L"},(function(u){return G.insertLines(u)})),G._parser.registerCsiHandler({final:"M"},(function(u){return G.deleteLines(u)})),G._parser.registerCsiHandler({final:"P"},(function(u){return G.deleteChars(u)})),G._parser.registerCsiHandler({final:"S"},(function(u){return G.scrollUp(u)})),G._parser.registerCsiHandler({final:"T"},(function(u){return G.scrollDown(u)})),G._parser.registerCsiHandler({final:"X"},(function(u){return G.eraseChars(u)})),G._parser.registerCsiHandler({final:"Z"},(function(u){return G.cursorBackwardTab(u)})),G._parser.registerCsiHandler({final:"`"},(function(u){return G.charPosAbsolute(u)})),G._parser.registerCsiHandler({final:"a"},(function(u){return G.hPositionRelative(u)})),G._parser.registerCsiHandler({final:"b"},(function(u){return G.repeatPrecedingCharacter(u)})),G._parser.registerCsiHandler({final:"c"},(function(u){return G.sendDeviceAttributesPrimary(u)})),G._parser.registerCsiHandler({prefix:">",final:"c"},(function(u){return G.sendDeviceAttributesSecondary(u)})),G._parser.registerCsiHandler({final:"d"},(function(u){return G.linePosAbsolute(u)})),G._parser.registerCsiHandler({final:"e"},(function(u){return G.vPositionRelative(u)})),G._parser.registerCsiHandler({final:"f"},(function(u){return G.hVPosition(u)})),G._parser.registerCsiHandler({final:"g"},(function(u){return G.tabClear(u)})),G._parser.registerCsiHandler({final:"h"},(function(u){return G.setMode(u)})),G._parser.registerCsiHandler({prefix:"?",final:"h"},(function(u){return G.setModePrivate(u)})),G._parser.registerCsiHandler({final:"l"},(function(u){return G.resetMode(u)})),G._parser.registerCsiHandler({prefix:"?",final:"l"},(function(u){return G.resetModePrivate(u)})),G._parser.registerCsiHandler({final:"m"},(function(u){return G.charAttributes(u)})),G._parser.registerCsiHandler({final:"n"},(function(u){return G.deviceStatus(u)})),G._parser.registerCsiHandler({prefix:"?",final:"n"},(function(u){return G.deviceStatusPrivate(u)})),G._parser.registerCsiHandler({intermediates:"!",final:"p"},(function(u){return G.softReset(u)})),G._parser.registerCsiHandler({intermediates:" ",final:"q"},(function(u){return G.setCursorStyle(u)})),G._parser.registerCsiHandler({final:"r"},(function(u){return G.setScrollRegion(u)})),G._parser.registerCsiHandler({final:"s"},(function(u){return G.saveCursor(u)})),G._parser.registerCsiHandler({final:"t"},(function(u){return G.windowOptions(u)})),G._parser.registerCsiHandler({final:"u"},(function(u){return G.restoreCursor(u)})),G._parser.registerCsiHandler({intermediates:"'",final:"}"},(function(u){return G.insertColumns(u)})),G._parser.registerCsiHandler({intermediates:"'",final:"~"},(function(u){return G.deleteColumns(u)})),G._parser.setExecuteHandler(P.C0.BEL,(function(){return G.bell()})),G._parser.setExecuteHandler(P.C0.LF,(function(){return G.lineFeed()})),G._parser.setExecuteHandler(P.C0.VT,(function(){return G.lineFeed()})),G._parser.setExecuteHandler(P.C0.FF,(function(){return G.lineFeed()})),G._parser.setExecuteHandler(P.C0.CR,(function(){return G.carriageReturn()})),G._parser.setExecuteHandler(P.C0.BS,(function(){return G.backspace()})),G._parser.setExecuteHandler(P.C0.HT,(function(){return G.tab()})),G._parser.setExecuteHandler(P.C0.SO,(function(){return G.shiftOut()})),G._parser.setExecuteHandler(P.C0.SI,(function(){return G.shiftIn()})),G._parser.setExecuteHandler(P.C1.IND,(function(){return G.index()})),G._parser.setExecuteHandler(P.C1.NEL,(function(){return G.nextLine()})),G._parser.setExecuteHandler(P.C1.HTS,(function(){return G.tabSet()})),G._parser.registerOscHandler(0,new X.OscHandler((function(u){return G.setTitle(u),G.setIconName(u),!0}))),G._parser.registerOscHandler(1,new X.OscHandler((function(u){return G.setIconName(u)}))),G._parser.registerOscHandler(2,new X.OscHandler((function(u){return G.setTitle(u)}))),G._parser.registerOscHandler(4,new X.OscHandler((function(u){return G.setOrReportIndexedColor(u)}))),G._parser.registerOscHandler(10,new X.OscHandler((function(u){return G.setOrReportFgColor(u)}))),G._parser.registerOscHandler(11,new X.OscHandler((function(u){return G.setOrReportBgColor(u)}))),G._parser.registerOscHandler(12,new X.OscHandler((function(u){return G.setOrReportCursorColor(u)}))),G._parser.registerOscHandler(104,new X.OscHandler((function(u){return G.restoreIndexedColor(u)}))),G._parser.registerOscHandler(110,new X.OscHandler((function(u){return G.restoreFgColor(u)}))),G._parser.registerOscHandler(111,new X.OscHandler((function(u){return G.restoreBgColor(u)}))),G._parser.registerOscHandler(112,new X.OscHandler((function(u){return G.restoreCursorColor(u)}))),G._parser.registerEscHandler({final:"7"},(function(){return G.saveCursor()})),G._parser.registerEscHandler({final:"8"},(function(){return G.restoreCursor()})),G._parser.registerEscHandler({final:"D"},(function(){return G.index()})),G._parser.registerEscHandler({final:"E"},(function(){return G.nextLine()})),G._parser.registerEscHandler({final:"H"},(function(){return G.tabSet()})),G._parser.registerEscHandler({final:"M"},(function(){return G.reverseIndex()})),G._parser.registerEscHandler({final:"="},(function(){return G.keypadApplicationMode()})),G._parser.registerEscHandler({final:">"},(function(){return G.keypadNumericMode()})),G._parser.registerEscHandler({final:"c"},(function(){return G.fullReset()})),G._parser.registerEscHandler({final:"n"},(function(){return G.setgLevel(2)})),G._parser.registerEscHandler({final:"o"},(function(){return G.setgLevel(3)})),G._parser.registerEscHandler({final:"|"},(function(){return G.setgLevel(3)})),G._parser.registerEscHandler({final:"}"},(function(){return G.setgLevel(2)})),G._parser.registerEscHandler({final:"~"},(function(){return G.setgLevel(1)})),G._parser.registerEscHandler({intermediates:"%",final:"@"},(function(){return G.selectDefaultCharset()})),G._parser.registerEscHandler({intermediates:"%",final:"G"},(function(){return G.selectDefaultCharset()}));var m=function(u){Y._parser.registerEscHandler({intermediates:"(",final:u},(function(){return G.selectCharset("("+u)})),Y._parser.registerEscHandler({intermediates:")",final:u},(function(){return G.selectCharset(")"+u)})),Y._parser.registerEscHandler({intermediates:"*",final:u},(function(){return G.selectCharset("*"+u)})),Y._parser.registerEscHandler({intermediates:"+",final:u},(function(){return G.selectCharset("+"+u)})),Y._parser.registerEscHandler({intermediates:"-",final:u},(function(){return G.selectCharset("-"+u)})),Y._parser.registerEscHandler({intermediates:".",final:u},(function(){return G.selectCharset("."+u)})),Y._parser.registerEscHandler({intermediates:"/",final:u},(function(){return G.selectCharset("/"+u)}))},Y=this;for(var J in I.CHARSETS)m(J);return G._parser.registerEscHandler({intermediates:"#",final:"8"},(function(){return G.screenAlignmentPattern()})),G._parser.setErrorHandler((function(u){return G._logService.error("Parsing error: ",u),u})),G._parser.registerDcsHandler({intermediates:"$",final:"q"},new ee(G._bufferService,G._coreService,G._logService,G._optionsService)),G}return k(t,u),Object.defineProperty(t.prototype,"onRequestBell",{get:function(){return this._onRequestBell.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestRefreshRows",{get:function(){return this._onRequestRefreshRows.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestReset",{get:function(){return this._onRequestReset.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestSendFocus",{get:function(){return this._onRequestSendFocus.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestSyncScrollBar",{get:function(){return this._onRequestSyncScrollBar.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestWindowsOptionsReport",{get:function(){return this._onRequestWindowsOptionsReport.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onA11yChar",{get:function(){return this._onA11yChar.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onA11yTab",{get:function(){return this._onA11yTab.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onColor",{get:function(){return this._onColor.event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){u.prototype.dispose.call(this)},t.prototype._preserveStack=function(u,y,b,x){this._parseStack.paused=!0,this._parseStack.cursorStartX=u,this._parseStack.cursorStartY=y,this._parseStack.decodedLength=b,this._parseStack.position=x},t.prototype._logSlowResolvingAsync=function(u){this._logService.logLevel<=G.LogLevelEnum.WARN&&Promise.race([u,new Promise((function(u,y){return setTimeout((function(){return y("#SLOW_TIMEOUT")}),5e3)}))]).catch((function(u){if("#SLOW_TIMEOUT"!==u)throw u;console.warn("async parser handler taking longer than 5000 ms")}))},t.prototype.parse=function(u,y){var b,x=this._activeBuffer.x,k=this._activeBuffer.y,B=0,P=this._parseStack.paused;if(P){if(b=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,y))return this._logSlowResolvingAsync(b),b;x=this._parseStack.cursorStartX,k=this._parseStack.cursorStartY,this._parseStack.paused=!1,u.length>Q&&(B=this._parseStack.position+Q)}if(this._logService.logLevel<=G.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+("string"==typeof u?' "'+u+'"':' "'+Array.prototype.map.call(u,(function(u){return String.fromCharCode(u)})).join("")+'"'),"string"==typeof u?u.split("").map((function(u){return u.charCodeAt(0)})):u),this._parseBuffer.length<u.length&&this._parseBuffer.length<Q&&(this._parseBuffer=new Uint32Array(Math.min(u.length,Q))),P||this._dirtyRowService.clearRange(),u.length>Q)for(var I=B;I<u.length;I+=Q){var H=I+Q<u.length?I+Q:u.length,j="string"==typeof u?this._stringDecoder.decode(u.substring(I,H),this._parseBuffer):this._utf8Decoder.decode(u.subarray(I,H),this._parseBuffer);if(b=this._parser.parse(this._parseBuffer,j))return this._preserveStack(x,k,j,I),this._logSlowResolvingAsync(b),b}else if(!P&&(j="string"==typeof u?this._stringDecoder.decode(u,this._parseBuffer):this._utf8Decoder.decode(u,this._parseBuffer),b=this._parser.parse(this._parseBuffer,j)))return this._preserveStack(x,k,j,0),this._logSlowResolvingAsync(b),b;this._activeBuffer.x===x&&this._activeBuffer.y===k||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowService.start,this._dirtyRowService.end)},t.prototype.print=function(u,y,b){var x,k,B=this._charsetService.charset,P=this._optionsService.rawOptions.screenReaderMode,I=this._bufferService.cols,H=this._coreService.decPrivateModes.wraparound,j=this._coreService.modes.insertMode,N=this._curAttrData,W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowService.markDirty(this._activeBuffer.y),this._activeBuffer.x&&b-y>0&&2===W.getWidth(this._activeBuffer.x-1)&&W.setCellFromCodePoint(this._activeBuffer.x-1,0,1,N.fg,N.bg,N.extended);for(var U=y;U<b;++U){if(x=u[U],k=this._unicodeService.wcwidth(x),x<127&&B){var K=B[String.fromCharCode(x)];K&&(x=K.charCodeAt(0))}if(P&&this._onA11yChar.fire((0,q.stringFromCodePoint)(x)),k||!this._activeBuffer.x){if(this._activeBuffer.x+k-1>=I)if(H){for(;this._activeBuffer.x<I;)W.setCellFromCodePoint(this._activeBuffer.x++,0,1,N.fg,N.bg,N.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=I-1,2===k)continue;if(j&&(W.insertCells(this._activeBuffer.x,k,this._activeBuffer.getNullCell(N),N),2===W.getWidth(I-1)&&W.setCellFromCodePoint(I-1,z.NULL_CELL_CODE,z.NULL_CELL_WIDTH,N.fg,N.bg,N.extended)),W.setCellFromCodePoint(this._activeBuffer.x++,x,k,N.fg,N.bg,N.extended),k>0)for(;--k;)W.setCellFromCodePoint(this._activeBuffer.x++,0,0,N.fg,N.bg,N.extended)}else W.getWidth(this._activeBuffer.x-1)?W.addCodepointToCell(this._activeBuffer.x-1,x):W.addCodepointToCell(this._activeBuffer.x-2,x)}b-y>0&&(W.loadCell(this._activeBuffer.x-1,this._workCell),2===this._workCell.getWidth()||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<I&&b-y>0&&0===W.getWidth(this._activeBuffer.x)&&!W.hasContent(this._activeBuffer.x)&&W.setCellFromCodePoint(this._activeBuffer.x,0,1,N.fg,N.bg,N.extended),this._dirtyRowService.markDirty(this._activeBuffer.y)},t.prototype.registerCsiHandler=function(u,y){var b=this;return"t"!==u.final||u.prefix||u.intermediates?this._parser.registerCsiHandler(u,y):this._parser.registerCsiHandler(u,(function(u){return!w(u.params[0],b._optionsService.rawOptions.windowOptions)||y(u)}))},t.prototype.registerDcsHandler=function(u,y){return this._parser.registerDcsHandler(u,new Y.DcsHandler(y))},t.prototype.registerEscHandler=function(u,y){return this._parser.registerEscHandler(u,y)},t.prototype.registerOscHandler=function(u,y){return this._parser.registerOscHandler(u,new X.OscHandler(y))},t.prototype.bell=function(){return this._onRequestBell.fire(),!0},t.prototype.lineFeed=function(){return this._dirtyRowService.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowService.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0},t.prototype.carriageReturn=function(){return this._activeBuffer.x=0,!0},t.prototype.backspace=function(){var u;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(0===this._activeBuffer.x&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(null===(u=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))||void 0===u?void 0:u.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;var y=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);y.hasWidth(this._activeBuffer.x)&&!y.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0},t.prototype.tab=function(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;var u=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-u),!0},t.prototype.shiftOut=function(){return this._charsetService.setgLevel(1),!0},t.prototype.shiftIn=function(){return this._charsetService.setgLevel(0),!0},t.prototype._restrictCursor=function(u){void 0===u&&(u=this._bufferService.cols-1),this._activeBuffer.x=Math.min(u,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowService.markDirty(this._activeBuffer.y)},t.prototype._setCursor=function(u,y){this._dirtyRowService.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=u,this._activeBuffer.y=this._activeBuffer.scrollTop+y):(this._activeBuffer.x=u,this._activeBuffer.y=y),this._restrictCursor(),this._dirtyRowService.markDirty(this._activeBuffer.y)},t.prototype._moveCursor=function(u,y){this._restrictCursor(),this._setCursor(this._activeBuffer.x+u,this._activeBuffer.y+y)},t.prototype.cursorUp=function(u){var y=this._activeBuffer.y-this._activeBuffer.scrollTop;return y>=0?this._moveCursor(0,-Math.min(y,u.params[0]||1)):this._moveCursor(0,-(u.params[0]||1)),!0},t.prototype.cursorDown=function(u){var y=this._activeBuffer.scrollBottom-this._activeBuffer.y;return y>=0?this._moveCursor(0,Math.min(y,u.params[0]||1)):this._moveCursor(0,u.params[0]||1),!0},t.prototype.cursorForward=function(u){return this._moveCursor(u.params[0]||1,0),!0},t.prototype.cursorBackward=function(u){return this._moveCursor(-(u.params[0]||1),0),!0},t.prototype.cursorNextLine=function(u){return this.cursorDown(u),this._activeBuffer.x=0,!0},t.prototype.cursorPrecedingLine=function(u){return this.cursorUp(u),this._activeBuffer.x=0,!0},t.prototype.cursorCharAbsolute=function(u){return this._setCursor((u.params[0]||1)-1,this._activeBuffer.y),!0},t.prototype.cursorPosition=function(u){return this._setCursor(u.length>=2?(u.params[1]||1)-1:0,(u.params[0]||1)-1),!0},t.prototype.charPosAbsolute=function(u){return this._setCursor((u.params[0]||1)-1,this._activeBuffer.y),!0},t.prototype.hPositionRelative=function(u){return this._moveCursor(u.params[0]||1,0),!0},t.prototype.linePosAbsolute=function(u){return this._setCursor(this._activeBuffer.x,(u.params[0]||1)-1),!0},t.prototype.vPositionRelative=function(u){return this._moveCursor(0,u.params[0]||1),!0},t.prototype.hVPosition=function(u){return this.cursorPosition(u),!0},t.prototype.tabClear=function(u){var y=u.params[0];return 0===y?delete this._activeBuffer.tabs[this._activeBuffer.x]:3===y&&(this._activeBuffer.tabs={}),!0},t.prototype.cursorForwardTab=function(u){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var y=u.params[0]||1;y--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0},t.prototype.cursorBackwardTab=function(u){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var y=u.params[0]||1;y--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0},t.prototype._eraseInBufferLine=function(u,y,b,x){void 0===x&&(x=!1);var k=this._activeBuffer.lines.get(this._activeBuffer.ybase+u);k.replaceCells(y,b,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),x&&(k.isWrapped=!1)},t.prototype._resetBufferLine=function(u){var y=this._activeBuffer.lines.get(this._activeBuffer.ybase+u);y.fill(this._activeBuffer.getNullCell(this._eraseAttrData())),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+u),y.isWrapped=!1},t.prototype.eraseInDisplay=function(u){var y;switch(this._restrictCursor(this._bufferService.cols),u.params[0]){case 0:for(y=this._activeBuffer.y,this._dirtyRowService.markDirty(y),this._eraseInBufferLine(y++,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x);y<this._bufferService.rows;y++)this._resetBufferLine(y);this._dirtyRowService.markDirty(y);break;case 1:for(y=this._activeBuffer.y,this._dirtyRowService.markDirty(y),this._eraseInBufferLine(y,0,this._activeBuffer.x+1,!0),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(y+1).isWrapped=!1);y--;)this._resetBufferLine(y);this._dirtyRowService.markDirty(0);break;case 2:for(y=this._bufferService.rows,this._dirtyRowService.markDirty(y-1);y--;)this._resetBufferLine(y);this._dirtyRowService.markDirty(0);break;case 3:var b=this._activeBuffer.lines.length-this._bufferService.rows;b>0&&(this._activeBuffer.lines.trimStart(b),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-b,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-b,0),this._onScroll.fire(0))}return!0},t.prototype.eraseInLine=function(u){switch(this._restrictCursor(this._bufferService.cols),u.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0)}return this._dirtyRowService.markDirty(this._activeBuffer.y),!0},t.prototype.insertLines=function(u){this._restrictCursor();var y=u.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var b=this._activeBuffer.ybase+this._activeBuffer.y,x=this._bufferService.rows-1-this._activeBuffer.scrollBottom,k=this._bufferService.rows-1+this._activeBuffer.ybase-x+1;y--;)this._activeBuffer.lines.splice(k-1,1),this._activeBuffer.lines.splice(b,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0},t.prototype.deleteLines=function(u){this._restrictCursor();var y=u.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;var b,x=this._activeBuffer.ybase+this._activeBuffer.y;for(b=this._bufferService.rows-1-this._activeBuffer.scrollBottom,b=this._bufferService.rows-1+this._activeBuffer.ybase-b;y--;)this._activeBuffer.lines.splice(x,1),this._activeBuffer.lines.splice(b,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0},t.prototype.insertChars=function(u){this._restrictCursor();var y=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return y&&(y.insertCells(this._activeBuffer.x,u.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},t.prototype.deleteChars=function(u){this._restrictCursor();var y=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return y&&(y.deleteCells(this._activeBuffer.x,u.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},t.prototype.scrollUp=function(u){for(var y=u.params[0]||1;y--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.scrollDown=function(u){for(var y=u.params[0]||1;y--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(W.DEFAULT_ATTR_DATA));return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.scrollLeft=function(u){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var y=u.params[0]||1,b=this._activeBuffer.scrollTop;b<=this._activeBuffer.scrollBottom;++b){var x=this._activeBuffer.lines.get(this._activeBuffer.ybase+b);x.deleteCells(0,y,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),x.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.scrollRight=function(u){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var y=u.params[0]||1,b=this._activeBuffer.scrollTop;b<=this._activeBuffer.scrollBottom;++b){var x=this._activeBuffer.lines.get(this._activeBuffer.ybase+b);x.insertCells(0,y,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),x.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.insertColumns=function(u){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var y=u.params[0]||1,b=this._activeBuffer.scrollTop;b<=this._activeBuffer.scrollBottom;++b){var x=this._activeBuffer.lines.get(this._activeBuffer.ybase+b);x.insertCells(this._activeBuffer.x,y,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),x.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.deleteColumns=function(u){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var y=u.params[0]||1,b=this._activeBuffer.scrollTop;b<=this._activeBuffer.scrollBottom;++b){var x=this._activeBuffer.lines.get(this._activeBuffer.ybase+b);x.deleteCells(this._activeBuffer.x,y,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),x.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.eraseChars=function(u){this._restrictCursor();var y=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return y&&(y.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(u.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},t.prototype.repeatPrecedingCharacter=function(u){if(!this._parser.precedingCodepoint)return!0;for(var y=u.params[0]||1,b=new Uint32Array(y),x=0;x<y;++x)b[x]=this._parser.precedingCodepoint;return this.print(b,0,b.length),!0},t.prototype.sendDeviceAttributesPrimary=function(u){return u.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(P.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(P.C0.ESC+"[?6c")),!0},t.prototype.sendDeviceAttributesSecondary=function(u){return u.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(P.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(P.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(u.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(P.C0.ESC+"[>83;40003;0c")),!0},t.prototype._is=function(u){return 0===(this._optionsService.rawOptions.termName+"").indexOf(u)},t.prototype.setMode=function(u){for(var y=0;y<u.length;y++)4===u.params[y]&&(this._coreService.modes.insertMode=!0);return!0},t.prototype.setModePrivate=function(u){for(var y=0;y<u.length;y++)switch(u.params[y]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,I.DEFAULT_CHARSET),this._charsetService.setgCharset(1,I.DEFAULT_CHARSET),this._charsetService.setgCharset(2,I.DEFAULT_CHARSET),this._charsetService.setgCharset(3,I.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0},t.prototype.resetMode=function(u){for(var y=0;y<u.length;y++)4===u.params[y]&&(this._coreService.modes.insertMode=!1);return!0},t.prototype.resetModePrivate=function(u){for(var y=0;y<u.length;y++)switch(u.params[y]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),1049===u.params[y]&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0},t.prototype._updateAttrColor=function(u,y,b,x,k){return 2===y?(u|=50331648,u&=-16777216,u|=V.AttributeData.fromColorRGB([b,x,k])):5===y&&(u&=-50331904,u|=33554432|255&b),u},t.prototype._extractColor=function(u,y,b){var x=[0,0,-1,0,0,0],k=0,B=0;do{if(x[B+k]=u.params[y+B],u.hasSubParams(y+B)){var P=u.getSubParams(y+B),I=0;do{5===x[1]&&(k=1),x[B+I+1+k]=P[I]}while(++I<P.length&&I+B+1+k<x.length);break}if(5===x[1]&&B+k>=2||2===x[1]&&B+k>=5)break;x[1]&&(k=1)}while(++B+y<u.length&&B+k<x.length);for(I=2;I<x.length;++I)-1===x[I]&&(x[I]=0);switch(x[0]){case 38:b.fg=this._updateAttrColor(b.fg,x[1],x[3],x[4],x[5]);break;case 48:b.bg=this._updateAttrColor(b.bg,x[1],x[3],x[4],x[5]);break;case 58:b.extended=b.extended.clone(),b.extended.underlineColor=this._updateAttrColor(b.extended.underlineColor,x[1],x[3],x[4],x[5])}return B},t.prototype._processUnderline=function(u,y){y.extended=y.extended.clone(),(!~u||u>5)&&(u=1),y.extended.underlineStyle=u,y.fg|=268435456,0===u&&(y.fg&=-268435457),y.updateExtended()},t.prototype.charAttributes=function(u){if(1===u.length&&0===u.params[0])return this._curAttrData.fg=W.DEFAULT_ATTR_DATA.fg,this._curAttrData.bg=W.DEFAULT_ATTR_DATA.bg,!0;for(var y,b=u.length,x=this._curAttrData,k=0;k<b;k++)(y=u.params[k])>=30&&y<=37?(x.fg&=-50331904,x.fg|=16777216|y-30):y>=40&&y<=47?(x.bg&=-50331904,x.bg|=16777216|y-40):y>=90&&y<=97?(x.fg&=-50331904,x.fg|=16777224|y-90):y>=100&&y<=107?(x.bg&=-50331904,x.bg|=16777224|y-100):0===y?(x.fg=W.DEFAULT_ATTR_DATA.fg,x.bg=W.DEFAULT_ATTR_DATA.bg):1===y?x.fg|=134217728:3===y?x.bg|=67108864:4===y?(x.fg|=268435456,this._processUnderline(u.hasSubParams(k)?u.getSubParams(k)[0]:1,x)):5===y?x.fg|=536870912:7===y?x.fg|=67108864:8===y?x.fg|=1073741824:9===y?x.fg|=2147483648:2===y?x.bg|=134217728:21===y?this._processUnderline(2,x):22===y?(x.fg&=-134217729,x.bg&=-134217729):23===y?x.bg&=-67108865:24===y?x.fg&=-268435457:25===y?x.fg&=-536870913:27===y?x.fg&=-67108865:28===y?x.fg&=-1073741825:29===y?x.fg&=2147483647:39===y?(x.fg&=-67108864,x.fg|=16777215&W.DEFAULT_ATTR_DATA.fg):49===y?(x.bg&=-67108864,x.bg|=16777215&W.DEFAULT_ATTR_DATA.bg):38===y||48===y||58===y?k+=this._extractColor(u,k,x):59===y?(x.extended=x.extended.clone(),x.extended.underlineColor=-1,x.updateExtended()):100===y?(x.fg&=-67108864,x.fg|=16777215&W.DEFAULT_ATTR_DATA.fg,x.bg&=-67108864,x.bg|=16777215&W.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",y);return!0},t.prototype.deviceStatus=function(u){switch(u.params[0]){case 5:this._coreService.triggerDataEvent(P.C0.ESC+"[0n");break;case 6:var y=this._activeBuffer.y+1,b=this._activeBuffer.x+1;this._coreService.triggerDataEvent(P.C0.ESC+"["+y+";"+b+"R")}return!0},t.prototype.deviceStatusPrivate=function(u){if(6===u.params[0]){var y=this._activeBuffer.y+1,b=this._activeBuffer.x+1;this._coreService.triggerDataEvent(P.C0.ESC+"[?"+y+";"+b+"R")}return!0},t.prototype.softReset=function(u){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=W.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0},t.prototype.setCursorStyle=function(u){var y=u.params[0]||1;switch(y){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}var b=y%2==1;return this._optionsService.options.cursorBlink=b,!0},t.prototype.setScrollRegion=function(u){var y,b=u.params[0]||1;return(u.length<2||(y=u.params[1])>this._bufferService.rows||0===y)&&(y=this._bufferService.rows),y>b&&(this._activeBuffer.scrollTop=b-1,this._activeBuffer.scrollBottom=y-1,this._setCursor(0,0)),!0},t.prototype.windowOptions=function(u){if(!w(u.params[0],this._optionsService.rawOptions.windowOptions))return!0;var y=u.length>1?u.params[1]:0;switch(u.params[0]){case 14:2!==y&&this._onRequestWindowsOptionsReport.fire(B.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(B.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(P.C0.ESC+"[8;"+this._bufferService.rows+";"+this._bufferService.cols+"t");break;case 22:0!==y&&2!==y||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),0!==y&&1!==y||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:0!==y&&2!==y||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),0!==y&&1!==y||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0},t.prototype.saveCursor=function(u){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0},t.prototype.restoreCursor=function(u){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0},t.prototype.setTitle=function(u){return this._windowTitle=u,this._onTitleChange.fire(u),!0},t.prototype.setIconName=function(u){return this._iconName=u,!0},t.prototype.setOrReportIndexedColor=function(u){for(var y=[],b=u.split(";");b.length>1;){var x=b.shift(),k=b.shift();if(/^\d+$/.exec(x)){var B=parseInt(x);if(0<=B&&B<256)if("?"===k)y.push({type:0,index:B});else{var P=(0,J.parseColor)(k);P&&y.push({type:1,index:B,color:P})}}}return y.length&&this._onColor.fire(y),!0},t.prototype._setOrReportSpecialColor=function(u,y){for(var b=u.split(";"),x=0;x<b.length&&!(y>=this._specialColors.length);++x,++y)if("?"===b[x])this._onColor.fire([{type:0,index:this._specialColors[y]}]);else{var k=(0,J.parseColor)(b[x]);k&&this._onColor.fire([{type:1,index:this._specialColors[y],color:k}])}return!0},t.prototype.setOrReportFgColor=function(u){return this._setOrReportSpecialColor(u,0)},t.prototype.setOrReportBgColor=function(u){return this._setOrReportSpecialColor(u,1)},t.prototype.setOrReportCursorColor=function(u){return this._setOrReportSpecialColor(u,2)},t.prototype.restoreIndexedColor=function(u){if(!u)return this._onColor.fire([{type:2}]),!0;for(var y=[],b=u.split(";"),x=0;x<b.length;++x)if(/^\d+$/.exec(b[x])){var k=parseInt(b[x]);0<=k&&k<256&&y.push({type:2,index:k})}return y.length&&this._onColor.fire(y),!0},t.prototype.restoreFgColor=function(u){return this._onColor.fire([{type:2,index:256}]),!0},t.prototype.restoreBgColor=function(u){return this._onColor.fire([{type:2,index:257}]),!0},t.prototype.restoreCursorColor=function(u){return this._onColor.fire([{type:2,index:258}]),!0},t.prototype.nextLine=function(){return this._activeBuffer.x=0,this.index(),!0},t.prototype.keypadApplicationMode=function(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0},t.prototype.keypadNumericMode=function(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0},t.prototype.selectDefaultCharset=function(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,I.DEFAULT_CHARSET),!0},t.prototype.selectCharset=function(u){return 2!==u.length?(this.selectDefaultCharset(),!0):("/"===u[0]||this._charsetService.setgCharset($[u[0]],I.CHARSETS[u[1]]||I.DEFAULT_CHARSET),!0)},t.prototype.index=function(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0},t.prototype.tabSet=function(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0},t.prototype.reverseIndex=function(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){var u=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,u,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0},t.prototype.fullReset=function(){return this._parser.reset(),this._onRequestReset.fire(),!0},t.prototype.reset=function(){this._curAttrData=W.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=W.DEFAULT_ATTR_DATA.clone()},t.prototype._eraseAttrData=function(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal},t.prototype.setgLevel=function(u){return this._charsetService.setgLevel(u),!0},t.prototype.screenAlignmentPattern=function(){var u=new K.CellData;u.content=4194373,u.fg=this._curAttrData.fg,u.bg=this._curAttrData.bg,this._setCursor(0,0);for(var y=0;y<this._bufferService.rows;++y){var b=this._activeBuffer.ybase+this._activeBuffer.y+y,x=this._activeBuffer.lines.get(b);x&&(x.fill(u),x.isWrapped=!1)}return this._dirtyRowService.markAllDirty(),this._setCursor(0,0),!0},t}(j.Disposable);y.InputHandler=te},844:function(u,y){var b=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.getDisposeArrayDisposable=y.disposeArray=y.Disposable=void 0;var x=function(){function e(){this._disposables=[],this._isDisposed=!1}return e.prototype.dispose=function(){var u,y;this._isDisposed=!0;try{for(var x=b(this._disposables),k=x.next();!k.done;k=x.next())k.value.dispose()}catch(y){u={error:y}}finally{try{k&&!k.done&&(y=x.return)&&y.call(x)}finally{if(u)throw u.error}}this._disposables.length=0},e.prototype.register=function(u){return this._disposables.push(u),u},e.prototype.unregister=function(u){var y=this._disposables.indexOf(u);-1!==y&&this._disposables.splice(y,1)},e}();function n(u){var y,x;try{for(var k=b(u),B=k.next();!B.done;B=k.next())B.value.dispose()}catch(u){y={error:u}}finally{try{B&&!B.done&&(x=k.return)&&x.call(k)}finally{if(y)throw y.error}}u.length=0}y.Disposable=x,y.disposeArray=n,y.getDisposeArrayDisposable=function(u){return{dispose:function(){return n(u)}}}},6114:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.isLinux=y.isWindows=y.isIphone=y.isIpad=y.isMac=y.isSafari=y.isLegacyEdge=y.isFirefox=void 0;var b="undefined"==typeof navigator,x=b?"node":navigator.userAgent,k=b?"node":navigator.platform;y.isFirefox=x.includes("Firefox"),y.isLegacyEdge=x.includes("Edge"),y.isSafari=/^((?!chrome|android).)*safari/i.test(x),y.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(k),y.isIpad="iPad"===k,y.isIphone="iPhone"===k,y.isWindows=["Windows","Win16","Win32","WinCE"].includes(k),y.isLinux=k.indexOf("Linux")>=0},6106:function(u,y){var b=this&&this.__generator||function(u,y){var b,x,k,B,P={label:0,sent:function(){if(1&k[0])throw k[1];return k[1]},trys:[],ops:[]};return B={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(B[Symbol.iterator]=function(){return this}),B;function a(B){return function(I){return function(B){if(b)throw new TypeError("Generator is already executing.");for(;P;)try{if(b=1,x&&(k=2&B[0]?x.return:B[0]?x.throw||((k=x.return)&&k.call(x),0):x.next)&&!(k=k.call(x,B[1])).done)return k;switch(x=0,k&&(B=[2&B[0],k.value]),B[0]){case 0:case 1:k=B;break;case 4:return P.label++,{value:B[1],done:!1};case 5:P.label++,x=B[1],B=[0];continue;case 7:B=P.ops.pop(),P.trys.pop();continue;default:if(!((k=(k=P.trys).length>0&&k[k.length-1])||6!==B[0]&&2!==B[0])){P=0;continue}if(3===B[0]&&(!k||B[1]>k[0]&&B[1]<k[3])){P.label=B[1];break}if(6===B[0]&&P.label<k[1]){P.label=k[1],k=B;break}if(k&&P.label<k[2]){P.label=k[2],P.ops.push(B);break}k[2]&&P.ops.pop(),P.trys.pop();continue}B=y.call(u,P)}catch(u){B=[6,u],x=0}finally{b=k=0}if(5&B[0])throw B[1];return{value:B[0]?B[1]:void 0,done:!0}}([B,I])}}};Object.defineProperty(y,"__esModule",{value:!0}),y.SortedList=void 0;var x=function(){function e(u){this._getKey=u,this._array=[]}return e.prototype.clear=function(){this._array.length=0},e.prototype.insert=function(u){if(0!==this._array.length){var y=this._search(this._getKey(u),0,this._array.length-1);this._array.splice(y,0,u)}else this._array.push(u)},e.prototype.delete=function(u){if(0===this._array.length)return!1;var y=this._getKey(u),b=this._search(y,0,this._array.length-1);if(this._getKey(this._array[b])!==y)return!1;do{if(this._array[b]===u)return this._array.splice(b,1),!0}while(++b<this._array.length&&this._getKey(this._array[b])===y);return!1},e.prototype.getKeyIterator=function(u){var y;return b(this,(function(b){switch(b.label){case 0:if(0===this._array.length)return[2];if((y=this._search(u,0,this._array.length-1))<0||y>=this._array.length)return[2];if(this._getKey(this._array[y])!==u)return[2];b.label=1;case 1:return[4,this._array[y]];case 2:b.sent(),b.label=3;case 3:if(++y<this._array.length&&this._getKey(this._array[y])===u)return[3,1];b.label=4;case 4:return[2]}}))},e.prototype.values=function(){return this._array.values()},e.prototype._search=function(u,y,b){if(b<y)return y;var x=Math.floor((y+b)/2);if(this._getKey(this._array[x])>u)return this._search(u,y,x-1);if(this._getKey(this._array[x])<u)return this._search(u,x+1,b);for(;x>0&&this._getKey(this._array[x-1])===u;)x--;return x},e}();y.SortedList=x},8273:(u,y)=>{function r(u,y,b,x){if(void 0===b&&(b=0),void 0===x&&(x=u.length),b>=u.length)return u;b=(u.length+b)%u.length,x=x>=u.length?u.length:(u.length+x)%u.length;for(var k=b;k<x;++k)u[k]=y;return u}Object.defineProperty(y,"__esModule",{value:!0}),y.concat=y.fillFallback=y.fill=void 0,y.fill=function(u,y,b,x){return u.fill?u.fill(y,b,x):r(u,y,b,x)},y.fillFallback=r,y.concat=function(u,y){var b=new u.constructor(u.length+y.length);return b.set(u),b.set(y,u.length),b}},9282:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.updateWindowsModeWrappedState=void 0;var x=b(643);y.updateWindowsModeWrappedState=function(u){var y=u.buffer.lines.get(u.buffer.ybase+u.buffer.y-1),b=null==y?void 0:y.get(u.cols-1),k=u.buffer.lines.get(u.buffer.ybase+u.buffer.y);k&&b&&(k.isWrapped=b[x.CHAR_DATA_CODE_INDEX]!==x.NULL_CELL_CODE&&b[x.CHAR_DATA_CODE_INDEX]!==x.WHITESPACE_CELL_CODE)}},3734:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.ExtendedAttrs=y.AttributeData=void 0;var b=function(){function e(){this.fg=0,this.bg=0,this.extended=new x}return e.toColorRGB=function(u){return[u>>>16&255,u>>>8&255,255&u]},e.fromColorRGB=function(u){return(255&u[0])<<16|(255&u[1])<<8|255&u[2]},e.prototype.clone=function(){var u=new e;return u.fg=this.fg,u.bg=this.bg,u.extended=this.extended.clone(),u},e.prototype.isInverse=function(){return 67108864&this.fg},e.prototype.isBold=function(){return 134217728&this.fg},e.prototype.isUnderline=function(){return 268435456&this.fg},e.prototype.isBlink=function(){return 536870912&this.fg},e.prototype.isInvisible=function(){return 1073741824&this.fg},e.prototype.isItalic=function(){return 67108864&this.bg},e.prototype.isDim=function(){return 134217728&this.bg},e.prototype.isStrikethrough=function(){return 2147483648&this.fg},e.prototype.getFgColorMode=function(){return 50331648&this.fg},e.prototype.getBgColorMode=function(){return 50331648&this.bg},e.prototype.isFgRGB=function(){return 50331648==(50331648&this.fg)},e.prototype.isBgRGB=function(){return 50331648==(50331648&this.bg)},e.prototype.isFgPalette=function(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)},e.prototype.isBgPalette=function(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)},e.prototype.isFgDefault=function(){return 0==(50331648&this.fg)},e.prototype.isBgDefault=function(){return 0==(50331648&this.bg)},e.prototype.isAttributeDefault=function(){return 0===this.fg&&0===this.bg},e.prototype.getFgColor=function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}},e.prototype.getBgColor=function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}},e.prototype.hasExtendedAttrs=function(){return 268435456&this.bg},e.prototype.updateExtended=function(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456},e.prototype.getUnderlineColor=function(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()},e.prototype.getUnderlineColorMode=function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()},e.prototype.isUnderlineColorRGB=function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648==(50331648&this.extended.underlineColor):this.isFgRGB()},e.prototype.isUnderlineColorPalette=function(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()},e.prototype.isUnderlineColorDefault=function(){return 268435456&this.bg&&~this.extended.underlineColor?0==(50331648&this.extended.underlineColor):this.isFgDefault()},e.prototype.getUnderlineStyle=function(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0},e}();y.AttributeData=b;var x=function(){function e(u,y){void 0===u&&(u=0),void 0===y&&(y=-1),this.underlineStyle=u,this.underlineColor=y}return e.prototype.clone=function(){return new e(this.underlineStyle,this.underlineColor)},e.prototype.isEmpty=function(){return 0===this.underlineStyle},e}();y.ExtendedAttrs=x},9092:function(u,y,b){var x=this&&this.__read||function(u,y){var b="function"==typeof Symbol&&u[Symbol.iterator];if(!b)return u;var x,k,B=b.call(u),P=[];try{for(;(void 0===y||y-- >0)&&!(x=B.next()).done;)P.push(x.value)}catch(u){k={error:u}}finally{try{x&&!x.done&&(b=B.return)&&b.call(B)}finally{if(k)throw k.error}}return P},k=this&&this.__spreadArray||function(u,y,b){if(b||2===arguments.length)for(var x,k=0,B=y.length;k<B;k++)!x&&k in y||(x||(x=Array.prototype.slice.call(y,0,k)),x[k]=y[k]);return u.concat(x||Array.prototype.slice.call(y))};Object.defineProperty(y,"__esModule",{value:!0}),y.BufferStringIterator=y.Buffer=y.MAX_BUFFER_SIZE=void 0;var B=b(6349),P=b(8437),I=b(511),H=b(643),j=b(4634),N=b(4863),q=b(7116),W=b(3734);y.MAX_BUFFER_SIZE=4294967295;var U=function(){function e(u,y,b){this._hasScrollback=u,this._optionsService=y,this._bufferService=b,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.savedY=0,this.savedX=0,this.savedCurAttrData=P.DEFAULT_ATTR_DATA.clone(),this.savedCharset=q.DEFAULT_CHARSET,this.markers=[],this._nullCell=I.CellData.fromCharData([0,H.NULL_CELL_CHAR,H.NULL_CELL_WIDTH,H.NULL_CELL_CODE]),this._whitespaceCell=I.CellData.fromCharData([0,H.WHITESPACE_CELL_CHAR,H.WHITESPACE_CELL_WIDTH,H.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new B.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}return e.prototype.getNullCell=function(u){return u?(this._nullCell.fg=u.fg,this._nullCell.bg=u.bg,this._nullCell.extended=u.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new W.ExtendedAttrs),this._nullCell},e.prototype.getWhitespaceCell=function(u){return u?(this._whitespaceCell.fg=u.fg,this._whitespaceCell.bg=u.bg,this._whitespaceCell.extended=u.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new W.ExtendedAttrs),this._whitespaceCell},e.prototype.getBlankLine=function(u,y){return new P.BufferLine(this._bufferService.cols,this.getNullCell(u),y)},Object.defineProperty(e.prototype,"hasScrollback",{get:function(){return this._hasScrollback&&this.lines.maxLength>this._rows},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCursorInViewport",{get:function(){var u=this.ybase+this.y-this.ydisp;return u>=0&&u<this._rows},enumerable:!1,configurable:!0}),e.prototype._getCorrectBufferLength=function(u){if(!this._hasScrollback)return u;var b=u+this._optionsService.rawOptions.scrollback;return b>y.MAX_BUFFER_SIZE?y.MAX_BUFFER_SIZE:b},e.prototype.fillViewportRows=function(u){if(0===this.lines.length){void 0===u&&(u=P.DEFAULT_ATTR_DATA);for(var y=this._rows;y--;)this.lines.push(this.getBlankLine(u))}},e.prototype.clear=function(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new B.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()},e.prototype.resize=function(u,y){var b=this.getNullCell(P.DEFAULT_ATTR_DATA),x=this._getCorrectBufferLength(y);if(x>this.lines.maxLength&&(this.lines.maxLength=x),this.lines.length>0){if(this._cols<u)for(var k=0;k<this.lines.length;k++)this.lines.get(k).resize(u,b);var B=0;if(this._rows<y)for(var I=this._rows;I<y;I++)this.lines.length<y+this.ybase&&(this._optionsService.rawOptions.windowsMode?this.lines.push(new P.BufferLine(u,b)):this.ybase>0&&this.lines.length<=this.ybase+this.y+B+1?(this.ybase--,B++,this.ydisp>0&&this.ydisp--):this.lines.push(new P.BufferLine(u,b)));else for(I=this._rows;I>y;I--)this.lines.length>y+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(x<this.lines.maxLength){var H=this.lines.length-x;H>0&&(this.lines.trimStart(H),this.ybase=Math.max(this.ybase-H,0),this.ydisp=Math.max(this.ydisp-H,0),this.savedY=Math.max(this.savedY-H,0)),this.lines.maxLength=x}this.x=Math.min(this.x,u-1),this.y=Math.min(this.y,y-1),B&&(this.y+=B),this.savedX=Math.min(this.savedX,u-1),this.scrollTop=0}if(this.scrollBottom=y-1,this._isReflowEnabled&&(this._reflow(u,y),this._cols>u))for(k=0;k<this.lines.length;k++)this.lines.get(k).resize(u,b);this._cols=u,this._rows=y},Object.defineProperty(e.prototype,"_isReflowEnabled",{get:function(){return this._hasScrollback&&!this._optionsService.rawOptions.windowsMode},enumerable:!1,configurable:!0}),e.prototype._reflow=function(u,y){this._cols!==u&&(u>this._cols?this._reflowLarger(u,y):this._reflowSmaller(u,y))},e.prototype._reflowLarger=function(u,y){var b=(0,j.reflowLargerGetLinesToRemove)(this.lines,this._cols,u,this.ybase+this.y,this.getNullCell(P.DEFAULT_ATTR_DATA));if(b.length>0){var x=(0,j.reflowLargerCreateNewLayout)(this.lines,b);(0,j.reflowLargerApplyNewLayout)(this.lines,x.layout),this._reflowLargerAdjustViewport(u,y,x.countRemoved)}},e.prototype._reflowLargerAdjustViewport=function(u,y,b){for(var x=this.getNullCell(P.DEFAULT_ATTR_DATA),k=b;k-- >0;)0===this.ybase?(this.y>0&&this.y--,this.lines.length<y&&this.lines.push(new P.BufferLine(u,x))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-b,0)},e.prototype._reflowSmaller=function(u,y){for(var b=this.getNullCell(P.DEFAULT_ATTR_DATA),B=[],I=0,H=this.lines.length-1;H>=0;H--){var N=this.lines.get(H);if(!(!N||!N.isWrapped&&N.getTrimmedLength()<=u)){for(var q=[N];N.isWrapped&&H>0;)N=this.lines.get(--H),q.unshift(N);var W=this.ybase+this.y;if(!(W>=H&&W<H+q.length)){var U,z=q[q.length-1].getTrimmedLength(),K=(0,j.reflowSmallerGetNewLineLengths)(q,this._cols,u),V=K.length-q.length;U=0===this.ybase&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+V):Math.max(0,this.lines.length-this.lines.maxLength+V);for(var G=[],X=0;X<V;X++){var Y=this.getBlankLine(P.DEFAULT_ATTR_DATA,!0);G.push(Y)}G.length>0&&(B.push({start:H+q.length+I,newLines:G}),I+=G.length),q.push.apply(q,k([],x(G),!1));var J=K.length-1,$=K[J];0===$&&($=K[--J]);for(var Q=q.length-V-1,ee=z;Q>=0;){var te=Math.min(ee,$);if(void 0===q[J])break;if(q[J].copyCellsFrom(q[Q],ee-te,$-te,te,!0),0==($-=te)&&($=K[--J]),0==(ee-=te)){Q--;var re=Math.max(Q,0);ee=(0,j.getWrappedLineTrimmedLength)(q,re,this._cols)}}for(X=0;X<q.length;X++)K[X]<u&&q[X].setCell(K[X],b);for(var ie=V-U;ie-- >0;)0===this.ybase?this.y<y-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+I)-y&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+V,this.ybase+y-1)}}}if(B.length>0){var ne=[],oe=[];for(X=0;X<this.lines.length;X++)oe.push(this.lines.get(X));var se=this.lines.length,ae=se-1,ce=0,le=B[ce];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+I);var he=0;for(X=Math.min(this.lines.maxLength-1,se+I-1);X>=0;X--)if(le&&le.start>ae+he){for(var ue=le.newLines.length-1;ue>=0;ue--)this.lines.set(X--,le.newLines[ue]);X++,ne.push({index:ae+1,amount:le.newLines.length}),he+=le.newLines.length,le=B[++ce]}else this.lines.set(X,oe[ae--]);var fe=0;for(X=ne.length-1;X>=0;X--)ne[X].index+=fe,this.lines.onInsertEmitter.fire(ne[X]),fe+=ne[X].amount;var _e=Math.max(0,se+I-this.lines.maxLength);_e>0&&this.lines.onTrimEmitter.fire(_e)}},e.prototype.stringIndexToBufferIndex=function(u,y,b){for(void 0===b&&(b=!1);y;){var x=this.lines.get(u);if(!x)return[-1,-1];for(var k=b?x.getTrimmedLength():x.length,B=0;B<k;++B)if(x.get(B)[H.CHAR_DATA_WIDTH_INDEX]&&(y-=x.get(B)[H.CHAR_DATA_CHAR_INDEX].length||1),y<0)return[u,B];u++}return[u,0]},e.prototype.translateBufferLineToString=function(u,y,b,x){void 0===b&&(b=0);var k=this.lines.get(u);return k?k.translateToString(y,b,x):""},e.prototype.getWrappedRangeForLine=function(u){for(var y=u,b=u;y>0&&this.lines.get(y).isWrapped;)y--;for(;b+1<this.lines.length&&this.lines.get(b+1).isWrapped;)b++;return{first:y,last:b}},e.prototype.setupTabStops=function(u){for(null!=u?this.tabs[u]||(u=this.prevStop(u)):(this.tabs={},u=0);u<this._cols;u+=this._optionsService.rawOptions.tabStopWidth)this.tabs[u]=!0},e.prototype.prevStop=function(u){for(null==u&&(u=this.x);!this.tabs[--u]&&u>0;);return u>=this._cols?this._cols-1:u<0?0:u},e.prototype.nextStop=function(u){for(null==u&&(u=this.x);!this.tabs[++u]&&u<this._cols;);return u>=this._cols?this._cols-1:u<0?0:u},e.prototype.clearMarkers=function(u){this._isClearing=!0;for(var y=0;y<this.markers.length;y++)this.markers[y].line===u&&(this.markers[y].dispose(),this.markers.splice(y--,1));this._isClearing=!1},e.prototype.clearAllMarkers=function(){this._isClearing=!0;for(var u=0;u<this.markers.length;u++)this.markers[u].dispose(),this.markers.splice(u--,1);this._isClearing=!1},e.prototype.addMarker=function(u){var y=this,b=new N.Marker(u);return this.markers.push(b),b.register(this.lines.onTrim((function(u){b.line-=u,b.line<0&&b.dispose()}))),b.register(this.lines.onInsert((function(u){b.line>=u.index&&(b.line+=u.amount)}))),b.register(this.lines.onDelete((function(u){b.line>=u.index&&b.line<u.index+u.amount&&b.dispose(),b.line>u.index&&(b.line-=u.amount)}))),b.register(b.onDispose((function(){return y._removeMarker(b)}))),b},e.prototype._removeMarker=function(u){this._isClearing||this.markers.splice(this.markers.indexOf(u),1)},e.prototype.iterator=function(u,y,b,x,k){return new z(this,u,y,b,x,k)},e}();y.Buffer=U;var z=function(){function e(u,y,b,x,k,B){void 0===b&&(b=0),void 0===x&&(x=u.lines.length),void 0===k&&(k=0),void 0===B&&(B=0),this._buffer=u,this._trimRight=y,this._startIndex=b,this._endIndex=x,this._startOverscan=k,this._endOverscan=B,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}return e.prototype.hasNext=function(){return this._current<this._endIndex},e.prototype.next=function(){var u=this._buffer.getWrappedRangeForLine(this._current);u.first<this._startIndex-this._startOverscan&&(u.first=this._startIndex-this._startOverscan),u.last>this._endIndex+this._endOverscan&&(u.last=this._endIndex+this._endOverscan),u.first=Math.max(u.first,0),u.last=Math.min(u.last,this._buffer.lines.length);for(var y="",b=u.first;b<=u.last;++b)y+=this._buffer.translateBufferLineToString(b,this._trimRight);return this._current=u.last+1,{range:u,content:y}},e}();y.BufferStringIterator=z},8437:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.BufferLine=y.DEFAULT_ATTR_DATA=void 0;var x=b(482),k=b(643),B=b(511),P=b(3734);y.DEFAULT_ATTR_DATA=Object.freeze(new P.AttributeData);var I=function(){function e(u,y,b){void 0===b&&(b=!1),this.isWrapped=b,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*u);for(var x=y||B.CellData.fromCharData([0,k.NULL_CELL_CHAR,k.NULL_CELL_WIDTH,k.NULL_CELL_CODE]),P=0;P<u;++P)this.setCell(P,x);this.length=u}return e.prototype.get=function(u){var y=this._data[3*u+0],b=2097151&y;return[this._data[3*u+1],2097152&y?this._combined[u]:b?(0,x.stringFromCodePoint)(b):"",y>>22,2097152&y?this._combined[u].charCodeAt(this._combined[u].length-1):b]},e.prototype.set=function(u,y){this._data[3*u+1]=y[k.CHAR_DATA_ATTR_INDEX],y[k.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[u]=y[1],this._data[3*u+0]=2097152|u|y[k.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*u+0]=y[k.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|y[k.CHAR_DATA_WIDTH_INDEX]<<22},e.prototype.getWidth=function(u){return this._data[3*u+0]>>22},e.prototype.hasWidth=function(u){return 12582912&this._data[3*u+0]},e.prototype.getFg=function(u){return this._data[3*u+1]},e.prototype.getBg=function(u){return this._data[3*u+2]},e.prototype.hasContent=function(u){return 4194303&this._data[3*u+0]},e.prototype.getCodePoint=function(u){var y=this._data[3*u+0];return 2097152&y?this._combined[u].charCodeAt(this._combined[u].length-1):2097151&y},e.prototype.isCombined=function(u){return 2097152&this._data[3*u+0]},e.prototype.getString=function(u){var y=this._data[3*u+0];return 2097152&y?this._combined[u]:2097151&y?(0,x.stringFromCodePoint)(2097151&y):""},e.prototype.loadCell=function(u,y){var b=3*u;return y.content=this._data[b+0],y.fg=this._data[b+1],y.bg=this._data[b+2],2097152&y.content&&(y.combinedData=this._combined[u]),268435456&y.bg&&(y.extended=this._extendedAttrs[u]),y},e.prototype.setCell=function(u,y){2097152&y.content&&(this._combined[u]=y.combinedData),268435456&y.bg&&(this._extendedAttrs[u]=y.extended),this._data[3*u+0]=y.content,this._data[3*u+1]=y.fg,this._data[3*u+2]=y.bg},e.prototype.setCellFromCodePoint=function(u,y,b,x,k,B){268435456&k&&(this._extendedAttrs[u]=B),this._data[3*u+0]=y|b<<22,this._data[3*u+1]=x,this._data[3*u+2]=k},e.prototype.addCodepointToCell=function(u,y){var b=this._data[3*u+0];2097152&b?this._combined[u]+=(0,x.stringFromCodePoint)(y):(2097151&b?(this._combined[u]=(0,x.stringFromCodePoint)(2097151&b)+(0,x.stringFromCodePoint)(y),b&=-2097152,b|=2097152):b=y|1<<22,this._data[3*u+0]=b)},e.prototype.insertCells=function(u,y,b,x){if((u%=this.length)&&2===this.getWidth(u-1)&&this.setCellFromCodePoint(u-1,0,1,(null==x?void 0:x.fg)||0,(null==x?void 0:x.bg)||0,(null==x?void 0:x.extended)||new P.ExtendedAttrs),y<this.length-u){for(var k=new B.CellData,I=this.length-u-y-1;I>=0;--I)this.setCell(u+y+I,this.loadCell(u+I,k));for(I=0;I<y;++I)this.setCell(u+I,b)}else for(I=u;I<this.length;++I)this.setCell(I,b);2===this.getWidth(this.length-1)&&this.setCellFromCodePoint(this.length-1,0,1,(null==x?void 0:x.fg)||0,(null==x?void 0:x.bg)||0,(null==x?void 0:x.extended)||new P.ExtendedAttrs)},e.prototype.deleteCells=function(u,y,b,x){if(u%=this.length,y<this.length-u){for(var k=new B.CellData,I=0;I<this.length-u-y;++I)this.setCell(u+I,this.loadCell(u+y+I,k));for(I=this.length-y;I<this.length;++I)this.setCell(I,b)}else for(I=u;I<this.length;++I)this.setCell(I,b);u&&2===this.getWidth(u-1)&&this.setCellFromCodePoint(u-1,0,1,(null==x?void 0:x.fg)||0,(null==x?void 0:x.bg)||0,(null==x?void 0:x.extended)||new P.ExtendedAttrs),0!==this.getWidth(u)||this.hasContent(u)||this.setCellFromCodePoint(u,0,1,(null==x?void 0:x.fg)||0,(null==x?void 0:x.bg)||0,(null==x?void 0:x.extended)||new P.ExtendedAttrs)},e.prototype.replaceCells=function(u,y,b,x){for(u&&2===this.getWidth(u-1)&&this.setCellFromCodePoint(u-1,0,1,(null==x?void 0:x.fg)||0,(null==x?void 0:x.bg)||0,(null==x?void 0:x.extended)||new P.ExtendedAttrs),y<this.length&&2===this.getWidth(y-1)&&this.setCellFromCodePoint(y,0,1,(null==x?void 0:x.fg)||0,(null==x?void 0:x.bg)||0,(null==x?void 0:x.extended)||new P.ExtendedAttrs);u<y&&u<this.length;)this.setCell(u++,b)},e.prototype.resize=function(u,y){if(u!==this.length){if(u>this.length){var b=new Uint32Array(3*u);this.length&&(3*u<this._data.length?b.set(this._data.subarray(0,3*u)):b.set(this._data)),this._data=b;for(var x=this.length;x<u;++x)this.setCell(x,y)}else if(u){(b=new Uint32Array(3*u)).set(this._data.subarray(0,3*u)),this._data=b;var k=Object.keys(this._combined);for(x=0;x<k.length;x++){var B=parseInt(k[x],10);B>=u&&delete this._combined[B]}}else this._data=new Uint32Array(0),this._combined={};this.length=u}},e.prototype.fill=function(u){this._combined={},this._extendedAttrs={};for(var y=0;y<this.length;++y)this.setCell(y,u)},e.prototype.copyFrom=function(u){for(var y in this.length!==u.length?this._data=new Uint32Array(u._data):this._data.set(u._data),this.length=u.length,this._combined={},u._combined)this._combined[y]=u._combined[y];for(var y in this._extendedAttrs={},u._extendedAttrs)this._extendedAttrs[y]=u._extendedAttrs[y];this.isWrapped=u.isWrapped},e.prototype.clone=function(){var u=new e(0);for(var y in u._data=new Uint32Array(this._data),u.length=this.length,this._combined)u._combined[y]=this._combined[y];for(var y in this._extendedAttrs)u._extendedAttrs[y]=this._extendedAttrs[y];return u.isWrapped=this.isWrapped,u},e.prototype.getTrimmedLength=function(){for(var u=this.length-1;u>=0;--u)if(4194303&this._data[3*u+0])return u+(this._data[3*u+0]>>22);return 0},e.prototype.copyCellsFrom=function(u,y,b,x,k){var B=u._data;if(k)for(var P=x-1;P>=0;P--)for(var I=0;I<3;I++)this._data[3*(b+P)+I]=B[3*(y+P)+I];else for(P=0;P<x;P++)for(I=0;I<3;I++)this._data[3*(b+P)+I]=B[3*(y+P)+I];var H=Object.keys(u._combined);for(I=0;I<H.length;I++){var j=parseInt(H[I],10);j>=y&&(this._combined[j-y+b]=u._combined[j])}},e.prototype.translateToString=function(u,y,b){void 0===u&&(u=!1),void 0===y&&(y=0),void 0===b&&(b=this.length),u&&(b=Math.min(b,this.getTrimmedLength()));for(var B="";y<b;){var P=this._data[3*y+0],I=2097151&P;B+=2097152&P?this._combined[y]:I?(0,x.stringFromCodePoint)(I):k.WHITESPACE_CELL_CHAR,y+=P>>22||1}return B},e}();y.BufferLine=I},4841:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.getRangeLength=void 0,y.getRangeLength=function(u,y){if(u.start.y>u.end.y)throw Error("Buffer range end ("+u.end.x+", "+u.end.y+") cannot be before start ("+u.start.x+", "+u.start.y+")");return y*(u.end.y-u.start.y)+(u.end.x-u.start.x+1)}},4634:(u,y)=>{function r(u,y,b){if(y===u.length-1)return u[y].getTrimmedLength();var x=!u[y].hasContent(b-1)&&1===u[y].getWidth(b-1),k=2===u[y+1].getWidth(0);return x&&k?b-1:b}Object.defineProperty(y,"__esModule",{value:!0}),y.getWrappedLineTrimmedLength=y.reflowSmallerGetNewLineLengths=y.reflowLargerApplyNewLayout=y.reflowLargerCreateNewLayout=y.reflowLargerGetLinesToRemove=void 0,y.reflowLargerGetLinesToRemove=function(u,y,b,x,k){for(var B=[],P=0;P<u.length-1;P++){var I=P,H=u.get(++I);if(H.isWrapped){for(var j=[u.get(P)];I<u.length&&H.isWrapped;)j.push(H),H=u.get(++I);if(x>=P&&x<I)P+=j.length-1;else{for(var N=0,q=r(j,N,y),W=1,U=0;W<j.length;){var z=r(j,W,y),K=Math.min(z-U,b-q);j[N].copyCellsFrom(j[W],U,q,K,!1),(q+=K)===b&&(N++,q=0),(U+=K)===z&&(W++,U=0),0===q&&0!==N&&2===j[N-1].getWidth(b-1)&&(j[N].copyCellsFrom(j[N-1],b-1,q++,1,!1),j[N-1].setCell(b-1,k))}j[N].replaceCells(q,b,k);for(var V=0,G=j.length-1;G>0&&(G>N||0===j[G].getTrimmedLength());G--)V++;V>0&&(B.push(P+j.length-V),B.push(V)),P+=j.length-1}}}return B},y.reflowLargerCreateNewLayout=function(u,y){for(var b=[],x=0,k=y[x],B=0,P=0;P<u.length;P++)if(k===P){var I=y[++x];u.onDeleteEmitter.fire({index:P-B,amount:I}),P+=I-1,B+=I,k=y[++x]}else b.push(P);return{layout:b,countRemoved:B}},y.reflowLargerApplyNewLayout=function(u,y){for(var b=[],x=0;x<y.length;x++)b.push(u.get(y[x]));for(x=0;x<b.length;x++)u.set(x,b[x]);u.length=y.length},y.reflowSmallerGetNewLineLengths=function(u,y,b){for(var x=[],k=u.map((function(b,x){return r(u,x,y)})).reduce((function(u,y){return u+y})),B=0,P=0,I=0;I<k;){if(k-I<b){x.push(k-I);break}B+=b;var H=r(u,P,y);B>H&&(B-=H,P++);var j=2===u[P].getWidth(B-1);j&&B--;var N=j?b-1:b;x.push(N),I+=N}return x},y.getWrappedLineTrimmedLength=r},5295:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)});Object.defineProperty(y,"__esModule",{value:!0}),y.BufferSet=void 0;var B=b(9092),P=b(8460),I=function(u){function t(y,b){var x=u.call(this)||this;return x._optionsService=y,x._bufferService=b,x._onBufferActivate=x.register(new P.EventEmitter),x.reset(),x}return k(t,u),Object.defineProperty(t.prototype,"onBufferActivate",{get:function(){return this._onBufferActivate.event},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this._normal=new B.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new B.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()},Object.defineProperty(t.prototype,"alt",{get:function(){return this._alt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"active",{get:function(){return this._activeBuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"normal",{get:function(){return this._normal},enumerable:!1,configurable:!0}),t.prototype.activateNormalBuffer=function(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))},t.prototype.activateAltBuffer=function(u){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(u),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))},t.prototype.resize=function(u,y){this._normal.resize(u,y),this._alt.resize(u,y)},t.prototype.setupTabStops=function(u){this._normal.setupTabStops(u),this._alt.setupTabStops(u)},t}(b(844).Disposable);y.BufferSet=I},511:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)});Object.defineProperty(y,"__esModule",{value:!0}),y.CellData=void 0;var B=b(482),P=b(643),I=b(3734),H=function(u){function t(){var y=null!==u&&u.apply(this,arguments)||this;return y.content=0,y.fg=0,y.bg=0,y.extended=new I.ExtendedAttrs,y.combinedData="",y}return k(t,u),t.fromCharData=function(u){var y=new t;return y.setFromCharData(u),y},t.prototype.isCombined=function(){return 2097152&this.content},t.prototype.getWidth=function(){return this.content>>22},t.prototype.getChars=function(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,B.stringFromCodePoint)(2097151&this.content):""},t.prototype.getCode=function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content},t.prototype.setFromCharData=function(u){this.fg=u[P.CHAR_DATA_ATTR_INDEX],this.bg=0;var y=!1;if(u[P.CHAR_DATA_CHAR_INDEX].length>2)y=!0;else if(2===u[P.CHAR_DATA_CHAR_INDEX].length){var b=u[P.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=b&&b<=56319){var x=u[P.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=x&&x<=57343?this.content=1024*(b-55296)+x-56320+65536|u[P.CHAR_DATA_WIDTH_INDEX]<<22:y=!0}else y=!0}else this.content=u[P.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|u[P.CHAR_DATA_WIDTH_INDEX]<<22;y&&(this.combinedData=u[P.CHAR_DATA_CHAR_INDEX],this.content=2097152|u[P.CHAR_DATA_WIDTH_INDEX]<<22)},t.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},t}(I.AttributeData);y.CellData=H},643:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.WHITESPACE_CELL_CODE=y.WHITESPACE_CELL_WIDTH=y.WHITESPACE_CELL_CHAR=y.NULL_CELL_CODE=y.NULL_CELL_WIDTH=y.NULL_CELL_CHAR=y.CHAR_DATA_CODE_INDEX=y.CHAR_DATA_WIDTH_INDEX=y.CHAR_DATA_CHAR_INDEX=y.CHAR_DATA_ATTR_INDEX=y.DEFAULT_ATTR=y.DEFAULT_COLOR=void 0,y.DEFAULT_COLOR=256,y.DEFAULT_ATTR=256|y.DEFAULT_COLOR<<9,y.CHAR_DATA_ATTR_INDEX=0,y.CHAR_DATA_CHAR_INDEX=1,y.CHAR_DATA_WIDTH_INDEX=2,y.CHAR_DATA_CODE_INDEX=3,y.NULL_CELL_CHAR="",y.NULL_CELL_WIDTH=1,y.NULL_CELL_CODE=0,y.WHITESPACE_CELL_CHAR=" ",y.WHITESPACE_CELL_WIDTH=1,y.WHITESPACE_CELL_CODE=32},4863:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)});Object.defineProperty(y,"__esModule",{value:!0}),y.Marker=void 0;var B=b(8460),P=function(u){function t(y){var b=u.call(this)||this;return b.line=y,b._id=t._nextId++,b.isDisposed=!1,b._onDispose=new B.EventEmitter,b}return k(t,u),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onDispose",{get:function(){return this._onDispose.event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),u.prototype.dispose.call(this))},t._nextId=1,t}(b(844).Disposable);y.Marker=P},7116:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.DEFAULT_CHARSET=y.CHARSETS=void 0,y.CHARSETS={},y.DEFAULT_CHARSET=y.CHARSETS.B,y.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},y.CHARSETS.A={"#":"£"},y.CHARSETS.B=void 0,y.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},y.CHARSETS.C=y.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},y.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},y.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},y.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},y.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},y.CHARSETS.E=y.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},y.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},y.CHARSETS.H=y.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},y.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(u,y)=>{var b,x;Object.defineProperty(y,"__esModule",{value:!0}),y.C1_ESCAPED=y.C1=y.C0=void 0,function(u){u.NUL="\0",u.SOH="",u.STX="",u.ETX="",u.EOT="",u.ENQ="",u.ACK="",u.BEL="",u.BS="\b",u.HT="\t",u.LF="\n",u.VT="\v",u.FF="\f",u.CR="\r",u.SO="",u.SI="",u.DLE="",u.DC1="",u.DC2="",u.DC3="",u.DC4="",u.NAK="",u.SYN="",u.ETB="",u.CAN="",u.EM="",u.SUB="",u.ESC="",u.FS="",u.GS="",u.RS="",u.US="",u.SP=" ",u.DEL=""}(b=y.C0||(y.C0={})),(x=y.C1||(y.C1={})).PAD="",x.HOP="",x.BPH="",x.NBH="",x.IND="",x.NEL="",x.SSA="",x.ESA="",x.HTS="",x.HTJ="",x.VTS="",x.PLD="",x.PLU="",x.RI="",x.SS2="",x.SS3="",x.DCS="",x.PU1="",x.PU2="",x.STS="",x.CCH="",x.MW="",x.SPA="",x.EPA="",x.SOS="",x.SGCI="",x.SCI="",x.CSI="",x.ST="",x.OSC="",x.PM="",x.APC="",(y.C1_ESCAPED||(y.C1_ESCAPED={})).ST=b.ESC+"\\"},7399:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.evaluateKeyboardEvent=void 0;var x=b(2584),k={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};y.evaluateKeyboardEvent=function(u,y,b,B){var P={type:0,cancel:!1,key:void 0},I=(u.shiftKey?1:0)|(u.altKey?2:0)|(u.ctrlKey?4:0)|(u.metaKey?8:0);switch(u.keyCode){case 0:"UIKeyInputUpArrow"===u.key?P.key=y?x.C0.ESC+"OA":x.C0.ESC+"[A":"UIKeyInputLeftArrow"===u.key?P.key=y?x.C0.ESC+"OD":x.C0.ESC+"[D":"UIKeyInputRightArrow"===u.key?P.key=y?x.C0.ESC+"OC":x.C0.ESC+"[C":"UIKeyInputDownArrow"===u.key&&(P.key=y?x.C0.ESC+"OB":x.C0.ESC+"[B");break;case 8:if(u.shiftKey){P.key=x.C0.BS;break}if(u.altKey){P.key=x.C0.ESC+x.C0.DEL;break}P.key=x.C0.DEL;break;case 9:if(u.shiftKey){P.key=x.C0.ESC+"[Z";break}P.key=x.C0.HT,P.cancel=!0;break;case 13:P.key=u.altKey?x.C0.ESC+x.C0.CR:x.C0.CR,P.cancel=!0;break;case 27:P.key=x.C0.ESC,u.altKey&&(P.key=x.C0.ESC+x.C0.ESC),P.cancel=!0;break;case 37:if(u.metaKey)break;I?(P.key=x.C0.ESC+"[1;"+(I+1)+"D",P.key===x.C0.ESC+"[1;3D"&&(P.key=x.C0.ESC+(b?"b":"[1;5D"))):P.key=y?x.C0.ESC+"OD":x.C0.ESC+"[D";break;case 39:if(u.metaKey)break;I?(P.key=x.C0.ESC+"[1;"+(I+1)+"C",P.key===x.C0.ESC+"[1;3C"&&(P.key=x.C0.ESC+(b?"f":"[1;5C"))):P.key=y?x.C0.ESC+"OC":x.C0.ESC+"[C";break;case 38:if(u.metaKey)break;I?(P.key=x.C0.ESC+"[1;"+(I+1)+"A",b||P.key!==x.C0.ESC+"[1;3A"||(P.key=x.C0.ESC+"[1;5A")):P.key=y?x.C0.ESC+"OA":x.C0.ESC+"[A";break;case 40:if(u.metaKey)break;I?(P.key=x.C0.ESC+"[1;"+(I+1)+"B",b||P.key!==x.C0.ESC+"[1;3B"||(P.key=x.C0.ESC+"[1;5B")):P.key=y?x.C0.ESC+"OB":x.C0.ESC+"[B";break;case 45:u.shiftKey||u.ctrlKey||(P.key=x.C0.ESC+"[2~");break;case 46:P.key=I?x.C0.ESC+"[3;"+(I+1)+"~":x.C0.ESC+"[3~";break;case 36:P.key=I?x.C0.ESC+"[1;"+(I+1)+"H":y?x.C0.ESC+"OH":x.C0.ESC+"[H";break;case 35:P.key=I?x.C0.ESC+"[1;"+(I+1)+"F":y?x.C0.ESC+"OF":x.C0.ESC+"[F";break;case 33:u.shiftKey?P.type=2:u.ctrlKey?P.key=x.C0.ESC+"[5;"+(I+1)+"~":P.key=x.C0.ESC+"[5~";break;case 34:u.shiftKey?P.type=3:u.ctrlKey?P.key=x.C0.ESC+"[6;"+(I+1)+"~":P.key=x.C0.ESC+"[6~";break;case 112:P.key=I?x.C0.ESC+"[1;"+(I+1)+"P":x.C0.ESC+"OP";break;case 113:P.key=I?x.C0.ESC+"[1;"+(I+1)+"Q":x.C0.ESC+"OQ";break;case 114:P.key=I?x.C0.ESC+"[1;"+(I+1)+"R":x.C0.ESC+"OR";break;case 115:P.key=I?x.C0.ESC+"[1;"+(I+1)+"S":x.C0.ESC+"OS";break;case 116:P.key=I?x.C0.ESC+"[15;"+(I+1)+"~":x.C0.ESC+"[15~";break;case 117:P.key=I?x.C0.ESC+"[17;"+(I+1)+"~":x.C0.ESC+"[17~";break;case 118:P.key=I?x.C0.ESC+"[18;"+(I+1)+"~":x.C0.ESC+"[18~";break;case 119:P.key=I?x.C0.ESC+"[19;"+(I+1)+"~":x.C0.ESC+"[19~";break;case 120:P.key=I?x.C0.ESC+"[20;"+(I+1)+"~":x.C0.ESC+"[20~";break;case 121:P.key=I?x.C0.ESC+"[21;"+(I+1)+"~":x.C0.ESC+"[21~";break;case 122:P.key=I?x.C0.ESC+"[23;"+(I+1)+"~":x.C0.ESC+"[23~";break;case 123:P.key=I?x.C0.ESC+"[24;"+(I+1)+"~":x.C0.ESC+"[24~";break;default:if(!u.ctrlKey||u.shiftKey||u.altKey||u.metaKey)if(b&&!B||!u.altKey||u.metaKey)!b||u.altKey||u.ctrlKey||u.shiftKey||!u.metaKey?u.key&&!u.ctrlKey&&!u.altKey&&!u.metaKey&&u.keyCode>=48&&1===u.key.length?P.key=u.key:u.key&&u.ctrlKey&&("_"===u.key&&(P.key=x.C0.US),"@"===u.key&&(P.key=x.C0.NUL)):65===u.keyCode&&(P.type=1);else{var H=k[u.keyCode],j=null==H?void 0:H[u.shiftKey?1:0];if(j)P.key=x.C0.ESC+j;else if(u.keyCode>=65&&u.keyCode<=90){var N=u.ctrlKey?u.keyCode-64:u.keyCode+32,q=String.fromCharCode(N);u.shiftKey&&(q=q.toUpperCase()),P.key=x.C0.ESC+q}else"Dead"===u.key&&u.code.startsWith("Key")&&(q=u.code.slice(3,4),u.shiftKey||(q=q.toLowerCase()),P.key=x.C0.ESC+q,P.cancel=!0)}else u.keyCode>=65&&u.keyCode<=90?P.key=String.fromCharCode(u.keyCode-64):32===u.keyCode?P.key=x.C0.NUL:u.keyCode>=51&&u.keyCode<=55?P.key=String.fromCharCode(u.keyCode-51+27):56===u.keyCode?P.key=x.C0.DEL:219===u.keyCode?P.key=x.C0.ESC:220===u.keyCode?P.key=x.C0.FS:221===u.keyCode&&(P.key=x.C0.GS)}return P}},482:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.Utf8ToUtf32=y.StringToUtf32=y.utf32ToString=y.stringFromCodePoint=void 0,y.stringFromCodePoint=function(u){return u>65535?String.fromCharCode(55296+((u-=65536)>>10))+String.fromCharCode(u%1024+56320):String.fromCharCode(u)},y.utf32ToString=function(u,y,b){void 0===y&&(y=0),void 0===b&&(b=u.length);for(var x="",k=y;k<b;++k){var B=u[k];x+=B>65535?String.fromCharCode(55296+((B-=65536)>>10))+String.fromCharCode(B%1024+56320):String.fromCharCode(B)}return x};var b=function(){function e(){this._interim=0}return e.prototype.clear=function(){this._interim=0},e.prototype.decode=function(u,y){var b=u.length;if(!b)return 0;var x=0,k=0;this._interim&&(56320<=(I=u.charCodeAt(k++))&&I<=57343?y[x++]=1024*(this._interim-55296)+I-56320+65536:(y[x++]=this._interim,y[x++]=I),this._interim=0);for(var B=k;B<b;++B){var P=u.charCodeAt(B);if(55296<=P&&P<=56319){if(++B>=b)return this._interim=P,x;var I;56320<=(I=u.charCodeAt(B))&&I<=57343?y[x++]=1024*(P-55296)+I-56320+65536:(y[x++]=P,y[x++]=I)}else 65279!==P&&(y[x++]=P)}return x},e}();y.StringToUtf32=b;var x=function(){function e(){this.interim=new Uint8Array(3)}return e.prototype.clear=function(){this.interim.fill(0)},e.prototype.decode=function(u,y){var b=u.length;if(!b)return 0;var x,k,B,P,I=0,H=0,j=0;if(this.interim[0]){var N=!1,q=this.interim[0];q&=192==(224&q)?31:224==(240&q)?15:7;for(var W=0,U=void 0;(U=63&this.interim[++W])&&W<4;)q<<=6,q|=U;for(var z=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,K=z-W;j<K;){if(j>=b)return 0;if(128!=(192&(U=u[j++]))){j--,N=!0;break}this.interim[W++]=U,q<<=6,q|=63&U}N||(2===z?q<128?j--:y[I++]=q:3===z?q<2048||q>=55296&&q<=57343||65279===q||(y[I++]=q):q<65536||q>1114111||(y[I++]=q)),this.interim.fill(0)}for(var V=b-4,G=j;G<b;){for(;!(!(G<V)||128&(x=u[G])||128&(k=u[G+1])||128&(B=u[G+2])||128&(P=u[G+3]));)y[I++]=x,y[I++]=k,y[I++]=B,y[I++]=P,G+=4;if((x=u[G++])<128)y[I++]=x;else if(192==(224&x)){if(G>=b)return this.interim[0]=x,I;if(128!=(192&(k=u[G++]))){G--;continue}if((H=(31&x)<<6|63&k)<128){G--;continue}y[I++]=H}else if(224==(240&x)){if(G>=b)return this.interim[0]=x,I;if(128!=(192&(k=u[G++]))){G--;continue}if(G>=b)return this.interim[0]=x,this.interim[1]=k,I;if(128!=(192&(B=u[G++]))){G--;continue}if((H=(15&x)<<12|(63&k)<<6|63&B)<2048||H>=55296&&H<=57343||65279===H)continue;y[I++]=H}else if(240==(248&x)){if(G>=b)return this.interim[0]=x,I;if(128!=(192&(k=u[G++]))){G--;continue}if(G>=b)return this.interim[0]=x,this.interim[1]=k,I;if(128!=(192&(B=u[G++]))){G--;continue}if(G>=b)return this.interim[0]=x,this.interim[1]=k,this.interim[2]=B,I;if(128!=(192&(P=u[G++]))){G--;continue}if((H=(7&x)<<18|(63&k)<<12|(63&B)<<6|63&P)<65536||H>1114111)continue;y[I++]=H}}return I},e}();y.Utf8ToUtf32=x},225:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.UnicodeV6=void 0;var x,k=b(8273),B=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],P=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],I=function(){function e(){if(this.version="6",!x){x=new Uint8Array(65536),(0,k.fill)(x,1),x[0]=0,(0,k.fill)(x,0,1,32),(0,k.fill)(x,0,127,160),(0,k.fill)(x,2,4352,4448),x[9001]=2,x[9002]=2,(0,k.fill)(x,2,11904,42192),x[12351]=1,(0,k.fill)(x,2,44032,55204),(0,k.fill)(x,2,63744,64256),(0,k.fill)(x,2,65040,65050),(0,k.fill)(x,2,65072,65136),(0,k.fill)(x,2,65280,65377),(0,k.fill)(x,2,65504,65511);for(var u=0;u<B.length;++u)(0,k.fill)(x,0,B[u][0],B[u][1]+1)}}return e.prototype.wcwidth=function(u){return u<32?0:u<127?1:u<65536?x[u]:function(u,y){var b,x=0,k=y.length-1;if(u<y[0][0]||u>y[k][1])return!1;for(;k>=x;)if(u>y[b=x+k>>1][1])x=b+1;else{if(!(u<y[b][0]))return!0;k=b-1}return!1}(u,P)?0:u>=131072&&u<=196605||u>=196608&&u<=262141?2:1},e}();y.UnicodeV6=I},5981:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.WriteBuffer=void 0;var x=b(8460),k="undefined"==typeof queueMicrotask?function(u){Promise.resolve().then(u)}:queueMicrotask,B=function(){function e(u){this._action=u,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._onWriteParsed=new x.EventEmitter}return Object.defineProperty(e.prototype,"onWriteParsed",{get:function(){return this._onWriteParsed.event},enumerable:!1,configurable:!0}),e.prototype.writeSync=function(u,y){if(void 0!==y&&this._syncCalls>y)this._syncCalls=0;else if(this._pendingData+=u.length,this._writeBuffer.push(u),this._callbacks.push(void 0),this._syncCalls++,!this._isSyncWriting){var b;for(this._isSyncWriting=!0;b=this._writeBuffer.shift();){this._action(b);var x=this._callbacks.shift();x&&x()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}},e.prototype.write=function(u,y){var b=this;if(this._pendingData>5e7)throw Error("write data discarded, use flow control to avoid losing data");this._writeBuffer.length||(this._bufferOffset=0,setTimeout((function(){return b._innerWrite()}))),this._pendingData+=u.length,this._writeBuffer.push(u),this._callbacks.push(y)},e.prototype._innerWrite=function(u,y){var b=this;void 0===u&&(u=0),void 0===y&&(y=!0);for(var x=u||Date.now();this._writeBuffer.length>this._bufferOffset;){var B=this._writeBuffer[this._bufferOffset],P=this._action(B,y);if(P)return void P.catch((function(u){return k((function(){throw u})),Promise.resolve(!1)})).then((function(u){return Date.now()-x>=12?setTimeout((function(){return b._innerWrite(0,u)})):b._innerWrite(x,u)}));var I=this._callbacks[this._bufferOffset];if(I&&I(),this._bufferOffset++,this._pendingData-=B.length,Date.now()-x>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout((function(){return b._innerWrite()}))):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()},e}();y.WriteBuffer=B},5941:function(u,y){var b=this&&this.__read||function(u,y){var b="function"==typeof Symbol&&u[Symbol.iterator];if(!b)return u;var x,k,B=b.call(u),P=[];try{for(;(void 0===y||y-- >0)&&!(x=B.next()).done;)P.push(x.value)}catch(u){k={error:u}}finally{try{x&&!x.done&&(b=B.return)&&b.call(B)}finally{if(k)throw k.error}}return P};Object.defineProperty(y,"__esModule",{value:!0}),y.toRgbString=y.parseColor=void 0;var x=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,k=/^[\da-f]+$/;function o(u,y){var b=u.toString(16),x=b.length<2?"0"+b:b;switch(y){case 4:return b[0];case 8:return x;case 12:return(x+x).slice(0,3);default:return x+x}}y.parseColor=function(u){if(u){var y=u.toLowerCase();if(0===y.indexOf("rgb:")){y=y.slice(4);var b=x.exec(y);if(b){var B=b[1]?15:b[4]?255:b[7]?4095:65535;return[Math.round(parseInt(b[1]||b[4]||b[7]||b[10],16)/B*255),Math.round(parseInt(b[2]||b[5]||b[8]||b[11],16)/B*255),Math.round(parseInt(b[3]||b[6]||b[9]||b[12],16)/B*255)]}}else if(0===y.indexOf("#")&&(y=y.slice(1),k.exec(y)&&[3,6,9,12].includes(y.length))){for(var P=y.length/3,I=[0,0,0],H=0;H<3;++H){var j=parseInt(y.slice(P*H,P*H+P),16);I[H]=1===P?j<<4:2===P?j:3===P?j>>4:j>>8}return I}}},y.toRgbString=function(u,y){void 0===y&&(y=16);var x=b(u,3),k=x[0],B=x[1],P=x[2];return"rgb:"+o(k,y)+"/"+o(B,y)+"/"+o(P,y)}},5770:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.PAYLOAD_LIMIT=void 0,y.PAYLOAD_LIMIT=1e7},6351:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.DcsHandler=y.DcsParser=void 0;var x=b(482),k=b(8742),B=b(5770),P=[],I=function(){function e(){this._handlers=Object.create(null),this._active=P,this._ident=0,this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return e.prototype.dispose=function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=P},e.prototype.registerHandler=function(u,y){void 0===this._handlers[u]&&(this._handlers[u]=[]);var b=this._handlers[u];return b.push(y),{dispose:function(){var u=b.indexOf(y);-1!==u&&b.splice(u,1)}}},e.prototype.clearHandler=function(u){this._handlers[u]&&delete this._handlers[u]},e.prototype.setHandlerFallback=function(u){this._handlerFb=u},e.prototype.reset=function(){if(this._active.length)for(var u=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;u>=0;--u)this._active[u].unhook(!1);this._stack.paused=!1,this._active=P,this._ident=0},e.prototype.hook=function(u,y){if(this.reset(),this._ident=u,this._active=this._handlers[u]||P,this._active.length)for(var b=this._active.length-1;b>=0;b--)this._active[b].hook(y);else this._handlerFb(this._ident,"HOOK",y)},e.prototype.put=function(u,y,b){if(this._active.length)for(var k=this._active.length-1;k>=0;k--)this._active[k].put(u,y,b);else this._handlerFb(this._ident,"PUT",(0,x.utf32ToString)(u,y,b))},e.prototype.unhook=function(u,y){if(void 0===y&&(y=!0),this._active.length){var b=!1,x=this._active.length-1,k=!1;if(this._stack.paused&&(x=this._stack.loopPosition-1,b=y,k=this._stack.fallThrough,this._stack.paused=!1),!k&&!1===b){for(;x>=0&&!0!==(b=this._active[x].unhook(u));x--)if(b instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=x,this._stack.fallThrough=!1,b;x--}for(;x>=0;x--)if((b=this._active[x].unhook(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=x,this._stack.fallThrough=!0,b}else this._handlerFb(this._ident,"UNHOOK",u);this._active=P,this._ident=0},e}();y.DcsParser=I;var H=new k.Params;H.addParam(0);var j=function(){function e(u){this._handler=u,this._data="",this._params=H,this._hitLimit=!1}return e.prototype.hook=function(u){this._params=u.length>1||u.params[0]?u.clone():H,this._data="",this._hitLimit=!1},e.prototype.put=function(u,y,b){this._hitLimit||(this._data+=(0,x.utf32ToString)(u,y,b),this._data.length>B.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))},e.prototype.unhook=function(u){var y=this,b=!1;if(this._hitLimit)b=!1;else if(u&&(b=this._handler(this._data,this._params))instanceof Promise)return b.then((function(u){return y._params=H,y._data="",y._hitLimit=!1,u}));return this._params=H,this._data="",this._hitLimit=!1,b},e}();y.DcsHandler=j},2015:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)});Object.defineProperty(y,"__esModule",{value:!0}),y.EscapeSequenceParser=y.VT500_TRANSITION_TABLE=y.TransitionTable=void 0;var B=b(844),P=b(8273),I=b(8742),H=b(6242),j=b(6351),N=function(){function e(u){this.table=new Uint8Array(u)}return e.prototype.setDefault=function(u,y){(0,P.fill)(this.table,u<<4|y)},e.prototype.add=function(u,y,b,x){this.table[y<<8|u]=b<<4|x},e.prototype.addMany=function(u,y,b,x){for(var k=0;k<u.length;k++)this.table[y<<8|u[k]]=b<<4|x},e}();y.TransitionTable=N;var q=160;y.VT500_TRANSITION_TABLE=function(){var u=new N(4095),y=Array.apply(null,Array(256)).map((function(u,y){return y})),r=function(u,b){return y.slice(u,b)},b=r(32,127),x=r(0,24);x.push(25),x.push.apply(x,r(28,32));var k,B=r(0,14);for(k in u.setDefault(1,0),u.addMany(b,0,2,0),B)u.addMany([24,26,153,154],k,3,0),u.addMany(r(128,144),k,3,0),u.addMany(r(144,152),k,3,0),u.add(156,k,0,0),u.add(27,k,11,1),u.add(157,k,4,8),u.addMany([152,158,159],k,0,7),u.add(155,k,11,3),u.add(144,k,11,9);return u.addMany(x,0,3,0),u.addMany(x,1,3,1),u.add(127,1,0,1),u.addMany(x,8,0,8),u.addMany(x,3,3,3),u.add(127,3,0,3),u.addMany(x,4,3,4),u.add(127,4,0,4),u.addMany(x,6,3,6),u.addMany(x,5,3,5),u.add(127,5,0,5),u.addMany(x,2,3,2),u.add(127,2,0,2),u.add(93,1,4,8),u.addMany(b,8,5,8),u.add(127,8,5,8),u.addMany([156,27,24,26,7],8,6,0),u.addMany(r(28,32),8,0,8),u.addMany([88,94,95],1,0,7),u.addMany(b,7,0,7),u.addMany(x,7,0,7),u.add(156,7,0,0),u.add(127,7,0,7),u.add(91,1,11,3),u.addMany(r(64,127),3,7,0),u.addMany(r(48,60),3,8,4),u.addMany([60,61,62,63],3,9,4),u.addMany(r(48,60),4,8,4),u.addMany(r(64,127),4,7,0),u.addMany([60,61,62,63],4,0,6),u.addMany(r(32,64),6,0,6),u.add(127,6,0,6),u.addMany(r(64,127),6,0,0),u.addMany(r(32,48),3,9,5),u.addMany(r(32,48),5,9,5),u.addMany(r(48,64),5,0,6),u.addMany(r(64,127),5,7,0),u.addMany(r(32,48),4,9,5),u.addMany(r(32,48),1,9,2),u.addMany(r(32,48),2,9,2),u.addMany(r(48,127),2,10,0),u.addMany(r(48,80),1,10,0),u.addMany(r(81,88),1,10,0),u.addMany([89,90,92],1,10,0),u.addMany(r(96,127),1,10,0),u.add(80,1,11,9),u.addMany(x,9,0,9),u.add(127,9,0,9),u.addMany(r(28,32),9,0,9),u.addMany(r(32,48),9,9,12),u.addMany(r(48,60),9,8,10),u.addMany([60,61,62,63],9,9,10),u.addMany(x,11,0,11),u.addMany(r(32,128),11,0,11),u.addMany(r(28,32),11,0,11),u.addMany(x,10,0,10),u.add(127,10,0,10),u.addMany(r(28,32),10,0,10),u.addMany(r(48,60),10,8,10),u.addMany([60,61,62,63],10,0,11),u.addMany(r(32,48),10,9,12),u.addMany(x,12,0,12),u.add(127,12,0,12),u.addMany(r(28,32),12,0,12),u.addMany(r(32,48),12,9,12),u.addMany(r(48,64),12,0,11),u.addMany(r(64,127),12,12,13),u.addMany(r(64,127),10,12,13),u.addMany(r(64,127),9,12,13),u.addMany(x,13,13,13),u.addMany(b,13,13,13),u.add(127,13,0,13),u.addMany([27,156,24,26],13,14,0),u.add(q,0,2,0),u.add(q,8,5,8),u.add(q,6,0,6),u.add(q,11,0,11),u.add(q,13,13,13),u}();var W=function(u){function r(b){void 0===b&&(b=y.VT500_TRANSITION_TABLE);var x=u.call(this)||this;return x._transitions=b,x._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},x.initialState=0,x.currentState=x.initialState,x._params=new I.Params,x._params.addParam(0),x._collect=0,x.precedingCodepoint=0,x._printHandlerFb=function(u,y,b){},x._executeHandlerFb=function(u){},x._csiHandlerFb=function(u,y){},x._escHandlerFb=function(u){},x._errorHandlerFb=function(u){return u},x._printHandler=x._printHandlerFb,x._executeHandlers=Object.create(null),x._csiHandlers=Object.create(null),x._escHandlers=Object.create(null),x._oscParser=new H.OscParser,x._dcsParser=new j.DcsParser,x._errorHandler=x._errorHandlerFb,x.registerEscHandler({final:"\\"},(function(){return!0})),x}return k(r,u),r.prototype._identifier=function(u,y){void 0===y&&(y=[64,126]);var b=0;if(u.prefix){if(u.prefix.length>1)throw Error("only one byte as prefix supported");if((b=u.prefix.charCodeAt(0))&&60>b||b>63)throw Error("prefix must be in range 0x3c .. 0x3f")}if(u.intermediates){if(u.intermediates.length>2)throw Error("only two bytes as intermediates are supported");for(var x=0;x<u.intermediates.length;++x){var k=u.intermediates.charCodeAt(x);if(32>k||k>47)throw Error("intermediate must be in range 0x20 .. 0x2f");b<<=8,b|=k}}if(1!==u.final.length)throw Error("final must be a single byte");var B=u.final.charCodeAt(0);if(y[0]>B||B>y[1])throw Error("final must be in range "+y[0]+" .. "+y[1]);return(b<<=8)|B},r.prototype.identToString=function(u){for(var y=[];u;)y.push(String.fromCharCode(255&u)),u>>=8;return y.reverse().join("")},r.prototype.dispose=function(){this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null),this._oscParser.dispose(),this._dcsParser.dispose()},r.prototype.setPrintHandler=function(u){this._printHandler=u},r.prototype.clearPrintHandler=function(){this._printHandler=this._printHandlerFb},r.prototype.registerEscHandler=function(u,y){var b=this._identifier(u,[48,126]);void 0===this._escHandlers[b]&&(this._escHandlers[b]=[]);var x=this._escHandlers[b];return x.push(y),{dispose:function(){var u=x.indexOf(y);-1!==u&&x.splice(u,1)}}},r.prototype.clearEscHandler=function(u){this._escHandlers[this._identifier(u,[48,126])]&&delete this._escHandlers[this._identifier(u,[48,126])]},r.prototype.setEscHandlerFallback=function(u){this._escHandlerFb=u},r.prototype.setExecuteHandler=function(u,y){this._executeHandlers[u.charCodeAt(0)]=y},r.prototype.clearExecuteHandler=function(u){this._executeHandlers[u.charCodeAt(0)]&&delete this._executeHandlers[u.charCodeAt(0)]},r.prototype.setExecuteHandlerFallback=function(u){this._executeHandlerFb=u},r.prototype.registerCsiHandler=function(u,y){var b=this._identifier(u);void 0===this._csiHandlers[b]&&(this._csiHandlers[b]=[]);var x=this._csiHandlers[b];return x.push(y),{dispose:function(){var u=x.indexOf(y);-1!==u&&x.splice(u,1)}}},r.prototype.clearCsiHandler=function(u){this._csiHandlers[this._identifier(u)]&&delete this._csiHandlers[this._identifier(u)]},r.prototype.setCsiHandlerFallback=function(u){this._csiHandlerFb=u},r.prototype.registerDcsHandler=function(u,y){return this._dcsParser.registerHandler(this._identifier(u),y)},r.prototype.clearDcsHandler=function(u){this._dcsParser.clearHandler(this._identifier(u))},r.prototype.setDcsHandlerFallback=function(u){this._dcsParser.setHandlerFallback(u)},r.prototype.registerOscHandler=function(u,y){return this._oscParser.registerHandler(u,y)},r.prototype.clearOscHandler=function(u){this._oscParser.clearHandler(u)},r.prototype.setOscHandlerFallback=function(u){this._oscParser.setHandlerFallback(u)},r.prototype.setErrorHandler=function(u){this._errorHandler=u},r.prototype.clearErrorHandler=function(){this._errorHandler=this._errorHandlerFb},r.prototype.reset=function(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,0!==this._parseStack.state&&(this._parseStack.state=2,this._parseStack.handlers=[])},r.prototype._preserveStack=function(u,y,b,x,k){this._parseStack.state=u,this._parseStack.handlers=y,this._parseStack.handlerPos=b,this._parseStack.transition=x,this._parseStack.chunkPos=k},r.prototype.parse=function(u,y,b){var x,k=0,B=0,P=0;if(this._parseStack.state)if(2===this._parseStack.state)this._parseStack.state=0,P=this._parseStack.chunkPos+1;else{if(void 0===b||1===this._parseStack.state)throw this._parseStack.state=1,Error("improper continuation due to previous async handler, giving up parsing");var I=this._parseStack.handlers,H=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(!1===b&&H>-1)for(;H>=0&&!0!==(x=I[H](this._params));H--)if(x instanceof Promise)return this._parseStack.handlerPos=H,x;this._parseStack.handlers=[];break;case 4:if(!1===b&&H>-1)for(;H>=0&&!0!==(x=I[H]());H--)if(x instanceof Promise)return this._parseStack.handlerPos=H,x;this._parseStack.handlers=[];break;case 6:if(k=u[this._parseStack.chunkPos],x=this._dcsParser.unhook(24!==k&&26!==k,b))return x;27===k&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(k=u[this._parseStack.chunkPos],x=this._oscParser.end(24!==k&&26!==k,b))return x;27===k&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,P=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(var j=P;j<y;++j){switch(k=u[j],(B=this._transitions.table[this.currentState<<8|(k<160?k:q)])>>4){case 2:for(var N=j+1;;++N){if(N>=y||(k=u[N])<32||k>126&&k<q){this._printHandler(u,j,N),j=N-1;break}if(++N>=y||(k=u[N])<32||k>126&&k<q){this._printHandler(u,j,N),j=N-1;break}if(++N>=y||(k=u[N])<32||k>126&&k<q){this._printHandler(u,j,N),j=N-1;break}if(++N>=y||(k=u[N])<32||k>126&&k<q){this._printHandler(u,j,N),j=N-1;break}}break;case 3:this._executeHandlers[k]?this._executeHandlers[k]():this._executeHandlerFb(k),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:j,code:k,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:for(var W=(I=this._csiHandlers[this._collect<<8|k])?I.length-1:-1;W>=0&&!0!==(x=I[W](this._params));W--)if(x instanceof Promise)return this._preserveStack(3,I,W,B,j),x;W<0&&this._csiHandlerFb(this._collect<<8|k,this._params),this.precedingCodepoint=0;break;case 8:do{switch(k){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(k-48)}}while(++j<y&&(k=u[j])>47&&k<60);j--;break;case 9:this._collect<<=8,this._collect|=k;break;case 10:for(var U=this._escHandlers[this._collect<<8|k],z=U?U.length-1:-1;z>=0&&!0!==(x=U[z]());z--)if(x instanceof Promise)return this._preserveStack(4,U,z,B,j),x;z<0&&this._escHandlerFb(this._collect<<8|k),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|k,this._params);break;case 13:for(var K=j+1;;++K)if(K>=y||24===(k=u[K])||26===k||27===k||k>127&&k<q){this._dcsParser.put(u,j,K),j=K-1;break}break;case 14:if(x=this._dcsParser.unhook(24!==k&&26!==k))return this._preserveStack(6,[],0,B,j),x;27===k&&(B|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(var V=j+1;;V++)if(V>=y||(k=u[V])<32||k>127&&k<q){this._oscParser.put(u,j,V),j=V-1;break}break;case 6:if(x=this._oscParser.end(24!==k&&26!==k))return this._preserveStack(5,[],0,B,j),x;27===k&&(B|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&B}},r}(B.Disposable);y.EscapeSequenceParser=W},6242:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.OscHandler=y.OscParser=void 0;var x=b(5770),k=b(482),B=[],P=function(){function e(){this._state=0,this._active=B,this._id=-1,this._handlers=Object.create(null),this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return e.prototype.registerHandler=function(u,y){void 0===this._handlers[u]&&(this._handlers[u]=[]);var b=this._handlers[u];return b.push(y),{dispose:function(){var u=b.indexOf(y);-1!==u&&b.splice(u,1)}}},e.prototype.clearHandler=function(u){this._handlers[u]&&delete this._handlers[u]},e.prototype.setHandlerFallback=function(u){this._handlerFb=u},e.prototype.dispose=function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=B},e.prototype.reset=function(){if(2===this._state)for(var u=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;u>=0;--u)this._active[u].end(!1);this._stack.paused=!1,this._active=B,this._id=-1,this._state=0},e.prototype._start=function(){if(this._active=this._handlers[this._id]||B,this._active.length)for(var u=this._active.length-1;u>=0;u--)this._active[u].start();else this._handlerFb(this._id,"START")},e.prototype._put=function(u,y,b){if(this._active.length)for(var x=this._active.length-1;x>=0;x--)this._active[x].put(u,y,b);else this._handlerFb(this._id,"PUT",(0,k.utf32ToString)(u,y,b))},e.prototype.start=function(){this.reset(),this._state=1},e.prototype.put=function(u,y,b){if(3!==this._state){if(1===this._state)for(;y<b;){var x=u[y++];if(59===x){this._state=2,this._start();break}if(x<48||57<x)return void(this._state=3);-1===this._id&&(this._id=0),this._id=10*this._id+x-48}2===this._state&&b-y>0&&this._put(u,y,b)}},e.prototype.end=function(u,y){if(void 0===y&&(y=!0),0!==this._state){if(3!==this._state)if(1===this._state&&this._start(),this._active.length){var b=!1,x=this._active.length-1,k=!1;if(this._stack.paused&&(x=this._stack.loopPosition-1,b=y,k=this._stack.fallThrough,this._stack.paused=!1),!k&&!1===b){for(;x>=0&&!0!==(b=this._active[x].end(u));x--)if(b instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=x,this._stack.fallThrough=!1,b;x--}for(;x>=0;x--)if((b=this._active[x].end(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=x,this._stack.fallThrough=!0,b}else this._handlerFb(this._id,"END",u);this._active=B,this._id=-1,this._state=0}},e}();y.OscParser=P;var I=function(){function e(u){this._handler=u,this._data="",this._hitLimit=!1}return e.prototype.start=function(){this._data="",this._hitLimit=!1},e.prototype.put=function(u,y,b){this._hitLimit||(this._data+=(0,k.utf32ToString)(u,y,b),this._data.length>x.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))},e.prototype.end=function(u){var y=this,b=!1;if(this._hitLimit)b=!1;else if(u&&(b=this._handler(this._data))instanceof Promise)return b.then((function(u){return y._data="",y._hitLimit=!1,u}));return this._data="",this._hitLimit=!1,b},e}();y.OscHandler=I},8742:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.Params=void 0;var b=2147483647,x=function(){function e(u,y){if(void 0===u&&(u=32),void 0===y&&(y=32),this.maxLength=u,this.maxSubParamsLength=y,y>256)throw Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(u),this.length=0,this._subParams=new Int32Array(y),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(u),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}return e.fromArray=function(u){var y=new e;if(!u.length)return y;for(var b=Array.isArray(u[0])?1:0;b<u.length;++b){var x=u[b];if(Array.isArray(x))for(var k=0;k<x.length;++k)y.addSubParam(x[k]);else y.addParam(x)}return y},e.prototype.clone=function(){var u=new e(this.maxLength,this.maxSubParamsLength);return u.params.set(this.params),u.length=this.length,u._subParams.set(this._subParams),u._subParamsLength=this._subParamsLength,u._subParamsIdx.set(this._subParamsIdx),u._rejectDigits=this._rejectDigits,u._rejectSubDigits=this._rejectSubDigits,u._digitIsSub=this._digitIsSub,u},e.prototype.toArray=function(){for(var u=[],y=0;y<this.length;++y){u.push(this.params[y]);var b=this._subParamsIdx[y]>>8,x=255&this._subParamsIdx[y];x-b>0&&u.push(Array.prototype.slice.call(this._subParams,b,x))}return u},e.prototype.reset=function(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1},e.prototype.addParam=function(u){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(u<-1)throw Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=u>b?b:u}},e.prototype.addSubParam=function(u){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(u<-1)throw Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=u>b?b:u,this._subParamsIdx[this.length-1]++}},e.prototype.hasSubParams=function(u){return(255&this._subParamsIdx[u])-(this._subParamsIdx[u]>>8)>0},e.prototype.getSubParams=function(u){var y=this._subParamsIdx[u]>>8,b=255&this._subParamsIdx[u];return b-y>0?this._subParams.subarray(y,b):null},e.prototype.getSubParamsAll=function(){for(var u={},y=0;y<this.length;++y){var b=this._subParamsIdx[y]>>8,x=255&this._subParamsIdx[y];x-b>0&&(u[y]=this._subParams.slice(b,x))}return u},e.prototype.addDigit=function(u){var y;if(!(this._rejectDigits||!(y=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)){var x=this._digitIsSub?this._subParams:this.params,k=x[y-1];x[y-1]=~k?Math.min(10*k+u,b):u}},e}();y.Params=x},5741:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.AddonManager=void 0;var b=function(){function e(){this._addons=[]}return e.prototype.dispose=function(){for(var u=this._addons.length-1;u>=0;u--)this._addons[u].instance.dispose()},e.prototype.loadAddon=function(u,y){var b=this,x={instance:y,dispose:y.dispose,isDisposed:!1};this._addons.push(x),y.dispose=function(){return b._wrappedAddonDispose(x)},y.activate(u)},e.prototype._wrappedAddonDispose=function(u){if(!u.isDisposed){for(var y=-1,b=0;b<this._addons.length;b++)if(this._addons[b]===u){y=b;break}if(-1===y)throw Error("Could not dispose an addon that has not been loaded");u.isDisposed=!0,u.dispose.apply(u.instance),this._addons.splice(y,1)}},e}();y.AddonManager=b},8771:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.BufferApiView=void 0;var x=b(3785),k=b(511),B=function(){function e(u,y){this._buffer=u,this.type=y}return e.prototype.init=function(u){return this._buffer=u,this},Object.defineProperty(e.prototype,"cursorY",{get:function(){return this._buffer.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cursorX",{get:function(){return this._buffer.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewportY",{get:function(){return this._buffer.ydisp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseY",{get:function(){return this._buffer.ybase},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._buffer.lines.length},enumerable:!1,configurable:!0}),e.prototype.getLine=function(u){var y=this._buffer.lines.get(u);if(y)return new x.BufferLineApiView(y)},e.prototype.getNullCell=function(){return new k.CellData},e}();y.BufferApiView=B},3785:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.BufferLineApiView=void 0;var x=b(511),k=function(){function e(u){this._line=u}return Object.defineProperty(e.prototype,"isWrapped",{get:function(){return this._line.isWrapped},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._line.length},enumerable:!1,configurable:!0}),e.prototype.getCell=function(u,y){if(!(u<0||u>=this._line.length))return y?(this._line.loadCell(u,y),y):this._line.loadCell(u,new x.CellData)},e.prototype.translateToString=function(u,y,b){return this._line.translateToString(u,y,b)},e}();y.BufferLineApiView=k},8285:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.BufferNamespaceApi=void 0;var x=b(8771),k=b(8460),B=function(){function e(u){var y=this;this._core=u,this._onBufferChange=new k.EventEmitter,this._normal=new x.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new x.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate((function(){return y._onBufferChange.fire(y.active)}))}return Object.defineProperty(e.prototype,"onBufferChange",{get:function(){return this._onBufferChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw Error("Active buffer is neither normal nor alternate")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normal",{get:function(){return this._normal.init(this._core.buffers.normal)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alternate",{get:function(){return this._alternate.init(this._core.buffers.alt)},enumerable:!1,configurable:!0}),e}();y.BufferNamespaceApi=B},7975:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.ParserApi=void 0;var b=function(){function e(u){this._core=u}return e.prototype.registerCsiHandler=function(u,y){return this._core.registerCsiHandler(u,(function(u){return y(u.toArray())}))},e.prototype.addCsiHandler=function(u,y){return this.registerCsiHandler(u,y)},e.prototype.registerDcsHandler=function(u,y){return this._core.registerDcsHandler(u,(function(u,b){return y(u,b.toArray())}))},e.prototype.addDcsHandler=function(u,y){return this.registerDcsHandler(u,y)},e.prototype.registerEscHandler=function(u,y){return this._core.registerEscHandler(u,y)},e.prototype.addEscHandler=function(u,y){return this.registerEscHandler(u,y)},e.prototype.registerOscHandler=function(u,y){return this._core.registerOscHandler(u,y)},e.prototype.addOscHandler=function(u,y){return this.registerOscHandler(u,y)},e}();y.ParserApi=b},7090:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.UnicodeApi=void 0;var b=function(){function e(u){this._core=u}return e.prototype.register=function(u){this._core.unicodeService.register(u)},Object.defineProperty(e.prototype,"versions",{get:function(){return this._core.unicodeService.versions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeVersion",{get:function(){return this._core.unicodeService.activeVersion},set:function(u){this._core.unicodeService.activeVersion=u},enumerable:!1,configurable:!0}),e}();y.UnicodeApi=b},744:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.BufferService=y.MINIMUM_ROWS=y.MINIMUM_COLS=void 0;var I=b(2585),H=b(5295),j=b(8460),N=b(844);y.MINIMUM_COLS=2,y.MINIMUM_ROWS=1;var q=function(u){function r(b){var x=u.call(this)||this;return x._optionsService=b,x.isUserScrolling=!1,x._onResize=new j.EventEmitter,x._onScroll=new j.EventEmitter,x.cols=Math.max(b.rawOptions.cols||0,y.MINIMUM_COLS),x.rows=Math.max(b.rawOptions.rows||0,y.MINIMUM_ROWS),x.buffers=new H.BufferSet(b,x),x}return k(r,u),Object.defineProperty(r.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!1,configurable:!0}),r.prototype.dispose=function(){u.prototype.dispose.call(this),this.buffers.dispose()},r.prototype.resize=function(u,y){this.cols=u,this.rows=y,this.buffers.resize(u,y),this.buffers.setupTabStops(this.cols),this._onResize.fire({cols:u,rows:y})},r.prototype.reset=function(){this.buffers.reset(),this.isUserScrolling=!1},r.prototype.scroll=function(u,y){void 0===y&&(y=!1);var b,x=this.buffer;(b=this._cachedBlankLine)&&b.length===this.cols&&b.getFg(0)===u.fg&&b.getBg(0)===u.bg||(b=x.getBlankLine(u,y),this._cachedBlankLine=b),b.isWrapped=y;var k=x.ybase+x.scrollTop,B=x.ybase+x.scrollBottom;if(0===x.scrollTop){var P=x.lines.isFull;B===x.lines.length-1?P?x.lines.recycle().copyFrom(b):x.lines.push(b.clone()):x.lines.splice(B+1,0,b.clone()),P?this.isUserScrolling&&(x.ydisp=Math.max(x.ydisp-1,0)):(x.ybase++,this.isUserScrolling||x.ydisp++)}else{var I=B-k+1;x.lines.shiftElements(k+1,I-1,-1),x.lines.set(B,b.clone())}this.isUserScrolling||(x.ydisp=x.ybase),this._onScroll.fire(x.ydisp)},r.prototype.scrollLines=function(u,y,b){var x=this.buffer;if(u<0){if(0===x.ydisp)return;this.isUserScrolling=!0}else u+x.ydisp>=x.ybase&&(this.isUserScrolling=!1);var k=x.ydisp;x.ydisp=Math.max(Math.min(x.ydisp+u,x.ybase),0),k!==x.ydisp&&(y||this._onScroll.fire(x.ydisp))},r.prototype.scrollPages=function(u){this.scrollLines(u*(this.rows-1))},r.prototype.scrollToTop=function(){this.scrollLines(-this.buffer.ydisp)},r.prototype.scrollToBottom=function(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)},r.prototype.scrollToLine=function(u){var y=u-this.buffer.ydisp;0!==y&&this.scrollLines(y)},B([P(0,I.IOptionsService)],r)}(N.Disposable);y.BufferService=q},7994:(u,y)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.CharsetService=void 0;var b=function(){function e(){this.glevel=0,this._charsets=[]}return e.prototype.reset=function(){this.charset=void 0,this._charsets=[],this.glevel=0},e.prototype.setgLevel=function(u){this.glevel=u,this.charset=this._charsets[u]},e.prototype.setgCharset=function(u,y){this._charsets[u]=y,this.glevel===u&&(this.charset=y)},e}();y.CharsetService=b},1753:function(u,y,b){var x=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},k=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}},B=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.CoreMouseService=void 0;var P=b(2585),I=b(8460),H={NONE:{events:0,restrict:function(){return!1}},X10:{events:1,restrict:function(u){return 4!==u.button&&1===u.action&&(u.ctrl=!1,u.alt=!1,u.shift=!1,!0)}},VT200:{events:19,restrict:function(u){return 32!==u.action}},DRAG:{events:23,restrict:function(u){return 32!==u.action||3!==u.button}},ANY:{events:31,restrict:function(u){return!0}}};function l(u,y){var b=(u.ctrl?16:0)|(u.shift?4:0)|(u.alt?8:0);return 4===u.button?(b|=64,b|=u.action):(b|=3&u.button,4&u.button&&(b|=64),8&u.button&&(b|=128),32===u.action?b|=32:0!==u.action||y||(b|=3)),b}var j=String.fromCharCode,N={DEFAULT:function(u){var y=[l(u,!1)+32,u.col+32,u.row+32];return y[0]>255||y[1]>255||y[2]>255?"":"[M"+j(y[0])+j(y[1])+j(y[2])},SGR:function(u){var y=0===u.action&&4!==u.button?"m":"M";return"[<"+l(u,!0)+";"+u.col+";"+u.row+y}},q=function(){function e(u,y){var b,x,k,P;this._bufferService=u,this._coreService=y,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._onProtocolChange=new I.EventEmitter,this._lastEvent=null;try{for(var j=B(Object.keys(H)),q=j.next();!q.done;q=j.next()){var W=q.value;this.addProtocol(W,H[W])}}catch(u){b={error:u}}finally{try{q&&!q.done&&(x=j.return)&&x.call(j)}finally{if(b)throw b.error}}try{for(var U=B(Object.keys(N)),z=U.next();!z.done;z=U.next()){var K=z.value;this.addEncoding(K,N[K])}}catch(u){k={error:u}}finally{try{z&&!z.done&&(P=U.return)&&P.call(U)}finally{if(k)throw k.error}}this.reset()}return e.prototype.addProtocol=function(u,y){this._protocols[u]=y},e.prototype.addEncoding=function(u,y){this._encodings[u]=y},Object.defineProperty(e.prototype,"activeProtocol",{get:function(){return this._activeProtocol},set:function(u){if(!this._protocols[u])throw Error('unknown protocol "'+u+'"');this._activeProtocol=u,this._onProtocolChange.fire(this._protocols[u].events)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"areMouseEventsActive",{get:function(){return 0!==this._protocols[this._activeProtocol].events},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeEncoding",{get:function(){return this._activeEncoding},set:function(u){if(!this._encodings[u])throw Error('unknown encoding "'+u+'"');this._activeEncoding=u},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null},Object.defineProperty(e.prototype,"onProtocolChange",{get:function(){return this._onProtocolChange.event},enumerable:!1,configurable:!0}),e.prototype.triggerMouseEvent=function(u){if(u.col<0||u.col>=this._bufferService.cols||u.row<0||u.row>=this._bufferService.rows)return!1;if(4===u.button&&32===u.action)return!1;if(3===u.button&&32!==u.action)return!1;if(4!==u.button&&(2===u.action||3===u.action))return!1;if(u.col++,u.row++,32===u.action&&this._lastEvent&&this._compareEvents(this._lastEvent,u))return!1;if(!this._protocols[this._activeProtocol].restrict(u))return!1;var y=this._encodings[this._activeEncoding](u);return y&&("DEFAULT"===this._activeEncoding?this._coreService.triggerBinaryEvent(y):this._coreService.triggerDataEvent(y,!0)),this._lastEvent=u,!0},e.prototype.explainEvents=function(u){return{down:!!(1&u),up:!!(2&u),drag:!!(4&u),move:!!(8&u),wheel:!!(16&u)}},e.prototype._compareEvents=function(u,y){return u.col===y.col&&u.row===y.row&&u.button===y.button&&u.action===y.action&&u.ctrl===y.ctrl&&u.alt===y.alt&&u.shift===y.shift},x([k(0,P.IBufferService),k(1,P.ICoreService)],e)}();y.CoreMouseService=q},6975:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},P=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.CoreService=void 0;var I=b(2585),H=b(8460),j=b(1439),N=b(844),q=Object.freeze({insertMode:!1}),W=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),U=function(u){function t(y,b,x,k){var B=u.call(this)||this;return B._bufferService=b,B._logService=x,B._optionsService=k,B.isCursorInitialized=!1,B.isCursorHidden=!1,B._onData=B.register(new H.EventEmitter),B._onUserInput=B.register(new H.EventEmitter),B._onBinary=B.register(new H.EventEmitter),B._scrollToBottom=y,B.register({dispose:function(){return B._scrollToBottom=void 0}}),B.modes=(0,j.clone)(q),B.decPrivateModes=(0,j.clone)(W),B}return k(t,u),Object.defineProperty(t.prototype,"onData",{get:function(){return this._onData.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onUserInput",{get:function(){return this._onUserInput.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onBinary",{get:function(){return this._onBinary.event},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.modes=(0,j.clone)(q),this.decPrivateModes=(0,j.clone)(W)},t.prototype.triggerDataEvent=function(u,y){if(void 0===y&&(y=!1),!this._optionsService.rawOptions.disableStdin){var b=this._bufferService.buffer;b.ybase!==b.ydisp&&this._scrollToBottom(),y&&this._onUserInput.fire(),this._logService.debug('sending data "'+u+'"',(function(){return u.split("").map((function(u){return u.charCodeAt(0)}))})),this._onData.fire(u)}},t.prototype.triggerBinaryEvent=function(u){this._optionsService.rawOptions.disableStdin||(this._logService.debug('sending binary "'+u+'"',(function(){return u.split("").map((function(u){return u.charCodeAt(0)}))})),this._onBinary.fire(u))},B([P(1,I.IBufferService),P(2,I.ILogService),P(3,I.IOptionsService)],t)}(N.Disposable);y.CoreService=U},9074:function(u,y,b){var x,k=this&&this.__extends||(x=function(u,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(u[b]=y[b])},x(u,y)},function(u,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+y+" is not a constructor or null");function r(){this.constructor=u}x(u,y),u.prototype=null===y?Object.create(y):(r.prototype=y.prototype,new r)}),B=this&&this.__generator||function(u,y){var b,x,k,B,P={label:0,sent:function(){if(1&k[0])throw k[1];return k[1]},trys:[],ops:[]};return B={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(B[Symbol.iterator]=function(){return this}),B;function a(B){return function(I){return function(B){if(b)throw new TypeError("Generator is already executing.");for(;P;)try{if(b=1,x&&(k=2&B[0]?x.return:B[0]?x.throw||((k=x.return)&&k.call(x),0):x.next)&&!(k=k.call(x,B[1])).done)return k;switch(x=0,k&&(B=[2&B[0],k.value]),B[0]){case 0:case 1:k=B;break;case 4:return P.label++,{value:B[1],done:!1};case 5:P.label++,x=B[1],B=[0];continue;case 7:B=P.ops.pop(),P.trys.pop();continue;default:if(!((k=(k=P.trys).length>0&&k[k.length-1])||6!==B[0]&&2!==B[0])){P=0;continue}if(3===B[0]&&(!k||B[1]>k[0]&&B[1]<k[3])){P.label=B[1];break}if(6===B[0]&&P.label<k[1]){P.label=k[1],k=B;break}if(k&&P.label<k[2]){P.label=k[2],P.ops.push(B);break}k[2]&&P.ops.pop(),P.trys.pop();continue}B=y.call(u,P)}catch(u){B=[6,u],x=0}finally{b=k=0}if(5&B[0])throw B[1];return{value:B[0]?B[1]:void 0,done:!0}}([B,I])}}},P=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.DecorationService=void 0;var I=b(8055),H=b(8460),j=b(844),N=b(6106),q=function(u){function t(){var y=u.call(this)||this;return y._decorations=new N.SortedList((function(u){return u.marker.line})),y._onDecorationRegistered=y.register(new H.EventEmitter),y._onDecorationRemoved=y.register(new H.EventEmitter),y}return k(t,u),Object.defineProperty(t.prototype,"onDecorationRegistered",{get:function(){return this._onDecorationRegistered.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onDecorationRemoved",{get:function(){return this._onDecorationRemoved.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"decorations",{get:function(){return this._decorations.values()},enumerable:!1,configurable:!0}),t.prototype.registerDecoration=function(u){var y=this;if(!u.marker.isDisposed){var b=new W(u);if(b){var x=b.marker.onDispose((function(){return b.dispose()}));b.onDispose((function(){b&&(y._decorations.delete(b)&&y._onDecorationRemoved.fire(b),x.dispose())})),this._decorations.insert(b),this._onDecorationRegistered.fire(b)}return b}},t.prototype.reset=function(){var u,y;try{for(var b=P(this._decorations.values()),x=b.next();!x.done;x=b.next())x.value.dispose()}catch(y){u={error:y}}finally{try{x&&!x.done&&(y=b.return)&&y.call(b)}finally{if(u)throw u.error}}this._decorations.clear()},t.prototype.getDecorationsAtLine=function(u){return B(this,(function(y){return[2,this._decorations.getKeyIterator(u)]}))},t.prototype.getDecorationsAtCell=function(u,y,b){var x,k,I,H,j,N,q,W,U,z,K;return B(this,(function(B){switch(B.label){case 0:x=0,k=0,B.label=1;case 1:B.trys.push([1,6,7,8]),I=P(this._decorations.getKeyIterator(y)),H=I.next(),B.label=2;case 2:return H.done?[3,5]:(j=H.value,x=null!==(U=j.options.x)&&void 0!==U?U:0,k=x+(null!==(z=j.options.width)&&void 0!==z?z:1),!(u>=x&&u<k)||b&&(null!==(K=j.options.layer)&&void 0!==K?K:"bottom")!==b?[3,4]:[4,j]);case 3:B.sent(),B.label=4;case 4:return H=I.next(),[3,2];case 5:return[3,8];case 6:return N=B.sent(),q={error:N},[3,8];case 7:try{H&&!H.done&&(W=I.return)&&W.call(I)}finally{if(q)throw q.error}return[7];case 8:return[2]}}))},t.prototype.dispose=function(){var u,y;try{for(var b=P(this._decorations.values()),x=b.next();!x.done;x=b.next()){var k=x.value;this._onDecorationRemoved.fire(k)}}catch(y){u={error:y}}finally{try{x&&!x.done&&(y=b.return)&&y.call(b)}finally{if(u)throw u.error}}this.reset()},t}(j.Disposable);y.DecorationService=q;var W=function(u){function t(y){var b=u.call(this)||this;return b.options=y,b.isDisposed=!1,b.onRenderEmitter=b.register(new H.EventEmitter),b.onRender=b.onRenderEmitter.event,b._onDispose=b.register(new H.EventEmitter),b.onDispose=b._onDispose.event,b._cachedBg=null,b._cachedFg=null,b.marker=y.marker,b.options.overviewRulerOptions&&!b.options.overviewRulerOptions.position&&(b.options.overviewRulerOptions.position="full"),b}return k(t,u),Object.defineProperty(t.prototype,"backgroundColorRGB",{get:function(){return null===this._cachedBg&&(this.options.backgroundColor?this._cachedBg=I.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"foregroundColorRGB",{get:function(){return null===this._cachedFg&&(this.options.foregroundColor?this._cachedFg=I.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this._onDispose.fire(),u.prototype.dispose.call(this))},t}(j.Disposable)},3730:function(u,y,b){var x=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},k=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}};Object.defineProperty(y,"__esModule",{value:!0}),y.DirtyRowService=void 0;var B=b(2585),P=function(){function e(u){this._bufferService=u,this.clearRange()}return Object.defineProperty(e.prototype,"start",{get:function(){return this._start},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!1,configurable:!0}),e.prototype.clearRange=function(){this._start=this._bufferService.buffer.y,this._end=this._bufferService.buffer.y},e.prototype.markDirty=function(u){u<this._start?this._start=u:u>this._end&&(this._end=u)},e.prototype.markRangeDirty=function(u,y){if(u>y){var b=u;u=y,y=b}u<this._start&&(this._start=u),y>this._end&&(this._end=y)},e.prototype.markAllDirty=function(){this.markRangeDirty(0,this._bufferService.rows-1)},x([k(0,B.IBufferService)],e)}();y.DirtyRowService=P},4348:function(u,y,b){var x=this&&this.__values||function(u){var y="function"==typeof Symbol&&Symbol.iterator,b=y&&u[y],x=0;if(b)return b.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&x>=u.length&&(u=void 0),{value:u&&u[x++],done:!u}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")},k=this&&this.__read||function(u,y){var b="function"==typeof Symbol&&u[Symbol.iterator];if(!b)return u;var x,k,B=b.call(u),P=[];try{for(;(void 0===y||y-- >0)&&!(x=B.next()).done;)P.push(x.value)}catch(u){k={error:u}}finally{try{x&&!x.done&&(b=B.return)&&b.call(B)}finally{if(k)throw k.error}}return P},B=this&&this.__spreadArray||function(u,y,b){if(b||2===arguments.length)for(var x,k=0,B=y.length;k<B;k++)!x&&k in y||(x||(x=Array.prototype.slice.call(y,0,k)),x[k]=y[k]);return u.concat(x||Array.prototype.slice.call(y))};Object.defineProperty(y,"__esModule",{value:!0}),y.InstantiationService=y.ServiceCollection=void 0;var P=b(2585),I=b(8343),H=function(){function e(){for(var u,y,b=[],B=0;B<arguments.length;B++)b[B]=arguments[B];this._entries=new Map;try{for(var P=x(b),I=P.next();!I.done;I=P.next()){var H=k(I.value,2),j=H[0],N=H[1];this.set(j,N)}}catch(y){u={error:y}}finally{try{I&&!I.done&&(y=P.return)&&y.call(P)}finally{if(u)throw u.error}}}return e.prototype.set=function(u,y){var b=this._entries.get(u);return this._entries.set(u,y),b},e.prototype.forEach=function(u){this._entries.forEach((function(y,b){return u(b,y)}))},e.prototype.has=function(u){return this._entries.has(u)},e.prototype.get=function(u){return this._entries.get(u)},e}();y.ServiceCollection=H;var j=function(){function e(){this._services=new H,this._services.set(P.IInstantiationService,this)}return e.prototype.setService=function(u,y){this._services.set(u,y)},e.prototype.getService=function(u){return this._services.get(u)},e.prototype.createInstance=function(u){for(var y,b,P=[],H=1;H<arguments.length;H++)P[H-1]=arguments[H];var j=(0,I.getServiceDependencies)(u).sort((function(u,y){return u.index-y.index})),N=[];try{for(var q=x(j),W=q.next();!W.done;W=q.next()){var U=W.value,z=this._services.get(U.id);if(!z)throw Error("[createInstance] "+u.name+" depends on UNKNOWN service "+U.id+".");N.push(z)}}catch(u){y={error:u}}finally{try{W&&!W.done&&(b=q.return)&&b.call(q)}finally{if(y)throw y.error}}var K=j.length>0?j[0].index:P.length;if(P.length!==K)throw Error("[createInstance] First service dependency of "+u.name+" at position "+(K+1)+" conflicts with "+P.length+" static arguments");return new(u.bind.apply(u,B([void 0],k(B(B([],k(P),!1),k(N),!1)),!1)))},e}();y.InstantiationService=j},7866:function(u,y,b){var x=this&&this.__decorate||function(u,y,b,x){var k,B=arguments.length,P=B<3?y:null===x?x=Object.getOwnPropertyDescriptor(y,b):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(u,y,b,x);else for(var I=u.length-1;I>=0;I--)(k=u[I])&&(P=(B<3?k(P):B>3?k(y,b,P):k(y,b))||P);return B>3&&P&&Object.defineProperty(y,b,P),P},k=this&&this.__param||function(u,y){return function(b,x){y(b,x,u)}},B=this&&this.__read||function(u,y){var b="function"==typeof Symbol&&u[Symbol.iterator];if(!b)return u;var x,k,B=b.call(u),P=[];try{for(;(void 0===y||y-- >0)&&!(x=B.next()).done;)P.push(x.value)}catch(u){k={error:u}}finally{try{x&&!x.done&&(b=B.return)&&b.call(B)}finally{if(k)throw k.error}}return P},P=this&&this.__spreadArray||function(u,y,b){if(b||2===arguments.length)for(var x,k=0,B=y.length;k<B;k++)!x&&k in y||(x||(x=Array.prototype.slice.call(y,0,k)),x[k]=y[k]);return u.concat(x||Array.prototype.slice.call(y))};Object.defineProperty(y,"__esModule",{value:!0}),y.LogService=void 0;var I=b(2585),H={debug:I.LogLevelEnum.DEBUG,info:I.LogLevelEnum.INFO,warn:I.LogLevelEnum.WARN,error:I.LogLevelEnum.ERROR,off:I.LogLevelEnum.OFF},j=function(){function e(u){var y=this;this._optionsService=u,this.logLevel=I.LogLevelEnum.OFF,this._updateLogLevel(),this._optionsService.onOptionChange((function(u){"logLevel"===u&&y._updateLogLevel()}))}return e.prototype._updateLogLevel=function(){this.logLevel=H[this._optionsService.rawOptions.logLevel]},e.prototype._evalLazyOptionalParams=function(u){for(var y=0;y<u.length;y++)"function"==typeof u[y]&&(u[y]=u[y]())},e.prototype._log=function(u,y,b){this._evalLazyOptionalParams(b),u.call.apply(u,P([console,"xterm.js: "+y],B(b),!1))},e.prototype.debug=function(u){for(var y=[],b=1;b<arguments.length;b++)y[b-1]=arguments[b];this.logLevel<=I.LogLevelEnum.DEBUG&&this._log(console.log,u,y)},e.prototype.info=function(u){for(var y=[],b=1;b<arguments.length;b++)y[b-1]=arguments[b];this.logLevel<=I.LogLevelEnum.INFO&&this._log(console.info,u,y)},e.prototype.warn=function(u){for(var y=[],b=1;b<arguments.length;b++)y[b-1]=arguments[b];this.logLevel<=I.LogLevelEnum.WARN&&this._log(console.warn,u,y)},e.prototype.error=function(u){for(var y=[],b=1;b<arguments.length;b++)y[b-1]=arguments[b];this.logLevel<=I.LogLevelEnum.ERROR&&this._log(console.error,u,y)},x([k(0,I.IOptionsService)],e)}();y.LogService=j},7302:function(u,y,b){var x=this&&this.__assign||function(){return x=Object.assign||function(u){for(var y,b=1,x=arguments.length;b<x;b++)for(var k in y=arguments[b])Object.prototype.hasOwnProperty.call(y,k)&&(u[k]=y[k]);return u},x.apply(this,arguments)};Object.defineProperty(y,"__esModule",{value:!0}),y.OptionsService=y.DEFAULT_OPTIONS=y.DEFAULT_BELL_SOUND=void 0;var k=b(8460),B=b(6114);y.DEFAULT_BELL_SOUND="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjMyLjEwNAAAAAAAAAAAAAAA//tQxAADB8AhSmxhIIEVCSiJrDCQBTcu3UrAIwUdkRgQbFAZC1CQEwTJ9mjRvBA4UOLD8nKVOWfh+UlK3z/177OXrfOdKl7pyn3Xf//WreyTRUoAWgBgkOAGbZHBgG1OF6zM82DWbZaUmMBptgQhGjsyYqc9ae9XFz280948NMBWInljyzsNRFLPWdnZGWrddDsjK1unuSrVN9jJsK8KuQtQCtMBjCEtImISdNKJOopIpBFpNSMbIHCSRpRR5iakjTiyzLhchUUBwCgyKiweBv/7UsQbg8isVNoMPMjAAAA0gAAABEVFGmgqK////9bP/6XCykxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",y.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,bellSound:y.DEFAULT_BELL_SOUND,bellStyle:"none",drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,linkTooltipHoverDuration:500,letterSpacing:0,logLevel:"info",scrollback:1e3,scrollSensitivity:1,screenReaderMode:!1,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!0,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:B.isMac,rendererType:"canvas",windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:void 0};var P=["normal","bold","100","200","300","400","500","600","700","800","900"],I=function(){function e(u){this._onOptionChange=new k.EventEmitter;var b=x({},y.DEFAULT_OPTIONS);for(var B in u)if(B in b)try{var P=u[B];b[B]=this._sanitizeAndValidateOption(B,P)}catch(u){console.error(u)}this.rawOptions=b,this.options=x({},b),this._setupOptions()}return Object.defineProperty(e.prototype,"onOptionChange",{get:function(){return this._onOptionChange.event},enumerable:!1,configurable:!0}),e.prototype._setupOptions=function(){var u=this,r=function(b){if(!(b in y.DEFAULT_OPTIONS))throw Error('No option with key "'+b+'"');return u.rawOptions[b]},i=function(b,x){if(!(b in y.DEFAULT_OPTIONS))throw Error('No option with key "'+b+'"');x=u._sanitizeAndValidateOption(b,x),u.rawOptions[b]!==x&&(u.rawOptions[b]=x,u._onOptionChange.fire(b))};for(var b in this.rawOptions){var x={get:r.bind(this,b),set:i.bind(this,b)};Object.defineProperty(this.options,b,x)}},e.prototype.setOption=function(u,y){this.options[u]=y},e.prototype._sanitizeAndValidateOption=function(u,b){switch(u){case"bellStyle":case"cursorStyle":case"rendererType":case"wordSeparator":b||(b=y.DEFAULT_OPTIONS[u]);break;case"fontWeight":case"fontWeightBold":if("number"==typeof b&&1<=b&&b<=1e3)break;b=P.includes(b)?b:y.DEFAULT_OPTIONS[u];break;case"cursorWidth":b=Math.floor(b);case"lineHeight":case"tabStopWidth":if(b<1)throw Error(u+" cannot be less than 1, value: "+b);break;case"minimumContrastRatio":b=Math.max(1,Math.min(21,Math.round(10*b)/10));break;case"scrollback":if((b=Math.min(b,4294967295))<0)throw Error(u+" cannot be less than 0, value: "+b);break;case"fastScrollSensitivity":case"scrollSensitivity":if(b<=0)throw Error(u+" cannot be less than or equal to 0, value: "+b);case"rows":case"cols":if(!b&&0!==b)throw Error(u+" must be numeric, value: "+b)}return b},e.prototype.getOption=function(u){return this.options[u]},e}();y.OptionsService=I},8343:(u,y)=>{function r(u,y,b){y.di$target===y?y.di$dependencies.push({id:u,index:b}):(y.di$dependencies=[{id:u,index:b}],y.di$target=y)}Object.defineProperty(y,"__esModule",{value:!0}),y.createDecorator=y.getServiceDependencies=y.serviceRegistry=void 0,y.serviceRegistry=new Map,y.getServiceDependencies=function(u){return u.di$dependencies||[]},y.createDecorator=function(u){if(y.serviceRegistry.has(u))return y.serviceRegistry.get(u);var i=function(u,y,b){if(3!==arguments.length)throw Error("@IServiceName-decorator can only be used to decorate a parameter");r(i,u,b)};return i.toString=function(){return u},y.serviceRegistry.set(u,i),i}},2585:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.IDecorationService=y.IUnicodeService=y.IOptionsService=y.ILogService=y.LogLevelEnum=y.IInstantiationService=y.IDirtyRowService=y.ICharsetService=y.ICoreService=y.ICoreMouseService=y.IBufferService=void 0;var x,k=b(8343);y.IBufferService=(0,k.createDecorator)("BufferService"),y.ICoreMouseService=(0,k.createDecorator)("CoreMouseService"),y.ICoreService=(0,k.createDecorator)("CoreService"),y.ICharsetService=(0,k.createDecorator)("CharsetService"),y.IDirtyRowService=(0,k.createDecorator)("DirtyRowService"),y.IInstantiationService=(0,k.createDecorator)("InstantiationService"),(x=y.LogLevelEnum||(y.LogLevelEnum={}))[x.DEBUG=0]="DEBUG",x[x.INFO=1]="INFO",x[x.WARN=2]="WARN",x[x.ERROR=3]="ERROR",x[x.OFF=4]="OFF",y.ILogService=(0,k.createDecorator)("LogService"),y.IOptionsService=(0,k.createDecorator)("OptionsService"),y.IUnicodeService=(0,k.createDecorator)("UnicodeService"),y.IDecorationService=(0,k.createDecorator)("DecorationService")},1480:(u,y,b)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.UnicodeService=void 0;var x=b(8460),k=b(225),B=function(){function e(){this._providers=Object.create(null),this._active="",this._onChange=new x.EventEmitter;var u=new k.UnicodeV6;this.register(u),this._active=u.version,this._activeProvider=u}return Object.defineProperty(e.prototype,"onChange",{get:function(){return this._onChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"versions",{get:function(){return Object.keys(this._providers)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeVersion",{get:function(){return this._active},set:function(u){if(!this._providers[u])throw Error('unknown Unicode version "'+u+'"');this._active=u,this._activeProvider=this._providers[u],this._onChange.fire(u)},enumerable:!1,configurable:!0}),e.prototype.register=function(u){this._providers[u.version]=u},e.prototype.wcwidth=function(u){return this._activeProvider.wcwidth(u)},e.prototype.getStringCellWidth=function(u){for(var y=0,b=u.length,x=0;x<b;++x){var k=u.charCodeAt(x);if(55296<=k&&k<=56319){if(++x>=b)return y+this.wcwidth(k);var B=u.charCodeAt(x);56320<=B&&B<=57343?k=1024*(k-55296)+B-56320+65536:y+=this.wcwidth(B)}y+=this.wcwidth(k)}return y},e}();y.UnicodeService=B}},y={};return function r(b){var x=y[b];if(void 0!==x)return x.exports;var k=y[b]={exports:{}};return u[b].call(k.exports,k,k.exports,r),k.exports}(4389)})()}},y={};function __webpack_require__(b){var x=y[b];if(void 0!==x)return x.exports;var k=y[b]={exports:{}};return u[b](k,k.exports,__webpack_require__),k.exports}__webpack_require__.d=(u,y)=>{for(var b in y)__webpack_require__.o(y,b)&&!__webpack_require__.o(u,b)&&Object.defineProperty(u,b,{enumerable:!0,get:y[b]})},__webpack_require__.o=(u,y)=>Object.prototype.hasOwnProperty.call(u,y),__webpack_require__.r=u=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})},(()=>{"use strict";var u={};__webpack_require__.r(u),__webpack_require__.d(u,{Decoder:()=>Decoder,Encoder:()=>Encoder,PacketType:()=>he,protocol:()=>le});const y=Object.create(null);y.open="0",y.close="1",y.ping="2",y.pong="3",y.message="4",y.upgrade="5",y.noop="6";const b=Object.create(null);Object.keys(y).forEach((u=>{b[y[u]]=u}));const x={type:"error",data:"parser error"},k="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),B="function"==typeof ArrayBuffer,encodeBlobAsBase64=(u,y)=>{const b=new FileReader;return b.onload=function(){const u=b.result.split(",")[1];y("b"+(u||""))},b.readAsDataURL(u)},encodePacket_browser=({type:u,data:b},x,P)=>{return k&&b instanceof Blob?x?P(b):encodeBlobAsBase64(b,P):B&&(b instanceof ArrayBuffer||(I=b,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(I):I&&I.buffer instanceof ArrayBuffer))?x?P(b):encodeBlobAsBase64(new Blob([b]),P):P(y[u]+(b||""));var I},P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",I="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let u=0;u<64;u++)I[P.charCodeAt(u)]=u;const H="function"==typeof ArrayBuffer,decodeBase64Packet=(u,y)=>{if(H){const b=(u=>{let y,b,x,k,B,P=.75*u.length,H=u.length,j=0;"="===u[u.length-1]&&(P--,"="===u[u.length-2]&&P--);const N=new ArrayBuffer(P),q=new Uint8Array(N);for(y=0;y<H;y+=4)b=I[u.charCodeAt(y)],x=I[u.charCodeAt(y+1)],k=I[u.charCodeAt(y+2)],B=I[u.charCodeAt(y+3)],q[j++]=b<<2|x>>4,q[j++]=(15&x)<<4|k>>2,q[j++]=(3&k)<<6|63&B;return N})(u);return mapBinary(b,y)}return{base64:!0,data:u}},mapBinary=(u,y)=>"blob"===y&&u instanceof ArrayBuffer?new Blob([u]):u,decodePacket_browser=(u,y)=>{if("string"!=typeof u)return{type:"message",data:mapBinary(u,y)};const k=u.charAt(0);if("b"===k)return{type:"message",data:decodeBase64Packet(u.substring(1),y)};return b[k]?u.length>1?{type:b[k],data:u.substring(1)}:{type:b[k]}:x};function Emitter(u){if(u)return function mixin(u){for(var y in Emitter.prototype)u[y]=Emitter.prototype[y];return u}(u)}Emitter.prototype.on=Emitter.prototype.addEventListener=function(u,y){return this._callbacks=this._callbacks||{},(this._callbacks["$"+u]=this._callbacks["$"+u]||[]).push(y),this},Emitter.prototype.once=function(u,y){function on(){this.off(u,on),y.apply(this,arguments)}return on.fn=y,this.on(u,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(u,y){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var b,x=this._callbacks["$"+u];if(!x)return this;if(1==arguments.length)return delete this._callbacks["$"+u],this;for(var k=0;k<x.length;k++)if((b=x[k])===y||b.fn===y){x.splice(k,1);break}return 0===x.length&&delete this._callbacks["$"+u],this},Emitter.prototype.emit=function(u){this._callbacks=this._callbacks||{};for(var y=Array(arguments.length-1),b=this._callbacks["$"+u],x=1;x<arguments.length;x++)y[x-1]=arguments[x];if(b){x=0;for(var k=(b=b.slice(0)).length;x<k;++x)b[x].apply(this,y)}return this},Emitter.prototype.emitReserved=Emitter.prototype.emit,Emitter.prototype.listeners=function(u){return this._callbacks=this._callbacks||{},this._callbacks["$"+u]||[]},Emitter.prototype.hasListeners=function(u){return!!this.listeners(u).length};const j="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function pick(u,...y){return y.reduce(((y,b)=>(u.hasOwnProperty(b)&&(y[b]=u[b]),y)),{})}const N=j.setTimeout,q=j.clearTimeout;function installTimerFunctions(u,y){y.useNativeTimers?(u.setTimeoutFn=N.bind(j),u.clearTimeoutFn=q.bind(j)):(u.setTimeoutFn=j.setTimeout.bind(j),u.clearTimeoutFn=j.clearTimeout.bind(j))}const W=1.33;class TransportError extends Error{constructor(u,y,b){super(u),this.description=y,this.context=b,this.type="TransportError"}}class Transport extends Emitter{constructor(u){super(),this.writable=!1,installTimerFunctions(this,u),this.opts=u,this.query=u.query,this.socket=u.socket}onError(u,y,b){return super.emitReserved("error",new TransportError(u,y,b)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(u){"open"===this.readyState&&this.write(u)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(u){const y=decodePacket_browser(u,this.socket.binaryType);this.onPacket(y)}onPacket(u){super.emitReserved("packet",u)}onClose(u){this.readyState="closed",super.emitReserved("close",u)}pause(u){}}const U="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),z=64,K={};let V,G=0,X=0;function yeast_encode(u){let y="";do{y=U[u%z]+y,u=Math.floor(u/z)}while(u>0);return y}function yeast(){const u=yeast_encode(+new Date);return u!==V?(G=0,V=u):u+"."+yeast_encode(G++)}for(;X<z;X++)K[U[X]]=X;function parseqs_encode(u){let y="";for(let b in u)u.hasOwnProperty(b)&&(y.length&&(y+="&"),y+=encodeURIComponent(b)+"="+encodeURIComponent(u[b]));return y}let Y=!1;try{Y="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(u){}const J=Y;function XHR(u){const y=u.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!y||J))return new XMLHttpRequest}catch(u){}if(!y)try{return new(j[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(u){}}function empty(){}const $=null!=new XHR({xdomain:!1}).responseType;class Request extends Emitter{constructor(u,y){super(),installTimerFunctions(this,y),this.opts=y,this.method=y.method||"GET",this.uri=u,this.async=!1!==y.async,this.data=void 0!==y.data?y.data:null,this.create()}create(){const u=pick(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");u.xdomain=!!this.opts.xd,u.xscheme=!!this.opts.xs;const y=this.xhr=new XHR(u);try{y.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){y.setDisableHeaderCheck&&y.setDisableHeaderCheck(!0);for(let u in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(u)&&y.setRequestHeader(u,this.opts.extraHeaders[u])}}catch(u){}if("POST"===this.method)try{y.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(u){}try{y.setRequestHeader("Accept","*/*")}catch(u){}"withCredentials"in y&&(y.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(y.timeout=this.opts.requestTimeout),y.onreadystatechange=()=>{4===y.readyState&&(200===y.status||1223===y.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof y.status?y.status:0)}),0))},y.send(this.data)}catch(u){return void this.setTimeoutFn((()=>{this.onError(u)}),0)}"undefined"!=typeof document&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)}onError(u){this.emitReserved("error",u,this.xhr),this.cleanup(!0)}cleanup(u){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=empty,u)try{this.xhr.abort()}catch(u){}"undefined"!=typeof document&&delete Request.requests[this.index],this.xhr=null}}onLoad(){const u=this.xhr.responseText;null!==u&&(this.emitReserved("data",u),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(Request.requestsCount=0,Request.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",unloadHandler);else if("function"==typeof addEventListener){addEventListener("onpagehide"in j?"pagehide":"unload",unloadHandler,!1)}function unloadHandler(){for(let u in Request.requests)Request.requests.hasOwnProperty(u)&&Request.requests[u].abort()}const Q="function"==typeof Promise&&"function"==typeof Promise.resolve?u=>Promise.resolve().then(u):(u,y)=>y(u,0),ee=j.WebSocket||j.MozWebSocket,te="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();const re={websocket:class WS extends Transport{constructor(u){super(u),this.supportsBinary=!u.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const u=this.uri(),y=this.opts.protocols,b=te?{}:pick(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(b.headers=this.opts.extraHeaders);try{this.ws=te?new ee(u,y,b):y?new ee(u,y):new ee(u)}catch(u){return this.emitReserved("error",u)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=u=>this.onClose({description:"websocket connection closed",context:u}),this.ws.onmessage=u=>this.onData(u.data),this.ws.onerror=u=>this.onError("websocket error",u)}write(u){this.writable=!1;for(let y=0;y<u.length;y++){const b=u[y],x=y===u.length-1;encodePacket_browser(b,this.supportsBinary,(u=>{try{this.ws.send(u)}catch(u){}x&&Q((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let u=this.query||{};const y=this.opts.secure?"wss":"ws";let b="";this.opts.port&&("wss"===y&&443!==Number(this.opts.port)||"ws"===y&&80!==Number(this.opts.port))&&(b=":"+this.opts.port),this.opts.timestampRequests&&(u[this.opts.timestampParam]=yeast()),this.supportsBinary||(u.b64=1);const x=parseqs_encode(u);return y+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+b+this.opts.path+(x.length?"?"+x:"")}check(){return!!ee}},polling:class Polling extends Transport{constructor(u){if(super(u),this.polling=!1,"undefined"!=typeof location){const y="https:"===location.protocol;let b=location.port;b||(b=y?"443":"80"),this.xd="undefined"!=typeof location&&u.hostname!==location.hostname||b!==u.port,this.xs=u.secure!==y}const y=u&&u.forceBase64;this.supportsBinary=$&&!y}get name(){return"polling"}doOpen(){this.poll()}pause(u){this.readyState="pausing";const pause=()=>{this.readyState="paused",u()};if(this.polling||!this.writable){let u=0;this.polling&&(u++,this.once("pollComplete",(function(){--u||pause()}))),this.writable||(u++,this.once("drain",(function(){--u||pause()})))}else pause()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(u){((u,y)=>{const b=u.split(""),x=[];for(let u=0;u<b.length;u++){const k=decodePacket_browser(b[u],y);if(x.push(k),"error"===k.type)break}return x})(u,this.socket.binaryType).forEach((u=>{if("opening"===this.readyState&&"open"===u.type&&this.onOpen(),"close"===u.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(u)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const close=()=>{this.write([{type:"close"}])};"open"===this.readyState?close():this.once("open",close)}write(u){this.writable=!1,((u,y)=>{const b=u.length,x=Array(b);let k=0;u.forEach(((u,B)=>{encodePacket_browser(u,!1,(u=>{x[B]=u,++k===b&&y(x.join(""))}))}))})(u,(u=>{this.doWrite(u,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){let u=this.query||{};const y=this.opts.secure?"https":"http";let b="";!1!==this.opts.timestampRequests&&(u[this.opts.timestampParam]=yeast()),this.supportsBinary||u.sid||(u.b64=1),this.opts.port&&("https"===y&&443!==Number(this.opts.port)||"http"===y&&80!==Number(this.opts.port))&&(b=":"+this.opts.port);const x=parseqs_encode(u);return y+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+b+this.opts.path+(x.length?"?"+x:"")}request(u={}){return Object.assign(u,{xd:this.xd,xs:this.xs},this.opts),new Request(this.uri(),u)}doWrite(u,y){const b=this.request({method:"POST",data:u});b.on("success",y),b.on("error",((u,y)=>{this.onError("xhr post error",u,y)}))}doPoll(){const u=this.request();u.on("data",this.onData.bind(this)),u.on("error",((u,y)=>{this.onError("xhr poll error",u,y)})),this.pollXhr=u}}},ie=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ne=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function parse(u){const y=u,b=u.indexOf("["),x=u.indexOf("]");-1!=b&&-1!=x&&(u=u.substring(0,b)+u.substring(b,x).replace(/:/g,";")+u.substring(x,u.length));let k=ie.exec(u||""),B={},P=14;for(;P--;)B[ne[P]]=k[P]||"";return-1!=b&&-1!=x&&(B.source=y,B.host=B.host.substring(1,B.host.length-1).replace(/;/g,":"),B.authority=B.authority.replace("[","").replace("]","").replace(/;/g,":"),B.ipv6uri=!0),B.pathNames=function pathNames(u,y){const b=/\/{2,9}/g,x=y.replace(b,"/").split("/");"/"!=y.slice(0,1)&&0!==y.length||x.splice(0,1);"/"==y.slice(-1)&&x.splice(x.length-1,1);return x}(0,B.path),B.queryKey=function queryKey(u,y){const b={};return y.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(u,y,x){y&&(b[y]=x)})),b}(0,B.query),B}class Socket extends Emitter{constructor(u,y={}){super(),this.writeBuffer=[],u&&"object"==typeof u&&(y=u,u=null),u?(u=parse(u),y.hostname=u.host,y.secure="https"===u.protocol||"wss"===u.protocol,y.port=u.port,u.query&&(y.query=u.query)):y.host&&(y.hostname=parse(y.host).host),installTimerFunctions(this,y),this.secure=null!=y.secure?y.secure:"undefined"!=typeof location&&"https:"===location.protocol,y.hostname&&!y.port&&(y.port=this.secure?"443":"80"),this.hostname=y.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=y.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=y.transports||["polling","websocket"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},y),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function parseqs_decode(u){let y={},b=u.split("&");for(let u=0,x=b.length;u<x;u++){let x=b[u].split("=");y[decodeURIComponent(x[0])]=decodeURIComponent(x[1])}return y}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(u){const y=Object.assign({},this.opts.query);y.EIO=4,y.transport=u,this.id&&(y.sid=this.id);const b=Object.assign({},this.opts.transportOptions[u],this.opts,{query:y,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new re[u](b)}open(){let u;if(this.opts.rememberUpgrade&&Socket.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))u="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);u=this.transports[0]}this.readyState="opening";try{u=this.createTransport(u)}catch(u){return this.transports.shift(),void this.open()}u.open(),this.setTransport(u)}setTransport(u){this.transport&&this.transport.removeAllListeners(),this.transport=u,u.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(u=>this.onClose("transport close",u)))}probe(u){let y=this.createTransport(u),b=!1;Socket.priorWebsocketSuccess=!1;const onTransportOpen=()=>{b||(y.send([{type:"ping",data:"probe"}]),y.once("packet",(u=>{if(!b)if("pong"===u.type&&"probe"===u.data){if(this.upgrading=!0,this.emitReserved("upgrading",y),!y)return;Socket.priorWebsocketSuccess="websocket"===y.name,this.transport.pause((()=>{b||"closed"!==this.readyState&&(cleanup(),this.setTransport(y),y.send([{type:"upgrade"}]),this.emitReserved("upgrade",y),y=null,this.upgrading=!1,this.flush())}))}else{const u=Error("probe error");u.transport=y.name,this.emitReserved("upgradeError",u)}})))};function freezeTransport(){b||(b=!0,cleanup(),y.close(),y=null)}const onerror=u=>{const b=Error("probe error: "+u);b.transport=y.name,freezeTransport(),this.emitReserved("upgradeError",b)};function onTransportClose(){onerror("transport closed")}function onclose(){onerror("socket closed")}function onupgrade(u){y&&u.name!==y.name&&freezeTransport()}const cleanup=()=>{y.removeListener("open",onTransportOpen),y.removeListener("error",onerror),y.removeListener("close",onTransportClose),this.off("close",onclose),this.off("upgrading",onupgrade)};y.once("open",onTransportOpen),y.once("error",onerror),y.once("close",onTransportClose),this.once("close",onclose),this.once("upgrading",onupgrade),y.open()}onOpen(){if(this.readyState="open",Socket.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let u=0;const y=this.upgrades.length;for(;u<y;u++)this.probe(this.upgrades[u])}}onPacket(u){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",u),this.emitReserved("heartbeat"),u.type){case"open":this.onHandshake(JSON.parse(u.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const y=Error("server error");y.code=u.data,this.onError(y);break;case"message":this.emitReserved("data",u.data),this.emitReserved("message",u.data)}}onHandshake(u){this.emitReserved("handshake",u),this.id=u.sid,this.transport.query.sid=u.sid,this.upgrades=this.filterUpgrades(u.upgrades),this.pingInterval=u.pingInterval,this.pingTimeout=u.pingTimeout,this.maxPayload=u.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const u=this.getWritablePackets();this.transport.send(u),this.prevBufferLen=u.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let u=1;for(let b=0;b<this.writeBuffer.length;b++){const x=this.writeBuffer[b].data;if(x&&(u+="string"==typeof(y=x)?function utf8Length(u){let y=0,b=0;for(let x=0,k=u.length;x<k;x++)y=u.charCodeAt(x),y<128?b+=1:y<2048?b+=2:y<55296||y>=57344?b+=3:(x++,b+=4);return b}(y):Math.ceil((y.byteLength||y.size)*W)),b>0&&u>this.maxPayload)return this.writeBuffer.slice(0,b);u+=2}var y;return this.writeBuffer}write(u,y,b){return this.sendPacket("message",u,y,b),this}send(u,y,b){return this.sendPacket("message",u,y,b),this}sendPacket(u,y,b,x){if("function"==typeof y&&(x=y,y=void 0),"function"==typeof b&&(x=b,b=null),"closing"===this.readyState||"closed"===this.readyState)return;(b=b||{}).compress=!1!==b.compress;const k={type:u,data:y,options:b};this.emitReserved("packetCreate",k),this.writeBuffer.push(k),x&&this.once("flush",x),this.flush()}close(){const close=()=>{this.onClose("forced close"),this.transport.close()},cleanupAndClose=()=>{this.off("upgrade",cleanupAndClose),this.off("upgradeError",cleanupAndClose),close()},waitForUpgrade=()=>{this.once("upgrade",cleanupAndClose),this.once("upgradeError",cleanupAndClose)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?waitForUpgrade():close()})):this.upgrading?waitForUpgrade():close()),this}onError(u){Socket.priorWebsocketSuccess=!1,this.emitReserved("error",u),this.onClose("transport error",u)}onClose(u,y){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",u,y),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(u){const y=[];let b=0;const x=u.length;for(;b<x;b++)~this.transports.indexOf(u[b])&&y.push(u[b]);return y}}Socket.protocol=4;Socket.protocol;const oe="function"==typeof ArrayBuffer,is_binary_isView=u=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(u):u.buffer instanceof ArrayBuffer,se=Object.prototype.toString,ae="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===se.call(Blob),ce="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===se.call(File);function isBinary(u){return oe&&(u instanceof ArrayBuffer||is_binary_isView(u))||ae&&u instanceof Blob||ce&&u instanceof File}function hasBinary(u,y){if(!u||"object"!=typeof u)return!1;if(Array.isArray(u)){for(let y=0,b=u.length;y<b;y++)if(hasBinary(u[y]))return!0;return!1}if(isBinary(u))return!0;if(u.toJSON&&"function"==typeof u.toJSON&&1===arguments.length)return hasBinary(u.toJSON(),!0);for(const y in u)if(Object.prototype.hasOwnProperty.call(u,y)&&hasBinary(u[y]))return!0;return!1}function deconstructPacket(u){const y=[],b=u.data,x=u;return x.data=_deconstructPacket(b,y),x.attachments=y.length,{packet:x,buffers:y}}function _deconstructPacket(u,y){if(!u)return u;if(isBinary(u)){const b={_placeholder:!0,num:y.length};return y.push(u),b}if(Array.isArray(u)){const b=Array(u.length);for(let x=0;x<u.length;x++)b[x]=_deconstructPacket(u[x],y);return b}if("object"==typeof u&&!(u instanceof Date)){const b={};for(const x in u)Object.prototype.hasOwnProperty.call(u,x)&&(b[x]=_deconstructPacket(u[x],y));return b}return u}function reconstructPacket(u,y){return u.data=_reconstructPacket(u.data,y),delete u.attachments,u}function _reconstructPacket(u,y){if(!u)return u;if(u&&!0===u._placeholder){if("number"==typeof u.num&&u.num>=0&&u.num<y.length)return y[u.num];throw Error("illegal attachments")}if(Array.isArray(u))for(let b=0;b<u.length;b++)u[b]=_reconstructPacket(u[b],y);else if("object"==typeof u)for(const b in u)Object.prototype.hasOwnProperty.call(u,b)&&(u[b]=_reconstructPacket(u[b],y));return u}const le=5;var he;!function(u){u[u.CONNECT=0]="CONNECT",u[u.DISCONNECT=1]="DISCONNECT",u[u.EVENT=2]="EVENT",u[u.ACK=3]="ACK",u[u.CONNECT_ERROR=4]="CONNECT_ERROR",u[u.BINARY_EVENT=5]="BINARY_EVENT",u[u.BINARY_ACK=6]="BINARY_ACK"}(he||(he={}));class Encoder{constructor(u){this.replacer=u}encode(u){return u.type!==he.EVENT&&u.type!==he.ACK||!hasBinary(u)?[this.encodeAsString(u)]:this.encodeAsBinary({type:u.type===he.EVENT?he.BINARY_EVENT:he.BINARY_ACK,nsp:u.nsp,data:u.data,id:u.id})}encodeAsString(u){let y=""+u.type;return u.type!==he.BINARY_EVENT&&u.type!==he.BINARY_ACK||(y+=u.attachments+"-"),u.nsp&&"/"!==u.nsp&&(y+=u.nsp+","),null!=u.id&&(y+=u.id),null!=u.data&&(y+=JSON.stringify(u.data,this.replacer)),y}encodeAsBinary(u){const y=deconstructPacket(u),b=this.encodeAsString(y.packet),x=y.buffers;return x.unshift(b),x}}class Decoder extends Emitter{constructor(u){super(),this.reviver=u}add(u){let y;if("string"==typeof u){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");y=this.decodeString(u);const b=y.type===he.BINARY_EVENT;b||y.type===he.BINARY_ACK?(y.type=b?he.EVENT:he.ACK,this.reconstructor=new BinaryReconstructor(y),0===y.attachments&&super.emitReserved("decoded",y)):super.emitReserved("decoded",y)}else{if(!isBinary(u)&&!u.base64)throw Error("Unknown type: "+u);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");y=this.reconstructor.takeBinaryData(u),y&&(this.reconstructor=null,super.emitReserved("decoded",y))}}decodeString(u){let y=0;const b={type:Number(u.charAt(0))};if(void 0===he[b.type])throw Error("unknown packet type "+b.type);if(b.type===he.BINARY_EVENT||b.type===he.BINARY_ACK){const x=y+1;for(;"-"!==u.charAt(++y)&&y!=u.length;);const k=u.substring(x,y);if(k!=Number(k)||"-"!==u.charAt(y))throw Error("Illegal attachments");b.attachments=Number(k)}if("/"===u.charAt(y+1)){const x=y+1;for(;++y;){if(","===u.charAt(y))break;if(y===u.length)break}b.nsp=u.substring(x,y)}else b.nsp="/";const x=u.charAt(y+1);if(""!==x&&Number(x)==x){const x=y+1;for(;++y;){const b=u.charAt(y);if(null==b||Number(b)!=b){--y;break}if(y===u.length)break}b.id=Number(u.substring(x,y+1))}if(u.charAt(++y)){const x=this.tryParse(u.substr(y));if(!Decoder.isPayloadValid(b.type,x))throw Error("invalid payload");b.data=x}return b}tryParse(u){try{return JSON.parse(u,this.reviver)}catch(u){return!1}}static isPayloadValid(u,y){switch(u){case he.CONNECT:return"object"==typeof y;case he.DISCONNECT:return void 0===y;case he.CONNECT_ERROR:return"string"==typeof y||"object"==typeof y;case he.EVENT:case he.BINARY_EVENT:return Array.isArray(y)&&y.length>0;case he.ACK:case he.BINARY_ACK:return Array.isArray(y)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class BinaryReconstructor{constructor(u){this.packet=u,this.buffers=[],this.reconPack=u}takeBinaryData(u){if(this.buffers.push(u),this.buffers.length===this.reconPack.attachments){const u=reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),u}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function on(u,y,b){return u.on(y,b),function subDestroy(){u.off(y,b)}}const ue=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class socket_Socket extends Emitter{constructor(u,y,b){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=u,this.nsp=y,b&&b.auth&&(this.auth=b.auth),this._opts=Object.assign({},b),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const u=this.io;this.subs=[on(u,"open",this.onopen.bind(this)),on(u,"packet",this.onpacket.bind(this)),on(u,"error",this.onerror.bind(this)),on(u,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...u){return u.unshift("message"),this.emit.apply(this,u),this}emit(u,...y){if(ue.hasOwnProperty(u))throw Error('"'+u.toString()+'" is a reserved event name');if(y.unshift(u),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(y),this;const b={type:he.EVENT,data:y,options:{}};if(b.options.compress=!1!==this.flags.compress,"function"==typeof y[y.length-1]){const u=this.ids++,x=y.pop();this._registerAckCallback(u,x),b.id=u}const x=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!x||!this.connected)||(this.connected?(this.notifyOutgoingListeners(b),this.packet(b)):this.sendBuffer.push(b)),this.flags={},this}_registerAckCallback(u,y){var b;const x=null!==(b=this.flags.timeout)&&void 0!==b?b:this._opts.ackTimeout;if(void 0===x)return void(this.acks[u]=y);const k=this.io.setTimeoutFn((()=>{delete this.acks[u];for(let y=0;y<this.sendBuffer.length;y++)this.sendBuffer[y].id===u&&this.sendBuffer.splice(y,1);y.call(this,Error("operation has timed out"))}),x);this.acks[u]=(...u)=>{this.io.clearTimeoutFn(k),y.call(this,null,...u)}}emitWithAck(u,...y){const b=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise(((x,k)=>{y.push(((u,y)=>b?u?k(u):x(y):x(u))),this.emit(u,...y)}))}_addToQueue(u){let y;"function"==typeof u[u.length-1]&&(y=u.pop());const b={id:this._queueSeq++,tryCount:0,pending:!1,args:u,flags:Object.assign({fromQueue:!0},this.flags)};u.push(((u,...x)=>{if(b!==this._queue[0])return;return null!==u?b.tryCount>this._opts.retries&&(this._queue.shift(),y&&y(u)):(this._queue.shift(),y&&y(null,...x)),b.pending=!1,this._drainQueue()})),this._queue.push(b),this._drainQueue()}_drainQueue(u=!1){if(!this.connected||0===this._queue.length)return;const y=this._queue[0];y.pending&&!u||(y.pending=!0,y.tryCount++,this.flags=y.flags,this.emit.apply(this,y.args))}packet(u){u.nsp=this.nsp,this.io._packet(u)}onopen(){"function"==typeof this.auth?this.auth((u=>{this._sendConnectPacket(u)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(u){this.packet({type:he.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},u):u})}onerror(u){this.connected||this.emitReserved("connect_error",u)}onclose(u,y){this.connected=!1,delete this.id,this.emitReserved("disconnect",u,y)}onpacket(u){if(u.nsp===this.nsp)switch(u.type){case he.CONNECT:u.data&&u.data.sid?this.onconnect(u.data.sid,u.data.pid):this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case he.EVENT:case he.BINARY_EVENT:this.onevent(u);break;case he.ACK:case he.BINARY_ACK:this.onack(u);break;case he.DISCONNECT:this.ondisconnect();break;case he.CONNECT_ERROR:this.destroy();const y=Error(u.data.message);y.data=u.data.data,this.emitReserved("connect_error",y)}}onevent(u){const y=u.data||[];null!=u.id&&y.push(this.ack(u.id)),this.connected?this.emitEvent(y):this.receiveBuffer.push(Object.freeze(y))}emitEvent(u){if(this._anyListeners&&this._anyListeners.length){const y=this._anyListeners.slice();for(const b of y)b.apply(this,u)}super.emit.apply(this,u),this._pid&&u.length&&"string"==typeof u[u.length-1]&&(this._lastOffset=u[u.length-1])}ack(u){const y=this;let b=!1;return function(...x){b||(b=!0,y.packet({type:he.ACK,id:u,data:x}))}}onack(u){const y=this.acks[u.id];"function"==typeof y&&(y.apply(this,u.data),delete this.acks[u.id])}onconnect(u,y){this.id=u,this.recovered=y&&this._pid===y,this._pid=y,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((u=>this.emitEvent(u))),this.receiveBuffer=[],this.sendBuffer.forEach((u=>{this.notifyOutgoingListeners(u),this.packet(u)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((u=>u())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:he.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(u){return this.flags.compress=u,this}get volatile(){return this.flags.volatile=!0,this}timeout(u){return this.flags.timeout=u,this}onAny(u){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(u),this}prependAny(u){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(u),this}offAny(u){if(!this._anyListeners)return this;if(u){const y=this._anyListeners;for(let b=0;b<y.length;b++)if(u===y[b])return y.splice(b,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(u){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(u),this}prependAnyOutgoing(u){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(u),this}offAnyOutgoing(u){if(!this._anyOutgoingListeners)return this;if(u){const y=this._anyOutgoingListeners;for(let b=0;b<y.length;b++)if(u===y[b])return y.splice(b,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(u){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const y=this._anyOutgoingListeners.slice();for(const b of y)b.apply(this,u.data)}}}function Backoff(u){u=u||{},this.ms=u.min||100,this.max=u.max||1e4,this.factor=u.factor||2,this.jitter=u.jitter>0&&u.jitter<=1?u.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var u=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var y=Math.random(),b=Math.floor(y*this.jitter*u);u=0==(1&Math.floor(10*y))?u-b:u+b}return 0|Math.min(u,this.max)},Backoff.prototype.reset=function(){this.attempts=0},Backoff.prototype.setMin=function(u){this.ms=u},Backoff.prototype.setMax=function(u){this.max=u},Backoff.prototype.setJitter=function(u){this.jitter=u};class Manager extends Emitter{constructor(y,b){var x;super(),this.nsps={},this.subs=[],y&&"object"==typeof y&&(b=y,y=void 0),(b=b||{}).path=b.path||"/socket.io",this.opts=b,installTimerFunctions(this,b),this.reconnection(!1!==b.reconnection),this.reconnectionAttempts(b.reconnectionAttempts||1/0),this.reconnectionDelay(b.reconnectionDelay||1e3),this.reconnectionDelayMax(b.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(x=b.randomizationFactor)&&void 0!==x?x:.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==b.timeout?2e4:b.timeout),this._readyState="closed",this.uri=y;const k=b.parser||u;this.encoder=new k.Encoder,this.decoder=new k.Decoder,this._autoConnect=!1!==b.autoConnect,this._autoConnect&&this.open()}reconnection(u){return arguments.length?(this._reconnection=!!u,this):this._reconnection}reconnectionAttempts(u){return void 0===u?this._reconnectionAttempts:(this._reconnectionAttempts=u,this)}reconnectionDelay(u){var y;return void 0===u?this._reconnectionDelay:(this._reconnectionDelay=u,null===(y=this.backoff)||void 0===y||y.setMin(u),this)}randomizationFactor(u){var y;return void 0===u?this._randomizationFactor:(this._randomizationFactor=u,null===(y=this.backoff)||void 0===y||y.setJitter(u),this)}reconnectionDelayMax(u){var y;return void 0===u?this._reconnectionDelayMax:(this._reconnectionDelayMax=u,null===(y=this.backoff)||void 0===y||y.setMax(u),this)}timeout(u){return arguments.length?(this._timeout=u,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(u){if(~this._readyState.indexOf("open"))return this;this.engine=new Socket(this.uri,this.opts);const y=this.engine,b=this;this._readyState="opening",this.skipReconnect=!1;const x=on(y,"open",(function(){b.onopen(),u&&u()})),k=on(y,"error",(y=>{b.cleanup(),b._readyState="closed",this.emitReserved("error",y),u?u(y):b.maybeReconnectOnOpen()}));if(!1!==this._timeout){const u=this._timeout;0===u&&x();const b=this.setTimeoutFn((()=>{x(),y.close(),y.emit("error",Error("timeout"))}),u);this.opts.autoUnref&&b.unref(),this.subs.push((function subDestroy(){clearTimeout(b)}))}return this.subs.push(x),this.subs.push(k),this}connect(u){return this.open(u)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const u=this.engine;this.subs.push(on(u,"ping",this.onping.bind(this)),on(u,"data",this.ondata.bind(this)),on(u,"error",this.onerror.bind(this)),on(u,"close",this.onclose.bind(this)),on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(u){try{this.decoder.add(u)}catch(u){this.onclose("parse error",u)}}ondecoded(u){Q((()=>{this.emitReserved("packet",u)}),this.setTimeoutFn)}onerror(u){this.emitReserved("error",u)}socket(u,y){let b=this.nsps[u];return b?this._autoConnect&&!b.active&&b.connect():(b=new socket_Socket(this,u,y),this.nsps[u]=b),b}_destroy(u){const y=Object.keys(this.nsps);for(const u of y){if(this.nsps[u].active)return}this._close()}_packet(u){const y=this.encoder.encode(u);for(let b=0;b<y.length;b++)this.engine.write(y[b],u.options)}cleanup(){this.subs.forEach((u=>u())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(u,y){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",u,y),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const u=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const y=this.backoff.duration();this._reconnecting=!0;const b=this.setTimeoutFn((()=>{u.skipReconnect||(this.emitReserved("reconnect_attempt",u.backoff.attempts),u.skipReconnect||u.open((y=>{y?(u._reconnecting=!1,u.reconnect(),this.emitReserved("reconnect_error",y)):u.onreconnect()})))}),y);this.opts.autoUnref&&b.unref(),this.subs.push((function subDestroy(){clearTimeout(b)}))}}onreconnect(){const u=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",u)}}const fe={};function esm_lookup(u,y){"object"==typeof u&&(y=u,u=void 0);const b=function url(u,y="",b){let x=u;b=b||"undefined"!=typeof location&&location,null==u&&(u=b.protocol+"//"+b.host),"string"==typeof u&&("/"===u.charAt(0)&&(u="/"===u.charAt(1)?b.protocol+u:b.host+u),/^(https?|wss?):\/\//.test(u)||(u=void 0!==b?b.protocol+"//"+u:"https://"+u),x=parse(u)),x.port||(/^(http|ws)$/.test(x.protocol)?x.port="80":/^(http|ws)s$/.test(x.protocol)&&(x.port="443")),x.path=x.path||"/";const k=-1!==x.host.indexOf(":")?"["+x.host+"]":x.host;return x.id=x.protocol+"://"+k+":"+x.port+y,x.href=x.protocol+"://"+k+(b&&b.port===x.port?"":":"+x.port),x}(u,(y=y||{}).path||"/socket.io"),x=b.source,k=b.id,B=b.path,P=fe[k]&&B in fe[k].nsps;let I;return y.forceNew||y["force new connection"]||!1===y.multiplex||P?I=new Manager(x,y):(fe[k]||(fe[k]=new Manager(x,y)),I=fe[k]),b.query&&!y.query&&(y.query=b.queryKey),I.socket(b.path,y)}Object.assign(esm_lookup,{Manager,Socket:socket_Socket,io:esm_lookup,connect:esm_lookup});var _e=__webpack_require__(997),de=__webpack_require__(758);__webpack_require__(116);let pe,ve;const ye=new _e.Terminal,ge=document.getElementById("status"),me=document.getElementById("header"),be=document.getElementById("footer"),Se=document.getElementById("countdown"),Ce=new de.FitAddon,we=document.getElementById("terminal-container");ye.loadAddon(Ce),ye.open(we),ye.focus(),Ce.fit();const Le=esm_lookup({path:"/socket.io"});let Ee=new Zmodem.Sentry({to_terminal:function(u){},on_detect(u){u.confirm().type,alert("暂不支持rz sz 命令")},on_retract:function(){},sender:function(u){Le.emit("data",new Uint8Array(u))}});function resizeScreen(){Ce.fit(),Le.emit("resize",{cols:ye.cols,rows:ye.rows})}window.addEventListener("resize",resizeScreen,!1),ye.onData((u=>{Le.emit("data",u)})),Le.on("data",(u=>{"string"==typeof u?ye.write(u):Ee.consume(u)})),Le.on("connect",(()=>{Le.emit("geometry",ye.cols,ye.rows)})),Le.on("setTerminalOpts",(u=>{ye.options=u})),Le.on("title",(u=>{document.title=u})),Le.on("status",(u=>{ge.innerHTML=u})),Le.on("ssherror",(u=>{ge.innerHTML=u,ge.style.backgroundColor="red",ve=!0})),Le.on("headerBackground",(u=>{me.style.backgroundColor=u})),Le.on("header",(u=>{u&&(me.innerHTML=u,me.style.display="block",we.style.height="calc(100% - 38px)",resizeScreen())})),Le.on("footer",(u=>{pe=u,be.innerHTML=u})),Le.on("statusBackground",(u=>{ge.style.backgroundColor=u})),Le.on("disconnect",(u=>{ve||(ge.style.backgroundColor="red",ge.innerHTML="WEBSOCKET SERVER DISCONNECTED: "+u),Le.io.reconnection(!1),Se.classList.remove("active")})),Le.on("error",(u=>{ve||(ge.style.backgroundColor="red",ge.innerHTML="ERROR: "+u)}));let xe=!1;Le.on("shutdownCountdownUpdate",(u=>{xe||(Se.classList.add("active"),xe=!0),Se.innerText=`Shutting down in ${u}s`})),ye.onTitleChange((u=>{document.title=u}))})()})();